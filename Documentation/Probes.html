<!DOCTYPE html>
<html>

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Health2Me Technical Documentation</title>

    <!-- Core CSS - Include with every page -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <!--<link href="font-awesome/css/font-awesome.css" rel="stylesheet">-->
	<link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
    
    <!-- Page-Level Plugin CSS - Dashboard -->
    <link href="css/plugins/morris/morris-0.4.3.min.css" rel="stylesheet">
    <link href="css/plugins/timeline/timeline.css" rel="stylesheet">

    <!-- SB Admin CSS - Include with every page -->
    <link href="css/sb-admin.css" rel="stylesheet">

</head>

<body>

    <div id="wrapper">

        <nav class="navbar navbar-default navbar-fixed-top" role="navigation" style="margin-bottom: 0">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".sidebar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="index.html">Health2Me Technical Documentation</a>
            </div>
            <!-- /.navbar-header -->

  

            <div class="navbar-default navbar-static-side" role="navigation">
                <div class="sidebar-collapse">
                    <ul class="nav" id="side-menu">
                        <li class="sidebar-search">
                            <div class="input-group custom-search-form">
                                <input type="text" class="form-control" placeholder="Search...">
                                <span class="input-group-btn">
                                <button class="btn btn-default" type="button">
                                    <i class="fa fa-search"></i>
                                </button>
                            </span>
                            </div>
                            <!-- /input-group -->
                        </li>
                        <li>
                            <a href="index.html"><i class="fa fa-dashboard fa-fw"></i> Manual</a>
                        </li>
                        <li>
                            <a><i class="fa fa-database fa-fw"></i> Database Structure<span class="fa arrow"></span></a>
                            <ul class="nav nav-second-level">
		                               <li>
		                                    <a href="GoldenRules.html">Golden Rules of Report Access</a>
		                                </li>
		                               <li>
		                                    <a>Important Tables<span class="fa arrow"></span></a>
                                             <ul class="nav nav-second-level">
		                                       <li>
		                                          <a href="Database.html">Usuarios</a>
		                                        </li>
                                     
								              </ul>
		                                </li>
		                               
								 </ul>
                        </li>
                        <li>
                            <a href="#"><i class="fa fa-bar-chart-o fa-fw"></i> Documents<span class="fa arrow"></span></a>
                            <ul class="nav nav-second-level">
                                <li>
                                    <a href="Probes.html">Probes</a>
                                </li>
                                <li>
                                    <a href="GithubCommit.html">GitHub Commit Procedure</a>
                                </li>
                                <li>
                                    <a href="PhoneNumbers.html">Important Note for Phone Numbers</a>
                                </li>
                                      
                            </ul>
                           <!-- /.nav-second-level -->
                        </li>
                        <li>
                                 <a href="Probes.html"><i class="fa fa-gears fa-fw"></i> Startup Procedure<span class="fa arrow"></span></a>
								 <ul class="nav nav-second-level">
		                               <li>
		                                    <a href="Processes.html">Processes</a>
		                                </li>
		                               <li>
		                                    <a href="Apache.html">Apache</a>
		                                </li>
		                               <li>
		                                    <a href="PhoneNumbers.html">MySQL</a>
		                                </li>
		                               <li>
		                                    <a href="PhoneNumbers.html">FTP Server</a>
		                                </li>
                                        
								 </ul>	 
                            </li>
                        
                        <li>
                                 <a href="Channels.html"><i class="fa fa-arrows-alt fa-fw"></i> Channels</a>
                         </li>
				         <li>
                             	 <a href="Database.html"><i class="fa fa-medkit fa-fw"></i> DICOM viewer</a>
				        </li>
                         <li>
                             	 <a href="UbuntuInstallationSteps.html"><i class="fa fa-cloud-download fa-fw"></i> Ubuntu Installation</a>
							</li>
                        <li>
                             	 <a href="TurnServerInstallationSteps.html"><i class="fa fa-cloud-download fa-fw"></i> Turn Server Installation</a>
							</li>
                        
                        <li>
                             	 <a href="UbuntuUpdateSteps.html"><i class="fa fa-cloud-download fa-fw"></i> Server Restart and Package Update</a>
				        </li>
                        <li>
                             	 <a href="SessionHashing.html"><i class="fa fa-cog fa-fw"></i>Session Hashing</a>
				       </li>    
                        <li>
                             	 <a><i class="fa fa-book fa-fw"></i> Libraries<span class="fa arrow"></span></a>
                                 <ul class="nav nav-second-level">
		                               <li>
		                                    <a>External Libraries<span class="fa arrow"></span></a>
                                               <ul class="nav nav-second-level">
                                                   <li>
		                                              <a href="timebar.html">Timebar</a>
		                                           </li>
                                                   <li>
		                                              <a href="Libraries.html">Moment.js</a>
		                                           </li>
                                               </ul>
		                                </li>
		                               <li>
		                                    <a>Internal Libraries<span class="fa arrow"></span></a>
		                                </li>
		                              
								 </ul>	
							 </li>
                            <li>
                             	 <a href="H2MAPIs.html"><i class="fa fa-cog fa-fw"></i> Health2Me APIs</a>
							</li>
                    </ul>
                    <!-- /#side-menu -->
                </div>
                <!-- /.sidebar-collapse -->
            </div>
            <!-- /.navbar-static-side -->
        </nav>

        <div id="page-wrapper">
            <div class="row">
                <div class="col-lg-12">
                    <h2 class="page-header">Probe Documentation</h2>
                </div>
                <!-- /.col-lg-12 -->
            </div>
            <!-- /.row -->
            <div class="row">
                <div class="col-lg-12">
                

<p>

<h4><p class="text-primary">Database Tables</p></h4> 

<h5><p class="text-info">1. probe</p></h5> 

  
<p>Columns :   </p>
<ul>
<li>probeID           	-- Unique ID associated with a probe request</li>
<li>doctorID		  	-- ID of the doctor which requested the probe (refers to ID in Doctors Table)</li>
<li>patientID		  	-- ID of the patient to be probed (refers to identif in Usuarios Table)</li>
<li>desiredTime 	  	-- The time requested by the doctor</li>
<li>timezone 		  	-- Timezone ID from the timezones table</li>
<li>probeInterval 		-- Number of days between two consecutive probes</li>
<li>doctorPermission 	-- 1 if doctor has given permission. 0 if doctor has revoked permission</li>
<li>patientPermission   -- 1 if patient has given permission. 0 if patient has revoked permission</li>
<li>emailRequest 		-- 1 if patient is to be probed via Email</li>
<li>phoneRequest 		-- 1 if patient is to be probed via Phone</li>
<li>smsRequest			-- 1 if patient is to be probed via SMS</li>
<li>creationDate		-- Date probe was created</li>
</ul>
<p>
NOTE : 
</p>
<ul>

<li>a. For a given patient, there should be only one probe from a given doctor.
   Many doctors can have probes on a single patient.</li>
   
<li>b. At any time, a patient can be probed by only one method. ie Email OR Phone OR SMS</li>
</ul>  

<h5><p class="text-info">2. pendingProbes</p></h5> 

<ul>
<li>probeID int(11)</li>
<li>requestTime datetime</li>
</ul>
<p>
When a probe is created in "createProbe.php" a new row is added in the pendingProbes table.
This row contains the time in GMT when a probe needs to be sent.
</p>
<p>
When a probe is sent at appropriate time, the old row is deleted and replaced with a new row with the new request time.
</p>


<h5><p class="text-info">3. sentProbeLog</p></h5> 


<p>Columns :  </p>
<ul>
 
<li>probeID 		-- Unique ID associated with a probe request</li>
<li>method 			-- 1-Email , 2-Phone , 3-SMS</li>
<li>requestTime 	-- Time this probe was sent</li>
<li>sid 			-- Unique ID associated with this probe (Generated Randomly for EMail, Twilio Provides for call and sms)</li>
<li>result			-- Details given below</li>
<li>emergency		-- 1 if this was an emergency probe, else 0</li>
</ul>

<p>NOTE : </p>

<p>Possible values for result :</p>
<ul> 
<li>0 : Pending . Probe Sent but no response received yet</li>
<li>1,2,3,4,5 : Corresponds to the User Response . Implies Very Bad,Bad,Normal,Good, Very Good</li>
<li>12 : Call was busy (Only possible for phone calls)</li>
<li>13 : Wrong number </li>
<li>14 : There was an exception when sending the probe. This exception is generated in push_server.php</li>
<li>15 : Probe Cancelled</li>
</ul>  

<p>          
When a probe is sent, "result" value is set to 0 (implies pending). 
</p>
<p>
When user replies, using the unique SID, the probe is identified, and result value is updated to user response
</p>
<p>
If probe fails, appropriate value is set as explained above
</p>


</br>
<h4><p class="text-primary">OTHER USEFUL INFORMATION</p></h4> 
<p>
All Icons are present in "images/ProbeIcons" Folder probe.html must always be running on server
</p>
<p>
In twilio account, change link of Receive_SMS to point to production . SMS will not work in development.
</p>


</br>
<h4><p class="text-primary">FILES ASSOCIATED WITH PROBE</p></h4> 

<ul>
<li>getProbeTable.php    			-- Used to fill out the probe table on PatientNetwork.php</li>
<li>createProbe.php      			-- Called when probe is to be created</li>
<li>getPatientContactInfo.php		-- Provides Patient contact info such as email and phone number. Used to fill out patient data on create probe popup</li>
<li>probe.html						-- Javascript service which call probeRequests.php at regular intervals. Should always be running on server</li>
<li>probeRequests.php				-- Used to send out probes and update pendingProbes table. Called by probe.html</li>
<li>push_server.php					-- Has all the methods for sending email,phone call and sms</li>
<li>Receive_SMS.php					-- Called by Twilio when it receives SMS from user. Please change link to Production in Twilio Account Settings</li>
<li>FeedbackCallback.php			-- For making Phone Calls</li>
<li>handle-user-feedback-input.php  -- For phone call. Records user response</li>
<li>phoneoptions.php				-- For phone call</li>
<li>revokeProbe.php					-- To cancel probe</li>
<li>getProbeData.php				-- Retrieve Information associated with a probe</li>
<li>restartProbe.php				-- To restart Probe</li>
<li>sendEmergencyProbe.php			-- To send emergency probe. Does same work as probeRequests.php</li>
<li>patientFeedback.php				-- Associated with Email. Called when patient provides response from his email</li>
<li>savePatientFeedback.php			-- Associated with Email. Saves patient Feedback. Called when user acknowledges on patientFeedback.php</li>
<li>stopFeedback.php				-- Associated with Email. Called when patient clicks on link to stop Feedback from his email</li>
<li>stopPatientFeedback.php			-- Associated with Email. Saves patient Feedback. Called when user acknowledges on patientFeedback.php</li>
</ul>
 


</p>

</br><p><i class="fa fa-wrench fa-fw" style="margin-right:10px;"></i><span>This page last edited by <span class="text-primary">Pallab Hazarika</span> on <span class="text-info">Oct 21, 2014</span></span></p>

                </div>
            </div>
            <!-- /.row -->
        </div>
        <!-- /#page-wrapper -->

    </div>
    <!-- /#wrapper -->

    <!-- Core Scripts - Include with every page -->
    <script src="js/jquery-1.10.2.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/plugins/metisMenu/jquery.metisMenu.js"></script>

    <!-- Page-Level Plugin Scripts - Dashboard -->
    <script src="js/plugins/morris/raphael-2.1.0.min.js"></script>
    <script src="js/plugins/morris/morris.js"></script>

    <!-- SB Admin Scripts - Include with every page -->
    <script src="js/sb-admin.js"></script>

    <!-- Page-Level Demo Scripts - Dashboard - Use for reference -->
    <script src="js/demo/dashboard-demo.js"></script>

</body>

</html>
