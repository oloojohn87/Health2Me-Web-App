$(document).ready(function(){function b(a){setTimeout(function(){if($("#ContenidoModal2").hide(),$("#Proceed").hide(),$("#CloseModal2").show(),0==a)x("Patient not found in database. Please try with another email address.");else if(a>1)x("More than one user for that email address. Please contact health2.me support.");else{var o="/ResetUserPac.php?email="+e,r=y(o);x(r)}},50)}function g(a){var e=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;return e.test(a)?!0:!1}function V(a,e,o){var r=$(o).val(),l=r,t=1;if(!N(r)){var i="Value not numeric";P(i,o),l="",t=0,$("#ValorGlobal").val("-1")}if(r>e){var i="Value too high";P(i,o),l="",t=0,$("#ValorGlobal").val("-1")}if(a>r){var i="Value too low";P(i,o),l="",t=0,$("#ValorGlobal").val("-1")}1==t&&(P("",o),$("#ValorGlobal").val("0")),$(o).val(l)}function G(a,e){var o=$(e).val(),r=o,l=1;if(a>10)switch(a){case 11:if(o.length<8){var t="Value must be at least 8 characters long";P(t,e),r="",l=0,$("#ValorGlobal").val("-1")}break;case 12:if(o.length<2){var t="Value must be at least 2 characters long";P(t,e),r="",l=0,$("#ValorGlobal").val("-1")}break;case 13:if(o.length<6){var t="Value must be at least 6 characters long";P(t,e),r="",l=0,$("#ValorGlobal").val("-1")}break;case 14:var i=y("CheckPrivateCode.php?code="+o);if("false"==i){var t="Invalid Access Code";P(t,e),r="",l=0,$("#ValorGlobal").val("-1")}break;case 15:if(0==g(o)){var t="Value must be a valid email format";alert(t),P(t,e),r="",l=0,$("#ValorGlobal").val("-1")}break;default:var t="Unknown error";P(t,e),r="",l=0,$("#ValorGlobal").val("-1")}1==l&&(P("",e),$("#ValorGlobal").val("0")),$(e).val(r)}function w(a,e){var o=$(a).val(),r=$(e).val();if(o!=r){var l="Values must be the same";P(l,a),P(l,e),quevalor="",$("#ValorGlobal").val("-1")}else P("",a),P("",e),$("#ValorGlobal").val("0")}function I(a,e){var o=$(e).val(),r=o,l=1,t=1;if(""!=o){var i="CheckPrevioPac.php?valor="+o+"&queTipo="+t,n=y(i);if(n>0){var s="Email already exists";P(s,e),r="",l=0,$("#ValorGlobal").val("-1")}}else l=1;1==l&&(P("",e),$("#ValorGlobal").val("0")),$(e).val(r)}function y(a){var e="SIN MODIFICACIÃ“N";return $.ajax({url:a,dataType:"html",async:!1,complete:function(){},success:function(a){"string"==typeof a&&(e=a)}}),e}function P(a){$("#error_msg").html('<p style="font-size:18px; color:white;text-align:center">'+a+"</p>"),$("#error_bar").slideDown("slow",function(){}),$("html,body").animate({scrollTop:$("#error_bar").offset().top},"slow")}function x(a){if(""==a)var e="0px";else var e="60px";$(".MsgStatus2").animate({height:e},500,function(){$(".MsgStatus2").html('<p style="font-size:18px; color:white; margin:10px; top:10px; position:relative;">'+a+"</p>")})}function k(){var a=$("#Year").val(),e=$("#Month").val(),o=$("#Day").val(),r=a+S(e,2)+S(o,2),l=E($("#Gender").is(":checked")),l=$("#Gender").val(),t=$("#OrderOB").val();0==l&&(l="0"),0==t&&(t="0");var i=r+l+t;$("#VIdUsFIXED").html(i),$("#VIdUsFIXED2").html(i),$("#VIdUsFIXEDINSERT").val(i)}function M(){var a=$("#Vname").val().toLowerCase().replace(".","").replace(" ",""),e=$("#Vsurname").val().toLowerCase().replace(".","").replace(" ",""),o=a+"."+e;$("#VIdUsFIXEDNAME").html(o),$("#VIdUsFIXEDNAME2").html(o),$("#VIdUsFIXEDNAMEINSERT").val(o)}function E(a){return a?1:0}function N(a){return!isNaN(a)}function S(a,e){for(var o=""+a;o.length<e;)o="0"+o;return o}var a=$.cookie("inmers_hti");"main"==a&&$('link[rel=stylesheet][href="css/loginCol.css"]').remove(),$.browser.msie&&window.open("ie_error.html","_self",!1),$(".tooltip").tooltipster(),$("#Year").bind("focusout",function(){V(1900,2020,$(this)),k()}),$("#Month").bind("focusout",function(){V(1,12,$(this)),k()}),$("#Day").bind("focusout",function(){V(1,31,$(this)),k()}),$("#Gender").bind("focusout change",function(){var a=$("#Gender").val();"0"!=a&&"1"!=a?P("Please select appropriate gender","#Gender"):P("","#Gender"),k()}),$("#OrderOB").bind("focusout",function(){V(0,5,$(this)),k()}),$("#Vname").bind("focus",function(){var a=$("#Gender").val();return"0"!=a&&"1"!=a&&P("Please select appropriate gender","#Gender"),"abc"}),$("#Vname").bind("focusout",function(){G(12,$(this)),M()}),$("#Vsurname").bind("focusout",function(){G(12,$(this)),M()}),$("#XPassword").bind("focusout",function(){G(11,$(this))}),$("#XPassword2").bind("focusout",function(){w("#XPassword","#XPassword2"),G(11,$(this))}),$("#email").bind("focusout",function(){$("#IDRESERV").html($(this).val()),G(13,$(this)),G(15,$(this)),I(1,$(this))}),$("#accesscode").bind("focusout",function(){G(14,$(this))}),$("#phone").intlTelInput(),$("#phone").bind("focusout",function(){0==$("#phone").intlTelInput("isValidNumber")?(P("Invalid Phone Number","#phone"),$("#ValorGlobal").val("-1")):($("#phone").val($("#phone").val().replace(/\s+/g,"")),$("#ValorGlobal").val("0"))}),$("#BotonEnviaF").bind("click",function(){var a=0,e=0;$("#Year").trigger("focusout"),a=$("#ValorGlobal").val(),0!=a&&(e=1),$("#Month").trigger("focusout"),a=$("#ValorGlobal").val(),0!=a&&(e=1),$("#Day").trigger("focusout"),a=$("#ValorGlobal").val(),0!=a&&(e=1),$("#Gender").trigger("focusout"),a=$("#ValorGlobal").val(),0!=a&&(e=1),$("#OrderOB").trigger("focusout"),a=$("#ValorGlobal").val(),0!=a&&(e=1),$("#Vname").trigger("focusout"),a=$("#ValorGlobal").val(),0!=a&&(e=1),$("#Vsurname").trigger("focusout"),a=$("#ValorGlobal").val(),0!=a&&(e=1),$("#XPassword2").trigger("focusout"),a=$("#ValorGlobal").val(),0!=a&&(e=1),$("#XPassword").trigger("focusout"),a=$("#ValorGlobal").val(),0!=a&&(e=1),$("#email").trigger("focusout"),a=$("#ValorGlobal").val(),0!=a&&(e=1),$("#phone").trigger("focusout"),a=$("#ValorGlobal").val(),0!=a&&(e=1),$("#accesscode").trigger("focusout"),a=$("#ValorGlobal").val(),0!=a&&(e=1),1!=e&&$("#BotonMod").trigger("click")}),$("#GrabaDatos").bind("click",function(){$("#FormSU").method="post",$("#FormSU").submit()}),$("#SignIn").bind("click",function(){$("#spin-icon").show();setTimeout(function(){$.post("validateloginUSER.php",{Nombre:$("#Nombre").val(),Password:$("#loginPass").val()}).done(function(a){$("#spin-icon").hide(),"0"==a?P("Invalid userid or password",""):"1"==a?($("#FormLOGIN").method="post",$("#FormLOGIN").submit()):P("Invalid userid or password","")})},500)}),$("#ForgotPassword").bind("click",function(){$(".MsgStatus2").html(""),$(".MsgStatus2").height(0),$("#ContenidoModal2").show(),$("#Proceed").show(),$("#CloseModal2").hide(),$("#ContenidoModal2").html('<p>Please enter your email to reset password:</p><p><span><input id="ResPas" name="ResPas" type="text" class="last-input" placeholder="email" title="Please insert your email" style="padding-left:10px; margin-top:5px;" /></span><span id="icon_ok" style="margin-left:25px;color:#58b820;display:none;"><span style="margin-right:10px">Email Found</span><i class="icon-ok-circle icon-2x"></i></span><span id="icon_error" style="margin-left:25px;color:#f54f4f;display:none;"><span style="margin-right:10px">Invalid Email</span><i class="icon-remove-circle icon-2x"></i></span></p>'),$("#BotonMod2").trigger("click")});var e="",o="",r="",l="",t="",i="",n="",s="",u="",c="",v="",f="",d="",p="",m="0";$("#Proceed").bind("click",function(){e=$("#ResPas").val();var a="/CheckPrevio2Pac.php?valor="+e+"&queTipo=1";o=y(a),r=o.indexOf("#"),l=o.substr(r+1),t=o.substr(0,r),i=l.indexOf("#"),n=l.substr(i+1),s=l.substr(0,i),u=n.indexOf("#"),c=n.substr(u+1),v=n.substr(0,u),f=c.indexOf("#"),d=c.substr(f+1),p=c.substr(0,f),0==t?($("#icon_error").show(),setTimeout(function(){b(t)},800)):t>1?($("#icon_error").show(),setTimeout(function(){b(t)},800)):($("#icon_ok").show(),b(t))}),$("#Wait1").hide().ajaxStart(function(){$("#Wait1").show(),$(this).show()}).ajaxStop(function(){$(this).hide()}),$("#close_error_bar").bind("click",function(){$("#error_bar").slideUp("slow"),$("#error_msg").html("")});var _=window.location.href.split("?"),C=_[1].split("&"),F=C[0].split("=")[1],D=C[1].split("=")[1];"NotesAndSummary"==C[0].split("=")[0]&&(m=1),0!=_[1].length&&1==m&&$.post("get_consultation_patient.php",{id:D},function(a){$("#Nombre").val(a),$("#Nombre").prop("readonly",!0),$("#inputs").append('<input type="hidden" value="'+F+'" name="notesAndSummary" id="notesAndSummary"/>'),$("#inputs").append('<input type="hidden" value="'+D+'"name="consultationId" id="consultationId"/>')})});