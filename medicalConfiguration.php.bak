<?php
session_start();
 require("environment_detail.php");
 $dbhost = $env_var_db['dbhost'];
 $dbname = $env_var_db['dbname'];
 $dbuser = $env_var_db['dbuser'];
 $dbpass = $env_var_db['dbpass'];
$CustomLook = 0;
if (isset($_SESSION['CustomLook'])&&($_SESSION['CustomLook']=="COL")) {
    $CustomLook = 'COL';
}    

if (isset($_SESSION['LAST_ACTIVITY']) && (time() - $_SESSION['LAST_ACTIVITY'] > 1800)) {
    // last request was more than 30 minutes ago
    session_unset();     // unset $_SESSION variable for the run-time 
    session_destroy();   // destroy session data in storage
    if ($_SESSION['CustomLook'] == 'COL') {
        echo "<META http-equiv='refresh' content='0;URL=index-col.html'>";
    } else {
        echo "<META http-equiv='refresh' content='0;URL=index.html'>";
    }    
}
$_SESSION['LAST_ACTIVITY'] = time(); // update last activity time stamp

$QueUsu= $_SESSION['MEDID'];
$Acceso = $_SESSION['Acceso'];
$privilege=$_SESSION['Previlege'];

$message = "";
if(isset($_GET['mes']))
{
    $message = urldecode($_GET['mes']);
}

if ($Acceso != '23432')
{
echo "Incorrect credentials for login";
echo "<br>\n"; 	
echo "<h2><a href='".$domain."'>Return to Inmers HomePage</a></h2>";
die;
}

					
// Connect to server and select databse.
$link = mysql_connect("$dbhost", "$dbuser", "$dbpass")or die("cannot connect");
mysql_select_db("$dbname")or die("cannot select DB");

$QueQuery = "SELECT * FROM doctors where id=".$QueUsu;
$result = mysql_query($QueQuery);
//$result = mysql_query("SELECT * FROM usuarios where IdUsFIXEDNAME='$NombreEnt' and IdUsRESERV='$PasswordEnt'");

$count=mysql_num_rows($result);
$row = mysql_fetch_array($result);
$success ='NO';
$telemed = 0;
$speciality = 'none';
$country = '';
$state = '';
$hospital_name = '';
$hospital_addr = '';
$timezone='';

$hr_rate = 0;
if($count==1){
	$success ='SI';
	$USERID = $row['id'];

	$MedID = $row['id'];
	$NombreEnt= $row['IdMEDEmail'];
	$PasswordEnt = $row['IdMEDRESERV'];

	$QueGender = $row['Gender'];
	$QueOrden = $row['OrderOB'];
	$IdUsFIXED = $row['IdMEDFIXED'];
    $timezone = $row['timezone'];
    
    
	$QueDOB = $row['DOB'];
   
    if ($QueDOB) {
   
       $Year = substr ($QueDOB,0,4);
	   $Month = substr ($QueDOB,4,2);
	   $Day = substr ($QueDOB,6,2);
	   $QueDOB = $Year.'-'.$Month.'-'.$Day; 
    }else {
	   $Year = substr ($IdUsFIXED,0,4);
	   $Month = substr ($IdUsFIXED,4,2);
	   $Day = substr ($IdUsFIXED,6,2);
	   $QueDOB = $Year.'-'.$Month.'-'.$Day;
    } 

	$UserName = $row['Name'];
	$UserSurname = $row['Surname'];
	$UserPassword = $row['IdMEDRESERV'];
	$IdUsRESERV = $row['IdMEDRESERV'];
	$IdUsFIXEDNAME = $row['IdMEDFIXEDNAME'];
    
    if(isset($row["hospital_name"]) && $row["hospital_name"] != null)
    {
        $hospital_name = $row["hospital_name"];
    }
    if(isset($row["hospital_addr"]) && $row["hospital_addr"] != null)
    {
        $hospital_addr = $row["hospital_addr"];
        
    }
    
    $telemed = $row['telemed'];
    $speciality = $row['speciality'];
    $location = $row['location'];
    $hr_rate = $row['hourly_rate'];
    if(strpos($location, ",") == false)
    {
        $country = $location;
    }
    else
    {
        $arr = explode(", ", $location);
        $state = $arr[0];
        $country = $arr[1];
    }
	$email = $row['IdMEDEmail'];
	$telefono = $row['phone'];
	
	$MedUserName = $row['Name'];
	$MedUserSurname = $row['Surname'];
		
//	$MedUserLogo = $row['ImageLogo'];
$QueEntrada = 1;  // 1= EDICIÓN , 2= CREACIÓN.
}
else
{
echo "MEDICAL USER NOT VALID. Incorrect credentials for login";
echo "<br>\n"; 	
echo "<h2><a href='".$domain."'>Return to Inmers HomePage</a></h2>";
die;
}

//BLOCKSLIFEPIN $result = mysql_query("SELECT * FROM blocks");
$result = mysql_query("SELECT * FROM lifepin");

$filename = "DoctorImage/".$MedID.".jpg";
    
if(!file_exists($filename))
{
    $filename = "PatientImage/defaultDP.jpg";
}

?>
<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <title>Inmers</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="css/style.css" rel="stylesheet">
    <link href="css/bootstrap.css" rel="stylesheet">
    
    <link rel="stylesheet" href="css/jquery-ui-1.8.16.custom.css" media="screen"  />
    <link rel="stylesheet" href="css/jquery-ui-autocomplete.css"  />
    <link rel="stylesheet" href="css/fullcalendar.css" media="screen"  />
    <link rel="stylesheet" href="css/chosen.css" media="screen"  />
    <link rel="stylesheet" href="css/datepicker.css" >
    <link rel="stylesheet" type="text/css" href="css/jquery.timepicker.css" />
    <link rel="stylesheet" href="css/colorpicker.css">
    <link rel="stylesheet" href="css/tooltipster.css">
    <link rel="stylesheet" href="css/glisse.css?1.css">
    <link rel="stylesheet" href="css/jquery.jgrowl.css">
    <link rel="stylesheet" href="js/elfinder/css/elfinder.css" media="screen" />
    <link rel="stylesheet" href="css/jquery.tagsinput.css" />
    <link rel="stylesheet" href="css/demo_table.css" >
    <link rel="stylesheet" href="css/jquery.jscrollpane.css" >
    <link rel="stylesheet" href="css/validationEngine.jquery.css">
    <link rel="stylesheet" href="css/jquery.stepy.css" />
    <link rel="stylesheet" type="text/css" href="js/uploadify/uploadify.css">
	<!--<link rel="stylesheet" href="css/icon/font-awesome.css">-->
	<link rel="stylesheet" href="font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="css/bootstrap-responsive.css">
    <link rel="stylesheet" href="build/css/intlTelInput.css">
    
    <?php
    if ($_SESSION['CustomLook']=="COL") { ?>
        <link href="css/styleCol.css" rel="stylesheet">
    <? } ?>

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lte IE 8]><script type="text/javascript" src="/js/excanvas.min.js"></script><![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/images/icons/favicon.ico">
	
	<!-- Create language switcher instance and set default language to en-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js" type="text/javascript">  </script>
<script src="jquery-lang-js-master/js/jquery-cookie.js" charset="utf-8" type="text/javascript"></script>
<script src="jquery-lang-js-master/js/jquery-lang.js" charset="utf-8" type="text/javascript"></script>
    
<script type="text/javascript">
	var lang = new Lang('en');
	window.lang.dynamic('th', 'jquery-lang-js-master/js/langpack/th.json');


function delete_cookie( name ) {
  document.cookie = name + '=; expires=Thu, 01 Jan 1970 00:00:01 GMT;';
}

function setCookie(name,value,days) {
confirm('Would you like to switch languages?');
delete_cookie('lang');
    if (days) {
        var date = new Date();
        date.setTime(date.getTime()+(days*24*60*60*1000));
        var expires = "; expires="+date.toGMTString();
    }
    else var expires = "";
    document.cookie = name+"="+value+expires+"; path=/";
	
	pageRefresh(); 
}

function setCookie2(name,value,days) {
//confirm('Would you like to switch languages?');
delete_cookie('lang');
    if (days) {
        var date = new Date();
        date.setTime(date.getTime()+(days*24*60*60*1000));
        var expires = "; expires="+date.toGMTString();
    }
    else var expires = "";
    document.cookie = name+"="+value+expires+"; path=/";
	
	pageRefresh(); 
}

function pageRefresh(){
location.reload();
}

//alert($.cookie('lang'));

var langType = $.cookie('lang');

if(langType == 'th'){
var language = 'th';
}else{
var language = 'en';
}

if(langType == 'th'){
setTimeout(function(){
window.lang.change('th');
lang.change('th');
//alert('th');
}, 5000);
}

if(langType == 'en'){
setTimeout(function(){
window.lang.change('en');
lang.change('en');
//alert('th');
}, 5000);
}
	

</script>

    <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-37863944-1']);
  _gaq.push(['_setDomainName', 'health2.me']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>    
  </head>

<!--  <body onload="CargaDatos(<?php echo $QueEntrada;?>);">-->
<script type="text/javascript" >
 	function CargaDatos(queEntrada)
	{
		if (queEntrada ==1)
		{
			//retf = $('#IdDoB').val();
			//alert (retf);
			$('#dp32').val($('#IdDoB').val());
			$('#gender').val($('#IdGender').val());
			$('#orderOB').val($('#IdOrden').val());
			
			$('#VIdUsFIXED').html($('#IdUsFIXED').val());

			$('#Vname').val($('#IdUserName').val());
			$('#Vsurname').val($('#IdUserSurname').val());
			$('#Vpassword').val($('#IdUserPassword').val());
			$('#password2').val($('#IdUserPassword').val());
			$('#VIdUsFIXEDNAME').html($('#IdUsFIXEDNAME').val());

			$('#Vemail').val($('#IdEmail').val());
			$('#Vphone').val('+'+$('#IdTelefono').val());

			$('#VIdUsFIXEDINSERT').html($('#IdUsFIXED').val());
			$('#VIdUsFIXEDNAMEINSERT').html($('#IdUsFIXEDNAME').val());

		}
	}  
</script>
<style>
                    .timeCellIndicator{
                        border-style: solid; 
                        border-width: 1px;
                        border-color: #BABABA;
                        height: 15px; 
                        width: 32px;
						cursor:pointer;
                    }
                    .timeCellIndicatorOff{
                        height: 15px; 
                        width: 8px;
                        margin-top: -1px;
                        float: left;
                    }
                    .timeCellIndicatorOn{
                        background-color: #3d94f6;
                        height: 15px;
                        width: 8px;
                        float: left;
                    }
					
					.timeCellIndicatorTempOn{
                        background-color: #3d94f6;
                        height: 15px;
                        width: 8px;
                        float: left;
                    }
					
                    .timeCellIndicatorMarked{
                        background-color: #A5A5A5;
                        border-style: solid; 
                        border-width: 1px;
                        border-color: #B2B2B2;
                        border-right-color: #FFFFFF;
                        height: 15px;
                        margin-top: -1px;
                        width: 32px;
                    }
                    .timeLabel{
                        color: #CACACA; 
                        font-size: 10px; 
                        margin-left: -10px;
                    }
                    .timeCell{
                        height: 40px; 
                        width: 32px; 
                        float: left;
                        margin-left: 1px;
                    }
                </style>

 
  <body onload="CargaDatos(<?php echo $QueEntrada; ?>)" >
<div class="loader_spinner"></div>
<div id="Loading"></div>

	<!--Header Start-->
	<div class="header" >
     	<input type="hidden" id="USERDID" Value="<?php echo $USERID; ?>">	
    	
    	<input type="hidden" id="IdDoB" Value="<?php echo $QueDOB; ?>">	
    	<input type="hidden" id="IdGender" Value="<?php echo $QueGender; ?>">	
    	<input type="hidden" id="IdOrden" Value="<?php echo $QueOrden; ?>">	
    	<input type="hidden" id="IdUsFIXED" Value="<?php echo $IdUsFIXED; ?>">	
    	
    	<input type="hidden" id="IdUserName" Value="<?php echo $UserName; ?>">	
    	<input type="hidden" id="IdUserSurname" Value="<?php echo $UserSurname; ?>">	
    	<input type="hidden" id="IdUserPassword" Value="<?php echo $UserPassword; ?>">	
    	<input type="hidden" id="IdUsFIXEDNAME" Value="<?php echo $IdUsFIXEDNAME; ?>">	
  
    	<input type="hidden" id="IdEmail" Value="<?php echo $email; ?>">	
    	<input type="hidden" id="IdTelefono" Value="<?php echo $telefono; ?>">	

    	<input type="hidden" id="IdMEDEmail" Value="<?php echo $MedUserEmail; ?>">	
    	<input type="hidden" id="IdMEDName" Value="<?php echo $MedUserName; ?>">	
    	<input type="hidden" id="IdMEDSurname" Value="<?php echo $MedUserSurname; ?>">	
    	<input type="hidden" id="IdMEDLogo" Value="<?php echo $MedUserLogo; ?>">	
    	<input type="hidden" id="IdMEDLogo" Value="<?php echo $MedUserLogo; ?>">	
        <input type="hidden" id="telemed_on" Value="<?php echo $telemed; ?>">
		
		<input type="hidden" id="notify_id">	
        <?php
  		        if ($_SESSION['CustomLook'] == 'COL') {
                    echo '<a href="index-col.html" class="logo"><h1>health2.me</h1></a>';
                } else {
                    echo '<a href="index.html" class="logo"><h1>health2.me</h1></a>';
                }    
           
           ?>
		   <div style="float:left;">
		   <a href="#en" onclick="setCookie('lang', 'en', 30); return false;"><img src="icons/english.png"></a>
		   </br>
			<a href="#sp" onclick="setCookie('lang', 'th', 30); return false;"><img src="icons/spain.png"></a>
			</div>
		   
           <div class="pull-right">
           
            
           <!--Button User Start-->
		   <div class="btn-group pull-right" >
           
            <a class="btn btn-profile dropdown-toggle" id="button-profile" data-toggle="dropdown" href="#">
              <span class="name-user"><strong lang="en">Welcome</strong>, <?php echo $MedUserName.' '.$MedUserSurname; ?></span> 
             <?php 
             $hash = md5( strtolower( trim( $email ) ) );
             $avat = 'identicon.php?size=29&hash='.$hash;
			?>	
              <span class="avatar" style="background-color:WHITE;"><img src="<?php echo $avat; ?>" alt="" ></span> 
              <span class="caret"></span>
            </a>
            <div class="dropdown-menu" id="prof_dropdown">
            <div class="item_m"><span class="caret"></span></div>
            <ul class="clear_ul" >
              <li><a href="MainDashboard.php" lang="en"><i class="icon-globe"></i> Home</a></li>
              
              <li><a href="medicalConfiguration.php" lang="en"><i class="icon-cog"></i> Settings</a></li>
              <li><a href="logout.php" lang="en"><i class="icon-off"></i> Sign Out</a></li>
            </ul>
            </div>
          </div>
          <!--Button User END-->  
          
          </div>
    </div>
    <!--Header END-->

    
    <!--Sidebar Start --->
<!--	<div id="sidebar">  -->
    <!--
      <ul class="menu-sidebar">
       <li><a href=""><i class="icon-home"></i> <span>Home</span></a></li>
       <li><a href="UserAccount.php?Acceso=23432&USERID='<?php echo $USERID; ?>'&Nombre=<?php echo $IdUsFIXEDNAME;?>&Password=<?php echo $IdUsRESERV;?>"><i class="icon-group"></i> <span>User</span></a></li>
       <li><a href="form_validation.php?Acceso=23432&USERID='<?php echo $USERID; ?>'"><i class="icon-edit"></i> <span>Setup</span></a></li>
      </ul>
    --> 
    
<!--    </div> --->
	<!--    Sidebar END-->

    
    <!--Content Start-->
	<div id="content" style="padding-left:0px; background: #F9F9F9; ">
    
   	  <!--- VENTANA MODAL  ---> 
   	  <button id="BotonModal" data-target="#header-modal" data-toggle="modal" class="btn btn-warning" style="display: none;" lang="en">Modal with Header</button>
   	  <div id="header-modal" class="modal hide" style="display: none;" aria-hidden="true">
         <div class="modal-header" lang="en">
             <button class="close" type="button" data-dismiss="modal">×</button>
                  Establish Connection with User
         </div>
         <div class="modal-body" lang="en">
             <p>Please confirm that you want to link with this user.</p>
         </div>
         <input type="hidden" id="queId">
         <div class="modal-footer">
	         <input type="button" class="btn btn-success" value="Confirm" id="ConfirmaLink">
             <a href="#" class="btn btn-primary" data-dismiss="modal" id="CloseModal" lang="en">Close</a>
         </div>
      </div>  
	  <!--- VENTANA MODAL  ---> 
	 <!--SpeedBar Start--->
     <div class="speedbar">
     <div class="speedbar-content">
     <ul class="menu-speedbar">
		
    	 <li><a href="MainDashboard.php" lang="en">Home</a></li>
         <?php if ($privilege!=3)
		 {
		      echo "<li><a href=\"dashboard.php\" lang=\"en\">Dashboard</a></li>";
         }
         ?>
    	 <li><a href="patients.php" lang="en">Members</a></li>
		 <?php if ($privilege==1)
		 {
				 echo '<li><a href="medicalConnections.php" lang="en">Doctor Connections</a></li>';
				 echo '<li><a href="PatientNetwork.php" lang="en">Member Network</a></li>';
		 }
		 ?>
         <li><a href="medicalConfiguration.php" class="act_link"  lang="en">Configuration</a></li>
         <li><a href="logout.php" style="color:#d9d907;" lang="en">Sign Out</a></li>
     </ul>

     
     </div>
     </div>
     <!--SpeedBar END-->
		  
     <div id="groupconfig" style="display:none; text-align:center; padding:20px;">
		 
		 <span id="grp_details" class="label label-info" style="left:0px; margin-left:34px; margin-top:20px; font-size:15px; " lang="en">Group Details</span>
		 <div style="margin-left:10px;margin-top:20px;padding-bottom:20px;">
		 
				
			
				<form enctype="multipart/form-data" method="post" style="float:left;margin-left:20px">
					<div class="row">
					  <!--<label for="fileToUpload">Select Files to Upload</label>-->
					  <div id="grpimage" title="Choose a group picture"><img style="width:150px;height:150px;margin-bottom:10px" src="images/defaultgrouppic.jpg" alt="Group Picture"/><br />
					  
					  </div>
					  <input type="file" name="filesToUpload[]" id="filesToUpload" multiple="multiple" style="width:99px" placeholder="Group Picture"/>
					  <!--<output id="filesInfo"></output>-->
					
					<!--<div class="row">
					  <input type="submit" value="Upload" />
					</div>-->
					</div> 
				</form>
				
				
			<p style="margin-top:30px">
			
 			<p> <span style="float:left;margin-left:120px" lang="en"> Group Name: </span> <input id="editgrpname" type="text" placeholder="Group Name" style="margin-left:0px"> </p>
			<p> <span style="float:left;margin-left:120px" lang="en"> Address : </span> <input id="editgrpadd" type="text" placeholder="Address" style="margin-left:20px">  </p>
			<p> <span style="float:left;margin-left:120px" lang="en"> ZIP: </span> <input id="editgrpzip" type="text" placeholder="ZIP" style="margin-left:60px"> </p>
			<p> <span style="float:left;margin-left:120px" lang="en"> City: </span> <input id="editgrpcity" type="text" placeholder="City" style="margin-left:50px"> </p>
			<p> <span style="float:left;margin-left:260px" lang="en"> State: </span> <input id="editgrpstate" type="text" placeholder="State" style="margin-left:49px"> </p>
			<p> <span style="float:left;margin-left:260px" lang="en"> Country: </span> <input id="editgrpcountry" type="text" placeholder="Country" style="margin-left:30px"> </p>
			
			</p>	 
								
			<div style="margin-top:20px;margin-left:-10px">
				<input id="Edit_group" type="button" class="btn btn-primary" style="margin-left:20px;margin-top:-10px" value="Edit Group">
				<input id="save_grpdate" type="button" class="btn btn-primary" style="margin-left:20px;margin-top:-10px;display:none" value="Save Group">
			</div>
		 </div>
		<div id="group_members" style="margin-left:15px"></div>
		
		<input type="button" id="remove_doc" class="btn btn-primary" style="margin-left:-490px;margin-top:30px;display:none" value="Remove">
		
		<div style="margin-top:20px;margin-left:35px">
		<span style="color:#22aeff; font-size:14px;float:left;" lang="en"> Add Users: </span>
		<input id="field_id" type="text" style="width: 40px; margin-top:30px; visibility:hidden;">
		<input id="DoctorSBox" type="text" style="width: 200px;margin-top:30px;float:left;"><span id="results_count"></span>		
		<input type="button" id="add_doctors"class="btn btn-primary" style=" margin-left: 320px;margin-top: -70px;" value="Add Doctors">
		</div>
		
		<!--<div style="margin-top:20px">
		<span style="color:#22aeff; font-size:14px;float:left;"> Add Administrator: </span>
		<input id="field_id1" type="text" style="width: 40px; margin-top:30px; visibility:hidden;">
		<input id="DoctorSBox1" type="text" style="width: 200px;margin-top:30px;margin-left:-40px;float:left;"><span id="results_count1"></span>		
		<input type="button" id="add_admin"class="btn btn-primary" style=" margin-left: 320px;margin-top: -70px;" value="Add Admin">
		</div>
		
		<div style="margin-top:20px">
		<span style="color:#22aeff; font-size:14px;float:left;"> Add Referral Receiver Incharge: </span>
		<input id="field_id2" type="text" style="width: 40px; margin-top:30px; visibility:hidden;">
		<input id="DoctorSBox2" type="text" style="width: 200px;margin-top:30px;margin-left:-140px;float:left;"><span id="results_count2"></span>		
		<input type="button" id="add_refdoc"class="btn btn-primary" style=" margin-left: 320px;margin-top: -70px;" value="Add Referral Incharge">
		</div>
		
		<div id="ownertab" style="margin-top:20px;">
		<span style="color:#22aeff; font-size:14px;float:left;"> Change Owner: </span>
		<input id="field_id3" type="text" style="width: 40px; margin-top:30px; visibility:hidden;">
		<input id="DoctorSBox3" type="text" style="width: 200px;margin-top:30px;margin-left:-20px;float:left;"><span id="results_count3"></span>		
		<input type="button" id="change_owner"class="btn btn-primary" style=" margin-left: 320px;margin-top: -70px;" value="Change Owner">
		</div>-->
	
	</div>
  
          
     <!--CONTENT MAIN START-->
	<div id="content" style="padding-left:0px;padding-bottom:0px; margin-left:0px; background-image:none;">
        <div style="width:1000px; margin: 0 auto; margin-top:30px;">
			<ul id="myTab" class="nav nav-tabs tabs-main">
			 <li class="active"><a href="#acct_config" data-toggle="tab" lang="en">Account</a></li>
             <li id="password_tab"><a href="#password_config" data-toggle="tab" lang="en">Password</a></li>
             <li id="payments_tab" style="display:none;"><a href="#payments_config" data-toggle="tab" lang="en">Payments</a></li>
            <li><a href="#notify_config" data-toggle="tab" lang="en">Notifications</a></li>
            <?php    
            
            if ($_SESSION['CustomLook'] != "COL") { 
            ?>    
			         <li><a href="#scheduler_config" data-toggle="tab" lang="en">Scheduler</a></li>
                     <li><a href="#emr_config" data-toggle="tab" lang="en">EMR Data</a></li>
			         <li><a href="#grp_config" data-toggle="tab" lang="en">Group</a></li>
            <? } ?>    
			<li><a href="#telemed_config" data-toggle="tab" lang="en">Telemedicine</a></li>
            <li id="appointments_tab" style="display:none;"><a href="#appointments_config" data-toggle="tab" id="app_config_button" lang="en">Appointments</a></li>
        </ul>
	        <!--Form Validation Start-->
			<div id="myTabContent" class="tab-content tabs-main-content padding-null" style="padding-left:0px; background: #F9F9F9; height:1000px;width:100%;">
				<div class="tab-pane tab-overflow-main fade in active" id="acct_config" style="padding-left:30px;">
			        <div class="grid" class="grid span4" style="width:700px; margin: 0 auto; margin-top:30px;">
						<div class="grid-content" style="padding-top:10px;">
				           	<div style="background-color: #22AEFF; color: #FFF; padding: 12px; border-radius: 8px; margin: auto; text-align: center; font-size:30px; width: 94%;" lang="en">Account Configuration</div>         
						    <div class="clearfix" style="margin-bottom:20px;"></div>

                            
				            <form id="formID" class="formular" method="post" action="UpdateMEDUser.php">
                 
                 <input type="hidden" id="EnviaUserid" name="EnviaUserid" Value="<?php echo $USERID; ?>">	
                 <input type="hidden" id="EnviaModo" name="EnviaModo" Value="<?php echo $QueEntrada; ?>">	
                 <input type="hidden" id="EnviaTipoUsuario" name="EnviaTipoUsuario" Value="2">	
                 <input type="hidden" id="VIdUsFIXEDINSERT" name="VIdUsFIXED" Value="<?php echo $IdUsFIXED; ?>">	
                 <input type="hidden" id="VIdUsFIXEDNAMEINSERT" name="VIdUsFIXEDNAME" Value="<?php echo $IdUsFIXEDNAME; ?>">	
                                
                 <div class="clearfix"></div>
                 </br>
                 <span style="font: bold 18px Arial, Helvetica, sans-serif; color: #3D93E0; cursor: auto; margin-left:20px; " lang="en">User Identification</span>
                 <!--<span id ="VIdUsFIXED" class="label label-success" style="float:right; font-size:18px; padding:5px 10px 5px 10px; font-family: “Andale Mono”, AndaleMono, monospace;">00000000</span>-->

                 <div class="clearfix"></div>
                 <div style="margin-left: 40px;">
                     <div class="formRow">
                            <label lang="en">Name: </label>
                            <div class="formRight">
                               <input value="" class="validate[required] span" type="text" name="Vname" id="Vname" style="width:360px;" placeholder="Name">
                            </div>
                     </div>
                     
                     <div class="formRow">
                            <label lang="en">Surname: </label>
                            <div class="formRight">
                               <input value="" class="validate[required] span" type="text" name="Vsurname" id="Vsurname" style="width:360px;" placeholder="Surname">
                            </div>
                     </div>
                    
                
                    <div id="CLICK">
                     <div class="formRow">
                         <label><span lang="en">Date of Birth</span>: </label>
                         <div class="formRight">
                         <!--<div class="validate[custom[date],past[2013/01/01]] input-append date" id="dpYears" data-date="12-02-2012" data-date-format="dd-mm-yyyy">
                             <input class="span2" size="16" type="text" value="12-02-2010" id="dp32" name="dp32" readonly="" style="width:330px;">
                             <span class="add-on" onclick='return false;'><i class="icon-calendar"></i></span>
                         </div>-->
                             <input id="dp32" name="dp32" type="date" value="2011-01-13"/>
                         </div>
                     </div>
                    </div>
                     
                     <div class="formRow">
                            <label><span lang="en">Gender</span>: </label>
                            <div class="formRight">
                                <select name="gender" id="gender" class="validate[required] span_select" style="width:360px;">
                                    <option value=""><span lang="en">Select Gender</span>:</option>
                                    <option value="0" lang="en">Female</option> 
                                    <option value="1" lang="en">Male</option>
                                </select>
                            </div>
                     </div>
                    <div class="formRow">
                        <label><span lang="en">Speciality</span>: </label>
                        <div class="formRight">
                            <select name="speciality" id="speciality" style="width:360px;">
                                <option value="Allergy and Immunology">Allergy and Immunology</option>
                                <option value="Anaesthetics">Anaesthetics</option>
                                <option value="Cardiology">Cardiology</option>
                                <option value="Cardiothoracic Surgery">Cardiothoracic Surgery</option>
                                <option value="Child & Adolescent Psychiatry">Child & Adolescent Psychiatry</option>
                                <option value="Clinical Neurophysiology">Clinical Neurophysiology</option>
                                <option value="Dermato-Venereology">Dermato-Venereology</option>
                                <option value="Dermatology">Dermatology</option>
                                <option value="-Emergency Medicine">Emergency Medicine</option>
                                <option value="Endocrinology">Endocrinology</option>
                                <option value="Gastroenterology">Gastroenterology</option>
                                <option value="General Practice">General Practice</option>
                                <option value="General Surgery">General Surgery</option>
                                <option value="Geriatrics">Geriatrics</option>
                                <option value="Gynaecology and Obstetrics">Gynaecology and Obstetrics</option>
                                <option value="Health Informatics">Health Informatics</option>
                                <option value="Infectious Diseases">Infectious Diseases</option>
                                <option value="Internal Medicine">Internal Medicine</option>
                                <option value="Interventional Radiology">Interventional Radiology</option>
                                <option value="Microbiology">Microbiology</option>
                                <option value="none">None</option>
                                <option value="Neonatology">Neonatology</option>
                                <option value="Nephrology">Nephrology</option>
                                <option value="Neurology">Neurology</option>
                                <option value="Neuroradiology">Neuroradiology</option>
                                <option value="Neurosurgery">Neurosurgery</option>
                                <option value="Nuclear Medicine">Nuclear Medicine</option>
                                <option value="Occupational Medicine">Occupational Medicine</option>
                                <option value="Oncology">Oncology</option>
                                <option value="Ophthalmology">Ophthalmology</option>
                                <option value="Oral and Maxillofacial Surgery">Oral and Maxillofacial Surgery</option>
                                <option value="Orthopaedics">Orthopaedics</option>
                                <option value="Otorhinolaryngology">Otorhinolaryngology</option>
                                <option value="Paediatric Cardiology">Paediatric Cardiology</option>
                                <option value="Paediatric Surgery">Paediatric Surgery</option>
                                <option value="Paediatrics">Paediatrics</option>
                                <option value="Pathology">Pathology</option>
                                <option value="Physical Medicine and Rehabilitation">Physical Medicine and Rehabilitation</option>
                                <option value="Plastic, Reconstructive and Aesthetic Surgery">Plastic, Reconstructive and Aesthetic Surgery</option>
                                <option value="Pneumology">Pneumology</option>
                                <option value="Psychiatry">Psychiatry</option>
                                <option value="Public Health">Public Health</option>
                                <option value="Radiology">Radiology</option>
                                <option value="Radiotherapy">Radiotherapy</option>
                                <option value="Stomatology">Stomatology</option>
                                <option value="Vascular Medicine">Vascular Medicine</option>
                                <option value="Vascular Surgery">Vascular Surgery</option>
                                <option value="Urology">Urology</option>
                            </select>
                        </div>
                     </div>
                                
                    <div class="formRow">
                         
                             <div style="margin-left:0px;">
                                 <p>
                                     <input type="checkbox" id="c2" name="cc" >
                                     <label for="c2" lang="en"><span></span> Part of a multiple birth ? (twins, triplets, etc.)</label>
                                 </p>
                             </div>
                                 <div class="clearfix"></div>
                 
                            <div id="MULTIPLE" style="margin-left:0px; display:none;">
                       
                            <label lang="en">Order of Birth: </label>
                            <div class="formRight">
                                <select name="orderOB" id="orderOB" style="width:200px;">
                                    <option value="" lang="en">Select Order:</option>
                                    <option value="1" lang="en">First</option> 
                                    <option value="2" lang="en">Second</option>
                                    <option value="3" lang="en">Third</option>
                                    <option value="4" lang="en">Fourth</option>
                                </select>
                            </div>
                            </div>
                     </div>
                 </div> 
                            
                <div class="clearfix"></div>
                 <hr>      
                            
                <span style="font: bold 18px Arial, Helvetica, sans-serif; color: #3D93E0; cursor: auto; margin-left:20px; " lang="en">Connections</span>
                <div style="margin-left: 40px;">
                      <div class="formRow">
                            <label><span lang="en">Email</span>: </label>
                            <div class="formRight">
                               <input value="" class="validate[required, custom[email]] span" type="email" name="Vemail" id="Vemail" style="width:310px;" placeholder="email">
                                <!--<input value="" class="validate[required, funcCall[checkHELLO]] span" type="email" name="Vemail" id="Vemail" style="width:310px;" placeholder="email">-->
                            </div>
                     </div>
                        <style>
                            .VphoneformError{
                                margin-left:5px;
                            }
                        </style>
                      <div class="formRow">
                            <label><span lang="en">Phone</span>: </label>
                            <div class="formRight">
                               <!--<input value="" type="text" name="Vphone" id="Vphone" style="width:300px;" placeholder="phone">-->
                                
                                <input id="Vphone" type="text" name="Vphone" class="intermediate-input validate[required, funcCall[checkPhoneFormat]] span" placeholder="phone" title="Please insert your phone number including country code(just numbers, no special characters or punctuation signs)"/>
                              
                            </div>
                     </div>
                 </div>
 
                 <div class="clearfix"></div>
                 <hr>

                 <span style="font: bold 18px Arial, Helvetica, sans-serif; color: #3D93E0; cursor: auto; margin-left:20px; " lang="en">Location</span>
                 <!--<span id ="VIdUsFIXEDNAME" class="label label-success" style="float:right; font-size:18px; padding:5px 10px 5px 10px; font-family: “Andale Mono”, AndaleMono, monospace;" lang="en">name.surname</span>-->
                 
                 </br></br>
                
                <div style="margin-left: 40px;">
                    <div class="formRow">
                        <label lang="en">Country: </label>
                        <div class="formRight">
                            <select id="country" name ="country"></select>
                        </div>
                     </div>
                    <div class="formRow" style="display: none;">
                        <label lang="en">Region: </label>
                        <div class="formRight">
                            <select name ="state" id ="state"></select>
                        </div>
                     </div>
                    <script type= "text/javascript" src = "js/countries.js"></script>
                    <script language="javascript">
                        populateCountries("country", "state");
                    </script>
                
                </div>
                
                 <div class="clearfix"></div>
                
                
                <hr>

                 <span style="font: bold 18px Arial, Helvetica, sans-serif; color: #3D93E0; cursor: auto; margin-left:20px; " lang="en">Hospital Information</span>
                <br/><br/>
                 <div style="margin-left: 40px;">
                     <div class="formRow">
                            <label lang="en">Hospital Name: </label>
                            <div class="formRight">
                               <input value="<?php echo $hospital_name; ?>" class="span" type="text" name="Hname" id="Hname" style="width:300px;" placeholder="Name">
                            </div>
                     </div>
                     
                     </br></br></br>
                    
                    <div class="formRow">
                            <label lang="en">Hospital Address: </label>
                            <div class="formRight">
                               <textarea name="Haddress" id="Haddress" rows="3" cols="25" style="width: 285px;" value=""><?php echo $hospital_addr; ?></textarea>
                            </div>
                     </div>
                    <script language="javascript">
                        populateCountries("Hcountry", "Hstate");
                    </script>
                </div>
                
                
                
                 <div class="clearfix"></div>
                
                
                
                
                
                 <hr>
 
                    <div>
                        <span style="font: bold 18px Arial, Helvetica, sans-serif; color: #3D93E0; cursor: auto; margin-left:20px; " lang="en">
                            Image
                         </span>
                         <div id="doctorImageDiv" style = "width: 80px; height: 80px; margin: auto;" lang="en">
                            <img src = "<?php echo $filename; ?>" id="doctorImage" style="width:80px; height:80px;"/>
                         </div>
                         <div id = "SelectFileButton" style="width: 130px; height: 35px; margin: auto;">
                            <input type="file" name="file_upload" id="file_upload" style="width: 150px; height: 35px;"/>
                         </div>
                    </div>
                
                <hr>
 
                    <div>
                        <span style="font: bold 18px Arial, Helvetica, sans-serif; color: #3D93E0; cursor: auto; margin-left:20px; " lang="en">
                            Certifications
                         </span>
                        <style>
                            .add_new_certification_button{
                                width: 100%;
                                height: 35px;
                                border: 0px solid #FFF;
                                outline: 0px;
                                border-radius: 5px;
                                color: #FFF;
                                background-color: #22AEFF;
                            }
                            .certification_button{
                                width: 100%;
                                height: 30px;
                                border: 0px solid #FFF;
                                outline: 0px;
                                border-radius: 5px;
                                color: #FFF;
                                background-color: #22AEFF;
                            }
                        </style>
                        <input type="hidden" id="certifications_max_count" name="certifications_max_count" value ="0" />
                        <div id="certifications_container">
                            <!--<div style="width:78%; height: 70px; background-color: #FBFBFB; border: 1px solid #E5E5E5; padding: 2%; margin: auto; margin-bottom: 10px; margin-top: 15px;">
                                <div style="width: 100px; height: 70px; float: right;">
                                    <button class="certification_button">Change Image</button>
                                    <input type="file" id="certification_file_1" name="certification_file_1" style="display: none;" />
                                    <input type="hidden" id="certification_filedata_1" name="certification_filedata_1" />
                                    <button class="certification_button" style="background-color: #D84840; margin-top: 10px;">delete</button>
                                </div>
                                <img id="certification_image_1" style="width: 70px; height: 70px; float: right; margin-right: 60px;" />
                                <input type="text" id="certification_name_1" name="certification_name_1" placeholder="Certification Name" style="border: 1px solid #CCC; box-shadow: none; width: 216px; height: 25px; border-radius: 0px; padding: 4px; padding-left: 10px; margin-bottom: 0px; border-top-left-radius: 5px; border-top-right-radius: 5px;"  />
                                <div style="width: 100%; height: 40px; margin-top: 0px;">
                                    <div style="height: 22px; width: 64px; border: 1px solid #CCC; border-right: 0px solid #333; float: left; padding: 4px; padding-left: 10px; padding-top: 7px; background-color: #FFF; color: #989898;  border-bottom-left-radius: 5px;">Start Date: </div>
                                    <input type="date" name="certification_date_1" id="certification_date_1"  style="height: 25px; width: 140px; float: left; border: 1px solid #CCC; border-left: 0px solid #333; border-radius: 0px; color: #989898; box-shadow: none; outline: 0px;  border-bottom-right-radius: 5px;" />
                                </div>
                            </div>-->
                        </div>
                        <div style="margin: auto; width: 90%; height: 35px; margin-top: 10px;">
                            <button class="add_new_certification_button" lang="en">Add Certification</button>
                        </div>
                    </div>
                     
                 <hr>

                 </br>
                 <div style="width: 200px; margin: auto;">
                    <input lang="en" id="submit_button" type="submit" class="btn btn-large btn-primary" value="Save" style="background-color: #22AEFF; width:200px;">
                 </div>
            
                </form>
                 <div class="clear"></div>
            
            </form>  
						</div>
					</div>
				</div>

<!-- RESET PASSWORD -->
                <div class="tab-pane" id="password_config" >
					<div class="grid" class="grid span4" style="width:700px; margin: 0 auto; margin-top:30px; height: 300px;">
						<div class="grid-content" style="padding-top:10px;">
							 <div style="background-color: #22AEFF; color: #FFF; padding: 12px; border-radius: 8px; margin: auto; text-align: center; font-size:30px; width: 94%;" lang="en">Change Password</div>
                            
                            <div style="width: 550px; height:300px; margin: auto; margin-top: 20px;">
                                <div id="password_notification_container" style="width: 600px; height: 30px; margin-top: 20px; opacity: 0.0;">
                                    <div id="password_notification" style="height: 30px; text-align: center; padding-top: 10px; width: 500px; background-color: #888; border-radius: 20px; margin-left: 50px; position: relative;"></div>
                                </div>
                                <div style="width: 100%; height: 40px; margin-top: 30px;">
                                    <div style="float: left; margin-top: 6px; margin-bottom: -6px; color: #777; width: 200px; text-align: left;" lang="en">Type current password: </div>
                                        <input id="pw1" type="password" style="float: left; height: 15px; width: 200px; padding: 7px; color: #444;" value="" />
                                            <button id="change_password_validate_button" style="width: 75px; height: 30px; background-color: #52D859; color: #FFF; border-radius: 7px; border: 0px solid #FFF; float: left; margin-left: 10px; outline: 0px;" lang="en">Validate</button>
                                </div>
                                <div id="change_password_validated_section" style="display: none;">
                                    <div style="width: 100%; height: 40px;">
                                        <div style="float: left; margin-top: 6px; margin-bottom: -6px; color: #777; width: 200px; text-align: left;" lang="en">Type new password: </div>
                                        <input id="pw2" type="password" style="float: left; height: 15px; width: 200px; padding: 7px; color: #444;" value="" />
                                    </div>
                                    <div style="width: 100%; height: 40px;">
                                        <div style="float: left; margin-top: 6px; margin-bottom: -6px; color: #777; width: 200px; text-align: left;" lang="en">Retype new password: </div>
                                        <input id="pw3" type="password" style="float: left; height: 15px; width: 200px; padding: 7px; color: #444;" value="" />
                                        <button id="change_password_finish_button" style="width: 75px; height: 30px; background-color: #52D859; color: #FFF; border-radius: 7px; border: 0px solid #FFF; float: left; margin-left: 10px; outline: 0px;" lang="en">Finish</button>
                                    </div>
                                </div>
                                
                            </div>
                            
                        </div>
                    </div>
                </div>
<!-- END RESET PASSWORD -->
<!-- PAYMENTS CONFIGURATION -->
                <div class="tab-pane" id="payments_config" >
					<div class="grid" class="grid span4" style="width:700px; margin: 0 auto; margin-top:30px;">
						<div class="grid-content" style="padding-top:10px;">
							 <div style="background-color: #22AEFF; color: #FFF; padding: 12px; border-radius: 8px; margin: auto; text-align: center; font-size:30px; width: 94%;" lang="en">Payments Configuration</div>
                            <div id="credit_card_loader" style="width: 220px; height: 19px; margin: 10px auto; visibility: hidden;">
                                <img src="images/load/8.gif" alt="">
                            </div>
                             <style>
                                .credit_card_row{
                                    background-color: #FBFBFB;
                                    color: #222;
                                    border: 1px solid #E6E6E6;
                                    width: 80%;
                                    height: 35px;
                                    padding: 4px;
                                    letter-spacing: 5px;
                                    font-weight: normal;
                                    margin: auto;
                                }
                                .credit_card_button{
                                    width: 100%; 
                                    height: 30px; 
                                    background-color: #52D859; 
                                    border: 0px solid #FFF; 
                                    color: #FFF; 
                                    outline: 0px; 
                                    border-radius: 5px;
                                    padding: 4px;
                                }
                                .credit_card_notification{
                                    width: 57%; 
                                    height: 18px; 
                                    background-color: #52D859; 
                                    border: 0px solid #FFF; 
                                    color: #FFF; 
                                    outline: 0px; 
                                    border-radius: 10px;
                                    padding: 6px;
                                    margin: auto;
                                    margin-top: 20px;
                                    text-align: center;
                                }
                            </style>
                            <div id="credit_cards_container" style="width: 70%; margin-left: auto; margin-right: auto;">
                                <div class="credit_card_row" style="border-radius: 10px; display: none;">
                                    <img src="images/credit_card_icons/bank.png" style="float: left; margin-left: 10px; height: 38px;" />
                                    <span id="current_bank_account_number" style="float: left; color: #5A5A5A; font-size: 14px; margin-left: 90px; margin-top: 8px;"></span>
                                </div>
                                <!--<div class="credit_card_row">
                                    <button id="clear_credit_card" style="width: 18px; height: 18px; float: right; color: #F00; padding: 0px; background-color: inherit; border: 0px solid #FFF; border-radius: 3px; outline: 0px;">
                                        <i class="icon-remove" style="width: 12px; height: 12px;"></i>
                                    </button>
                                    <img src="images/credit_card_icons/mastercard.png" style="float: left; margin-left: 10px; height: 38px;" />
                                    <span style="float: left; color: #5A5A5A; font-size: 14px; margin-left: 60px; margin-top: 8px;">****     ****     ****      5231</span>
                                </div>
                                <div class="credit_card_row" style="border-bottom-left-radius: 10px; border-bottom-right-radius: 10px;">
                                    <button id="clear_credit_card" style="width: 18px; height: 18px; float: right; color: #F00; padding: 0px; background-color: inherit; border: 0px solid #FFF; border-radius: 3px; outline: 0px;">
                                        <i class="icon-remove" style="width: 12px; height: 12px;"></i>
                                    </button>
                                    <img src="images/credit_card_icons/american_express.png" style="float: left; margin-left: 10px; height: 38px;" />
                                    <span style="float: left; color: #5A5A5A; font-size: 14px; margin-left: 60px; margin-top: 8px;">****     ****     ****     7396</span>
                                </div>-->
        
                            </div>
                            <div style="width: 56%; height: 190px; margin: auto; margin-top: 20px;">
                                <input type="text" id="bank_account_name" maxLength="16" placeholder="Enter full name on bank account" style="width: 97%; height: 20px; border-radius: 5px;">
                                <input type="text" onkeypress="return isNumberKey(event)" id="bank_account_number" maxLength="16" placeholder="Enter bank account number" style="width: 97%; height: 20px; border-radius: 5px;">
                                <script>
                                function isNumberKey(evt)
                                {
                                    var charCode = (evt.which) ? evt.which : event.keyCode
                                    if (charCode > 31 && (charCode < 48 || charCode > 57) && charCode != 45)
                                        return false;
                                    return true;
                                } 
                                </script>
                                <select id="bank_account_country" style="width: 100%; height: 30px; font-size: 12px; border-radius: 0px; border-top-right-radius: 5px; border-bottom-right-radius: 5px;">
                                    <option value="NONE">Select Country</option>
                                    <option value="AF">Afghanistan</option>
                                    <option value="AX">Åland Islands</option>
                                    <option value="AL">Albania</option>
                                    <option value="DZ">Algeria</option>
                                    <option value="AS">American Samoa</option>
                                    <option value="AD">Andorra</option>
                                    <option value="AO">Angola</option>
                                    <option value="AI">Anguilla</option>
                                    <option value="AQ">Antarctica</option>
                                    <option value="AG">Antigua and Barbuda</option>
                                    <option value="AR">Argentina</option>
                                    <option value="AM">Armenia</option>
                                    <option value="AW">Aruba</option>
                                    <option value="AU">Australia</option>
                                    <option value="AT">Austria</option>
                                    <option value="AZ">Azerbaijan</option>
                                    <option value="BS">Bahamas</option>
                                    <option value="BH">Bahrain</option>
                                    <option value="BD">Bangladesh</option>
                                    <option value="BB">Barbados</option>
                                    <option value="BY">Belarus</option>
                                    <option value="BE">Belgium</option>
                                    <option value="BZ">Belize</option>
                                    <option value="BJ">Benin</option>
                                    <option value="BM">Bermuda</option>
                                    <option value="BT">Bhutan</option>
                                    <option value="BO">Bolivia, Plurinational State of</option>
                                    <option value="BQ">Bonaire, Sint Eustatius and Saba</option>
                                    <option value="BA">Bosnia and Herzegovina</option>
                                    <option value="BW">Botswana</option>
                                    <option value="BV">Bouvet Island</option>
                                    <option value="BR">Brazil</option>
                                    <option value="IO">British Indian Ocean Territory</option>
                                    <option value="BN">Brunei Darussalam</option>
                                    <option value="BG">Bulgaria</option>
                                    <option value="BF">Burkina Faso</option>
                                    <option value="BI">Burundi</option>
                                    <option value="KH">Cambodia</option>
                                    <option value="CM">Cameroon</option>
                                    <option value="CA">Canada</option>
                                    <option value="CV">Cape Verde</option>
                                    <option value="KY">Cayman Islands</option>
                                    <option value="CF">Central African Republic</option>
                                    <option value="TD">Chad</option>
                                    <option value="CL">Chile</option>
                                    <option value="CN">China</option>
                                    <option value="CX">Christmas Island</option>
                                    <option value="CC">Cocos (Keeling) Islands</option>
                                    <option value="CO">Colombia</option>
                                    <option value="KM">Comoros</option>
                                    <option value="CG">Congo</option>
                                    <option value="CD">Congo, the Democratic Republic of the</option>
                                    <option value="CK">Cook Islands</option>
                                    <option value="CR">Costa Rica</option>
                                    <option value="CI">Côte d'Ivoire</option>
                                    <option value="HR">Croatia</option>
                                    <option value="CU">Cuba</option>
                                    <option value="CW">Curaçao</option>
                                    <option value="CY">Cyprus</option>
                                    <option value="CZ">Czech Republic</option>
                                    <option value="DK">Denmark</option>
                                    <option value="DJ">Djibouti</option>
                                    <option value="DM">Dominica</option>
                                    <option value="DO">Dominican Republic</option>
                                    <option value="EC">Ecuador</option>
                                    <option value="EG">Egypt</option>
                                    <option value="SV">El Salvador</option>
                                    <option value="GQ">Equatorial Guinea</option>
                                    <option value="ER">Eritrea</option>
                                    <option value="EE">Estonia</option>
                                    <option value="ET">Ethiopia</option>
                                    <option value="FK">Falkland Islands (Malvinas)</option>
                                    <option value="FO">Faroe Islands</option>
                                    <option value="FJ">Fiji</option>
                                    <option value="FI">Finland</option>
                                    <option value="FR">France</option>
                                    <option value="GF">French Guiana</option>
                                    <option value="PF">French Polynesia</option>
                                    <option value="TF">French Southern Territories</option>
                                    <option value="GA">Gabon</option>
                                    <option value="GM">Gambia</option>
                                    <option value="GE">Georgia</option>
                                    <option value="DE">Germany</option>
                                    <option value="GH">Ghana</option>
                                    <option value="GI">Gibraltar</option>
                                    <option value="GR">Greece</option>
                                    <option value="GL">Greenland</option>
                                    <option value="GD">Grenada</option>
                                    <option value="GP">Guadeloupe</option>
                                    <option value="GU">Guam</option>
                                    <option value="GT">Guatemala</option>
                                    <option value="GG">Guernsey</option>
                                    <option value="GN">Guinea</option>
                                    <option value="GW">Guinea-Bissau</option>
                                    <option value="GY">Guyana</option>
                                    <option value="HT">Haiti</option>
                                    <option value="HM">Heard Island and McDonald Islands</option>
                                    <option value="VA">Holy See (Vatican City State)</option>
                                    <option value="HN">Honduras</option>
                                    <option value="HK">Hong Kong</option>
                                    <option value="HU">Hungary</option>
                                    <option value="IS">Iceland</option>
                                    <option value="IN">India</option>
                                    <option value="ID">Indonesia</option>
                                    <option value="IR">Iran, Islamic Republic of</option>
                                    <option value="IQ">Iraq</option>
                                    <option value="IE">Ireland</option>
                                    <option value="IM">Isle of Man</option>
                                    <option value="IL">Israel</option>
                                    <option value="IT">Italy</option>
                                    <option value="JM">Jamaica</option>
                                    <option value="JP">Japan</option>
                                    <option value="JE">Jersey</option>
                                    <option value="JO">Jordan</option>
                                    <option value="KZ">Kazakhstan</option>
                                    <option value="KE">Kenya</option>
                                    <option value="KI">Kiribati</option>
                                    <option value="KP">Korea, Democratic People's Republic of</option>
                                    <option value="KR">Korea, Republic of</option>
                                    <option value="KW">Kuwait</option>
                                    <option value="KG">Kyrgyzstan</option>
                                    <option value="LA">Lao People's Democratic Republic</option>
                                    <option value="LV">Latvia</option>
                                    <option value="LB">Lebanon</option>
                                    <option value="LS">Lesotho</option>
                                    <option value="LR">Liberia</option>
                                    <option value="LY">Libya</option>
                                    <option value="LI">Liechtenstein</option>
                                    <option value="LT">Lithuania</option>
                                    <option value="LU">Luxembourg</option>
                                    <option value="MO">Macao</option>
                                    <option value="MK">Macedonia, the former Yugoslav Republic of</option>
                                    <option value="MG">Madagascar</option>
                                    <option value="MW">Malawi</option>
                                    <option value="MY">Malaysia</option>
                                    <option value="MV">Maldives</option>
                                    <option value="ML">Mali</option>
                                    <option value="MT">Malta</option>
                                    <option value="MH">Marshall Islands</option>
                                    <option value="MQ">Martinique</option>
                                    <option value="MR">Mauritania</option>
                                    <option value="MU">Mauritius</option>
                                    <option value="YT">Mayotte</option>
                                    <option value="MX">Mexico</option>
                                    <option value="FM">Micronesia, Federated States of</option>
                                    <option value="MD">Moldova, Republic of</option>
                                    <option value="MC">Monaco</option>
                                    <option value="MN">Mongolia</option>
                                    <option value="ME">Montenegro</option>
                                    <option value="MS">Montserrat</option>
                                    <option value="MA">Morocco</option>
                                    <option value="MZ">Mozambique</option>
                                    <option value="MM">Myanmar</option>
                                    <option value="NA">Namibia</option>
                                    <option value="NR">Nauru</option>
                                    <option value="NP">Nepal</option>
                                    <option value="NL">Netherlands</option>
                                    <option value="NC">New Caledonia</option>
                                    <option value="NZ">New Zealand</option>
                                    <option value="NI">Nicaragua</option>
                                    <option value="NE">Niger</option>
                                    <option value="NG">Nigeria</option>
                                    <option value="NU">Niue</option>
                                    <option value="NF">Norfolk Island</option>
                                    <option value="MP">Northern Mariana Islands</option>
                                    <option value="NO">Norway</option>
                                    <option value="OM">Oman</option>
                                    <option value="PK">Pakistan</option>
                                    <option value="PW">Palau</option>
                                    <option value="PS">Palestinian Territory, Occupied</option>
                                    <option value="PA">Panama</option>
                                    <option value="PG">Papua New Guinea</option>
                                    <option value="PY">Paraguay</option>
                                    <option value="PE">Peru</option>
                                    <option value="PH">Philippines</option>
                                    <option value="PN">Pitcairn</option>
                                    <option value="PL">Poland</option>
                                    <option value="PT">Portugal</option>
                                    <option value="PR">Puerto Rico</option>
                                    <option value="QA">Qatar</option>
                                    <option value="RE">Réunion</option>
                                    <option value="RO">Romania</option>
                                    <option value="RU">Russian Federation</option>
                                    <option value="RW">Rwanda</option>
                                    <option value="BL">Saint Barthélemy</option>
                                    <option value="SH">Saint Helena, Ascension and Tristan da Cunha</option>
                                    <option value="KN">Saint Kitts and Nevis</option>
                                    <option value="LC">Saint Lucia</option>
                                    <option value="MF">Saint Martin (French part)</option>
                                    <option value="PM">Saint Pierre and Miquelon</option>
                                    <option value="VC">Saint Vincent and the Grenadines</option>
                                    <option value="WS">Samoa</option>
                                    <option value="SM">San Marino</option>
                                    <option value="ST">Sao Tome and Principe</option>
                                    <option value="SA">Saudi Arabia</option>
                                    <option value="SN">Senegal</option>
                                    <option value="RS">Serbia</option>
                                    <option value="SC">Seychelles</option>
                                    <option value="SL">Sierra Leone</option>
                                    <option value="SG">Singapore</option>
                                    <option value="SX">Sint Maarten (Dutch part)</option>
                                    <option value="SK">Slovakia</option>
                                    <option value="SI">Slovenia</option>
                                    <option value="SB">Solomon Islands</option>
                                    <option value="SO">Somalia</option>
                                    <option value="ZA">South Africa</option>
                                    <option value="GS">South Georgia and the South Sandwich Islands</option>
                                    <option value="SS">South Sudan</option>
                                    <option value="ES">Spain</option>
                                    <option value="LK">Sri Lanka</option>
                                    <option value="SD">Sudan</option>
                                    <option value="SR">Suriname</option>
                                    <option value="SJ">Svalbard and Jan Mayen</option>
                                    <option value="SZ">Swaziland</option>
                                    <option value="SE">Sweden</option>
                                    <option value="CH">Switzerland</option>
                                    <option value="SY">Syrian Arab Republic</option>
                                    <option value="TW">Taiwan, Province of China</option>
                                    <option value="TJ">Tajikistan</option>
                                    <option value="TZ">Tanzania, United Republic of</option>
                                    <option value="TH">Thailand</option>
                                    <option value="TL">Timor-Leste</option>
                                    <option value="TG">Togo</option>
                                    <option value="TK">Tokelau</option>
                                    <option value="TO">Tonga</option>
                                    <option value="TT">Trinidad and Tobago</option>
                                    <option value="TN">Tunisia</option>
                                    <option value="TR">Turkey</option>
                                    <option value="TM">Turkmenistan</option>
                                    <option value="TC">Turks and Caicos Islands</option>
                                    <option value="TV">Tuvalu</option>
                                    <option value="UG">Uganda</option>
                                    <option value="UA">Ukraine</option>
                                    <option value="AE">United Arab Emirates</option>
                                    <option value="GB">United Kingdom</option>
                                    <option value="US">United States</option>
                                    <option value="UM">United States Minor Outlying Islands</option>
                                    <option value="UY">Uruguay</option>
                                    <option value="UZ">Uzbekistan</option>
                                    <option value="VU">Vanuatu</option>
                                    <option value="VE">Venezuela, Bolivarian Republic of</option>
                                    <option value="VN">Viet Nam</option>
                                    <option value="VG">Virgin Islands, British</option>
                                    <option value="VI">Virgin Islands, U.S.</option>
                                    <option value="WF">Wallis and Futuna</option>
                                    <option value="EH">Western Sahara</option>
                                    <option value="YE">Yemen</option>
                                    <option value="ZM">Zambia</option>
                                    <option value="ZW">Zimbabwe</option>
                                </select>
  
                                <input type="text" onkeypress="return isNumberKey(event)" id="bank_account_routing_number" maxLength="16" placeholder="Enter routing number" style="width: 97%; height: 20px; float: left; border-radius: 5px;">
                                <button id="add_card_button" style="width: 48%; height: 30px; background-color: #52D859; border-radius: 0px; border: 0px solid #FFF; color: #FFF; float: left; outline: 0px; border-radius: 5px;" lang="en">Set Bank Account</button>
                                <button id="remove_card_button" style="width: 48%; height: 30px; background-color: #D84840; border-radius: 0px; border: 0px solid #FFF; color: #FFF; float: left; outline: 0px; margin-left: 4%; border-radius: 5px;" lang="en">Clear Bank Account</button>
                            
                            </div>
                            <div class="credit_card_notification" style="opacity: 0.0;">
                                Card Added!
                            </div>
                             
                            
                            
                        </div>
                    </div>
                </div>



<!--CONTENT MAIN END-->
				<div class="tab-pane" id="notify_config" >
					<div class="grid" class="grid span4" style="width:700px; margin: 0 auto; margin-top:30px;">
						<div class="grid-content" style="padding-top:30px;">
							 <span class="label label-info" style="left:0px; margin-left:10px; margin-top:40px; font-size:30px; " lang="en">Notification Configuration</span>
						     <div class="clearfix" style="margin-bottom:20px;"></div>
							 <form id="formID" class="formular" method="post" action="">
                
				<div class="clearfix"></div>
                
            
          
 
                  <div class="formRow" style="margin-bottom:50px;">
                     
	                     <div style="margin-left:10px; padding-bottom:20px;">
		                     <p>
			                     <input type="checkbox" id="notify_link" name="cc" >
			                     <label for="notify_link" lang="en"><span></span> Send Internal Notifications to external Email ID</label>
			                 </p>
	                     </div>
	                         <div class="clearfix"></div>
             
                        <!--<div id="MULTIPLE" style="margin-left:0px; display:block;">
                   
                        <label>Order of Birth: </label>
                        <div class="formRight">
                            <select name="orderOB" id="orderOB" style="width:200px;">
                                <option value="">Select Order:</option>
                                <option value="1">First</option> 
                                <option value="2">Second</option>
                                <option value="3">Third</option>
                                <option value="4">Fourth</option>
                            </select>
                        </div>
                        </div>-->
                 </div>
				 <div class="clearfix"></div>
				 <div class="clearfix"></div>
				 <div class="clearfix"></div>
				 <hr>
				  <input type="button" class="btn btn-large btn-primary" id="notif_update" lang="en" value="Update" style="width:200px;">
				</form> 
						</div>	 
					</div>
				</div>
				<div class="tab-pane" id="scheduler_config">
							<div class="grid" class="grid span4" style="width:700px; margin: 0 auto; margin-top:30px;">
								<div class="grid-content" style="padding-top:30px;">
									 <span class="label label-info" style="left:0px; margin-left:10px; margin-top:40px; font-size:30px;" lang="en">Scheduler Configuration</span>
								     <div class="clearfix" style="margin-bottom:20px;"></div>
								     <div class="clearfix"></div>
						             		<span style="font: bold 18px Arial, Helvetica, sans-serif; color: #3D93E0; cursor: auto; margin-left:20px; " lang="en">Visit Types : </span>
											<center>
											<div id="CLICK_EVENT"></div>
											</center>
											<div class="clearfix"></div>
											<br>
											<input type="button" class="btn btn-primary" value="Add more Visit Types" onClick="add_visit_types();" >
											<div class="clearfix"></div>
											<hr>
											<div style="margin-top:-15px;">
											<span lang="en">Send Appointment Notification before</span> &nbsp &nbsp <select id="appoint_notify" style="width:8em;margin-top:10px"> </select>&nbsp <span lang="en">minutes</span>
										 
											</div>
										 <!--<div class="clearfix"></div>-->
										     <hr>
											 <div style="margin-top:-15px;">
											<span lang="en">Timezone</span> &nbsp : &nbsp <select id="Timezone" style="width:15em;margin-top:10px"> </select>
										 
											</div>
											<hr>
										<!--<br><br>-->
										  
										 
										 <!--<br><br>-->
										 <!--<center>-->
											 <input type="button" class="btn btn-large btn-primary" onClick="saveSchedulerConfig();" lang="en" value="UPDATE" style="width:200px;margin-top:20px;">
									     <!--</center>-->
										 
										<br>
								</div>		
							</div>
				 </div>
				 
				 <div class="tab-pane" id="emr_config">
							<div class="grid" class="grid span4" style="width:700px; margin: 0 auto; margin-top:30px;">
								<div class="grid-content" style="padding-top:30px;">
									 <span class="label label-info" style="left:0px; margin-left:10px; margin-top:40px; font-size:30px;" lang="en">EMR Configuration</span>
								     <div class="clearfix" style="margin-bottom:20px;"></div>
								     <div class="clearfix"></div>
											<br>
						             		<input type="checkbox" id="emr_demographics" checked disabled="true"><label for="emr_demographics" style="font: bold 18px Arial, Helvetica, sans-serif; color: #3D93E0;margin-left:20px "><span></span>&nbsp&nbsp&nbspDemographics : </label>
											<br><br>
											<center>
											<table width="60%" >
												<tr bgcolor="#FFFFFF">
													<td width="50%" > <input type="checkbox" id="emr_name" checked disabled="true">	<label for="emr_name"><span></span>&nbsp&nbsp&nbspName</label> </td>
													<td width="50%" > <input type="checkbox" id="emr_address" >	<label for="emr_address"><span></span>&nbsp&nbsp&nbspAddress</label>  </td>
												<tr>
												<tr bgcolor="#FFFFFF">
													<td width="50%" > <input type="checkbox" id="emr_middle" checked disabled="true">	<label for="emr_middle"><span></span>&nbsp&nbsp&nbspMiddle Initial</label> </td>
													<td width="50%" > <input type="checkbox" id="emr_address2" >	<label for="emr_address2"><span></span>&nbsp&nbsp&nbspAddress2</label>  </td>
												<tr>
												<tr bgcolor="#FFFFFF">
													<td width="50%" > <input type="checkbox" id="emr_surname" checked disabled="true">	<label for="emr_surname"><span></span>&nbsp&nbsp&nbspSurname</label> </td>
													<td width="50%" > <input type="checkbox" id="emr_city" >	<label for="emr_city"><span></span>&nbsp&nbsp&nbspCity</label>  </td>
												<tr>
												<tr bgcolor="#FFFFFF">
													<td width="50%" > <input type="checkbox" id="emr_gender" checked disabled="true">	<label for="emr_gender"><span></span>&nbsp&nbsp&nbspGender</label> </td>
													<td width="50%" > <input type="checkbox" id="emr_state" >	<label for="emr_state"><span></span>&nbsp&nbsp&nbspState</label>  </td>
												<tr>
												<tr bgcolor="#FFFFFF">
													<td width="50%" > <input type="checkbox" id="emr_dob" checked disabled="true">	<label for="emr_dob"><span></span>&nbsp&nbsp&nbspDate of Birth</label> </td>
													<td width="50%" > <input type="checkbox" id="emr_country" >	<label for="emr_country"><span></span>&nbsp&nbsp&nbspCountry</label>  </td>
												<tr>
												<tr bgcolor="#FFFFFF">
													<td width="50%" > <input type="checkbox" id="emr_notes" >	<label for="emr_notes"><span></span>&nbsp&nbsp&nbspNotes</label> </td>
													<td width="50%" > <input type="checkbox" id="emr_phone" >	<label for="emr_phone"><span></span>&nbsp&nbsp&nbspPhone</label>  </td>
												<tr>
												<tr bgcolor="#FFFFFF">
													<td width="50%" > <input type="checkbox" id="emr_insurance" >	<label for="emr_insurance"><span></span>&nbsp&nbsp&nbspInsurance</label> </td>
													<td width="50%" >   </td>
												<tr>
											</table>
											</center>
											
											<div class="clearfix"></div>
											<hr>
											
						             		<input type="checkbox" id="emr_personal" ><label for="emr_personal" style="font: bold 18px Arial, Helvetica, sans-serif; color: #3D93E0;margin-left:20px "><span></span>&nbsp&nbsp&nbspPersonal History : </label>
						
											<div id="PH_Tab" style="margin-left:0px; display:none;">
												<div class="formRow" >
													<input type="checkbox" id="emr_fractures" >	<label for="emr_fractures" style="margin-left:60px"><span></span>&nbsp&nbsp&nbspFractures and Other Traumas</label>
												</div>
												<div class="formRow" >
													<input type="checkbox" id="emr_surgeries" >	<label for="emr_surgeries" style="margin-left:60px"><span></span>&nbsp&nbsp&nbspSurgeries</label>
												</div>
												<div class="formRow" >
													<input type="checkbox" id="emr_otherknown" >	<label for="emr_otherknown" style="margin-left:60px"><span></span>&nbsp&nbsp&nbspOther Known Medical Events</label>
												</div>
												<div class="formRow" >
													<input type="checkbox" id="emr_obstetric" >	<label for="emr_obstetric" style="margin-left:60px"><span></span>&nbsp&nbsp&nbspObstetric History</label>
												</div>
												<div class="formRow" >
													<input type="checkbox" id="emr_othermed" >	<label for="emr_othermed" style="margin-left:60px"><span></span>&nbsp&nbsp&nbspOther Medical Data</label>
												</div>
											</div>
											
											<div class="clearfix"></div>
											<hr>
											<input type="checkbox" id="emr_family" ><label for="emr_family" style="font: bold 18px Arial, Helvetica, sans-serif; color: #3D93E0;margin-left:20px "><span></span>&nbsp&nbsp&nbspFamily History : </label>
											<div id="FA_Tab" style="margin-left:0px; display:none;">
												<div class="formRow" >
													<input type="checkbox" id="emr_father" >	<label for="emr_father" style="margin-left:60px"><span></span>&nbsp&nbsp&nbspFather</label>
												</div>
												<div class="formRow" >
													<input type="checkbox" id="emr_mother" >	<label for="emr_mother" style="margin-left:60px"><span></span>&nbsp&nbsp&nbspMother</label>
												</div>
												<div class="formRow" >
													<input type="checkbox" id="emr_siblings" >	<label for="emr_siblings" style="margin-left:60px"><span></span>&nbsp&nbsp&nbspSiblings</label>
												</div>
												
											</div>
											<div class="clearfix"></div>
											<hr>
											<input type="checkbox" id="emr_pastdx" ><label for="emr_pastdx" style="font: bold 18px Arial, Helvetica, sans-serif; color: #3D93E0;margin-left:20px "><span></span>&nbsp&nbsp&nbspPast Diagnostics  </label>
											
											<div class="clearfix"></div>
											<hr>
											<input type="checkbox" id="emr_medications" ><label for="emr_medications" style="font: bold 18px Arial, Helvetica, sans-serif; color: #3D93E0;margin-left:20px "><span></span>&nbsp&nbsp&nbspMedications  </label>
	
											<div class="clearfix"></div>
											<hr>
											<input type="checkbox" id="emr_immunizations" ><label for="emr_immunizations" style="font: bold 18px Arial, Helvetica, sans-serif; color: #3D93E0;margin-left:20px "><span></span>&nbsp&nbsp&nbspImmunizations  </label>
											
											<div class="clearfix"></div>
											<hr>
											<input type="checkbox" id="emr_allergies" ><label for="emr_allergies" style="font: bold 18px Arial, Helvetica, sans-serif; color: #3D93E0;margin-left:20px "><span></span>&nbsp&nbsp&nbspAllergies  </label>
											<hr>
											<input type="button" class="btn btn-large btn-primary" onClick="saveEMRConfig();" lang="en" value="UPDATE" style="width:200px;margin-top:20px;">
											<!--<div style="margin-top:-15px;">
											Send Appointment Notification before &nbsp &nbsp <select id="appoint_notify" style="width:8em;margin-top:10px"> </select>&nbsp minutes
										 
											</div>
										 
										     <hr>
											 <div style="margin-top:-15px;">
											Timezone &nbsp : &nbsp <select id="Timezone" style="width:15em;margin-top:10px"> </select>
										 
											</div>
											<hr>
										
										  
										 
										
											 <input type="button" class="btn btn-large btn-primary" onClick="saveSchedulerConfig();" value="UPDATE" style="width:200px;margin-top:20px;">
									    -->
										 
										<br>
								</div>		
							</div>
				 </div>
				 <div class="tab-pane" id="grp_config">
						<div class="grid" class="grid span4" style="width:700px; margin: 0 auto; margin-top:30px;">
							<div class="grid-content" style="padding-top:30px;">
								 <span class="label label-info" style="left:0px; margin-left:10px; margin-top:40px; font-size:30px; " lang="en">Group Configuration</span>
								 <div class="clearfix" style="margin-bottom:20px;"></div>
								 <!--<form id="formID" class="formular" method="post" action="">-->
					
						<div class="clearfix"></div>
					
				
			  
	 
						<div class="formRow" style="margin-bottom:50px;">
						 
						   
							 <!--<div style="margin-left:10px; padding-bottom:20px;">
								 
								 <p>
									 <input id="Groupname" type="text" placeholder="Group Name" >
									 <input id="Groupadd" type="text" placeholder="Address" >
									 <input id="Groupzip" type="text" placeholder="ZIP" >
									 <input id="Groupcity" type="text" placeholder="City" >
									 <input id="Groupstate" type="text" placeholder="State" >
									 <input id="Groupcountry" type="text" placeholder="Country" >
								</p>	 
								
								<div style="margin-top:20px;margin-left:-10px">
								
								 <input id="create_group" type="button" class="btn btn-primary" style="margin-left:20px;margin-top:-10px" value="Create Group">
								 
								</div>
							 </div> -->
							 
							  <div style="margin-left:10px;margin-top:20px;padding-bottom:20px;">
		 
				
			
										<form enctype="multipart/form-data" method="post" style="float:left;margin-left:40px">
											<div class="row">
											  <!--<label for="fileToUpload">Select Files to Upload</label>-->
											  <div id="creategrpimage" title="Choose a group picture"><img style="width:150px;height:150px;margin-bottom:10px;text-align: center" src="images/defaultgrouppic.jpg" alt="Group Picture"/>
											  
											  </div>
											  <input type="file" name="filesToUpload[]" id="createfilesToUpload" multiple="multiple" style="width:97px" placeholder="Group Picture" />
											  <!--<output id="filesInfo"></output>-->
											
											<!--<div class="row">
											  <input type="submit" value="Upload" />
											</div>-->
											</div> 
										</form>
										
										
									<p style="margin-top:30px">
									
									<p> <span style="float:left;margin-left:120px" lang="en"> Group Name: </span> <input lang="en" id="Groupname" type="text" placeholder="Group Name" style="margin-left:10px"> </p>
									<p> <span style="float:left;margin-left:120px" lang="en"> Address : </span> <input lang="en" id="Groupadd" type="text" placeholder="Address" style="margin-left:30px">  </p>
									<p> <span style="float:left;margin-left:120px" lang="en"> ZIP: </span> <input lang="en" id="Groupzip" type="text" placeholder="ZIP" style="margin-left:60px"> </p>
									<p> <span style="float:left;margin-left:120px" lang="en"> City: </span> <input lang="en" id="Groupcity" type="text" placeholder="City" style="margin-left:55px"> </p>
									<p> <span style="float:left;margin-left:280px" lang="en"> State: </span> <input lang="en" id="Groupstate" type="text" placeholder="State" style="margin-left:45px"> </p>
									<p> <span style="float:left;margin-left:280px" lang="en"> Country: </span> <input lang="en" id="Groupcountry" type="text" placeholder="Country" style="margin-left:30px"> </p>
									
									</p>	 
														
									<div style="margin-top:20px;margin-left:-10px">
										<input id="create_group" type="button" class="btn btn-primary" style="margin-left:270px;margin-top:-10px" value="Create Group">
									</div>
							 </div>
							 <div class="clearfix"></div>
							  <span class="label label-info" style="left:0px; margin-left:34px; margin-top:20px; font-size:15px; " lang="en">My Groups</span>
							  <div id="group_details" style="margin-top:20px;margin-left:35px"></div>
							 <div class="clearfix"></div>
				 
						   
					 </div>
					 <div class="clearfix"></div>
					 <div class="clearfix"></div>
					 <div class="clearfix"></div>
					 <hr>
					  <!--<input type="button" class="btn btn-large btn-primary" id="notif_update" value="Update" style="width:200px;">
						</form>-->
							</div>	 
					</div>
					 
				 </div>
				 
				 <div class="tab-pane" id="telemed_config">
						<div class="grid" class="grid span4" style="width:98%; margin: 0 auto; margin-top:30px;">
							<div class="grid-content" style="padding-top:30px;">
								 <span class="label label-info" style="left:0px; margin-left:10px; margin-top:40px; font-size:30px; " lang="en">Telemedicine Configuration</span>
								    <div class="clearfix"></div>
									<div class="row-fluid"  style="width:100%">	
										<div class="grid" style="padding:10px; ">
                                            <style>
                                            .rate_button{
                                                 width: 175px; 
                                                 margin-left: 15px;
                                                 height: 30px;
                                                 text-align: center;
                                                 color: #FFFFFF;
                                                 border-style: solid; 
                                                 border-width: 1px; 
                                                 border-color: #3d94f6;
                                                 background-color: #3d94f6;
                                                 border-radius:4px;
                                            }
                                            </style>
											<div style="float:right" class="the-icons">
												<i class="icon-chevron-right" style="padding:10px 10px;float:right;margin-right:0px;cursor:pointer" id="next"></i>
												<label style="padding:10px;float:right;margin-right:0px;" id="CurrentPage"></label>
												<i class="icon-chevron-left" style="padding:10px ;float:right;margin-right:0px;cursor:pointer" id="prev"></i>
                                                <br/>
                                                <div style="width: 400px; height: 100px; float: right; margin-top: 50px; margin-bottom: -50px;">
                                                    
                                                    
                                                    <button class="rate_button" id="clear_week" style="width: 100px; float: right; background-color: #F66765; border-color: #F66765;" lang="en">
                                                        Clear Week
                                                      </button>
                                                    <button class="rate_button" id="copy_week" style="width: 100px; float: right;" lang="en">
                                                        Copy Week
                                                      </button>
                                                    <button class="rate_button" id="paste_week" style="width: 100px; float: right; display: none;" lang="en">
                                                        Paste Week
                                                      </button>
                                                </div>
											</div>
                                       
                                            <div style="width: 500px; height: 30px; margin-left: 5px;">
                                    <?php    
                                        if ($CustomLook != "COL") { 
                                    ?>
                                                <label style="float: left; margin-top: 5px; margin-bottom: 5px;" lang="en">Hourly Rate: $</label>
                                                <div class="formRight" style="float: left;">
                                                   <input type="text" name="rate" id="rate" style="width:60px; margin-left: 10px;" <?php if($hr_rate > 0){echo 'value="'.$hr_rate.'"';} ?> placeholder="10">
                                                </div>
                                                <label style="float: left; margin-top: 5px; margin-bottom: 5px; margin-left: 10px;" lang="en"> / hour</label>
                                                
                                                <button class="rate_button" id="set_rate" style="float: left;">
                                                    Set Hourly Rate
                                                  </button>
                                    <?php } ?>
                                            </div>
                                            
                                            <div style="width: 500px; height: 30px; margin-bottom: -20px;">
                                                <style>
                                                .telemed_button{
                                                     width: 400px; 
                                                     margin-left: 5px;
                                                     height: 30px;
                                                     text-align: center;
                                                     color: #FFFFFF;
                                                     border-style: solid; 
                                                     border-width: 1px; 
                                                     border-color: #3d94f6; 
                                                        border-radius:4px;
                                                }
                                                </style>
                                                <button class="telemed_button" id="start_telemed">
                                                    Offline
                                                  </button>
                                                <br/>
                                                <span style="font-size: 14px; margin-left: 5px; margin-top: 9px;" lang="en">Select Timezone: <br/>
                                                <select class="timezonepicker" id="timezone_picker" style="display:block; margin-top: 10px;">
													  <option value="-12.0">(GMT -12:00) Eniwetok, Kwajalein</option>
													  <option value="-11.0">(GMT -11:00) Midway Island, Samoa</option>
													  <option value="-10.0">(GMT -10:00) Hawaii</option>
													  <option value="-9.0">(GMT -9:00) Alaska</option>
													  <option value="-8.0">(GMT -8:00) Pacific Time (US &amp; Canada)</option>
													  <option value="-7.0">(GMT -7:00) Mountain Time (US &amp; Canada)</option>
													  <option value="-6.0" selected>(GMT -6:00) Central Time (US &amp; Canada), Mexico City</option>
													  <option value="-5.0">(GMT -5:00) Eastern Time (US &amp; Canada), Bogota, Lima</option>
													  <option value="-4.0">(GMT -4:00) Atlantic Time (Canada), Caracas, La Paz</option>
													  <option value="-3.5">(GMT -3:30) Newfoundland</option>
													  <option value="-3.0">(GMT -3:00) Brazil, Buenos Aires, Georgetown</option>
													  <option value="-2.0">(GMT -2:00) Mid-Atlantic</option>
													  <option value="-1.0">(GMT -1:00 hour) Azores, Cape Verde Islands</option>
													  <option value="0.0">(GMT) Western Europe Time, London, Lisbon, Casablanca</option>
													  <option value="1.0">(GMT +1:00 hour) Brussels, Copenhagen, Madrid, Paris</option>
													  <option value="2.0">(GMT +2:00) Kaliningrad, South Africa</option>
													  <option value="3.0">(GMT +3:00) Baghdad, Riyadh, Moscow, St. Petersburg</option>
													  <option value="3.5">(GMT +3:30) Tehran</option>
													  <option value="4.0">(GMT +4:00) Abu Dhabi, Muscat, Baku, Tbilisi</option>
													  <option value="4.5">(GMT +4:30) Kabul</option>
													  <option value="5.0">(GMT +5:00) Ekaterinburg, Islamabad, Karachi, Tashkent</option>
													  <option value="5.5">(GMT +5:30) Bombay, Calcutta, Madras, New Delhi</option>
													  <option value="5.75">(GMT +5:45) Kathmandu</option>
													  <option value="6.0">(GMT +6:00) Almaty, Dhaka, Colombo</option>
													  <option value="7.0">(GMT +7:00) Bangkok, Hanoi, Jakarta</option>
													  <option value="8.0">(GMT +8:00) Beijing, Perth, Singapore, Hong Kong</option>
													  <option value="9.0">(GMT +9:00) Tokyo, Seoul, Osaka, Sapporo, Yakutsk</option>
													  <option value="9.5">(GMT +9:30) Adelaide, Darwin</option>
													  <option value="10.0">(GMT +10:00) Eastern Australia, Guam, Vladivostok</option>
													  <option value="11.0">(GMT +11:00) Magadan, Solomon Islands, New Caledonia</option>
													  <option value="12.0">(GMT +12:00) Auckland, Wellington, Fiji, Kamchatka</option>
													</select>
                                                </span>
                                                <style>
                                                    select.timezonepicker {
                                                       width: 400px;
                                                       padding: 3px;
                                                       font-size: 14px;
                                                       color: #B3B3B3;
                                                       line-height: 1;
                                                       border: 1;
                                                       border-radius: 4;
                                                       height: 24px;
                                                        background: url(images/dropdown_arrow.png) no-repeat right #FFF;
                                                        -webkit-appearance: none;
                                                        margin-left: 5px;
                                                        margin-right: 15px;
                                                    }
                                                </style>
                                            </div>
                                            
											     <div class="grid" style="padding:10px; margin-top:100px" id = "AppointmentContainer">
												    
											 </div>
										</div>
									</div>
									
									
									
					 				  
							</div>	 
					    </div>
					 
				 </div>


                <div class="tab-pane" id="appointments_config">
						<div class="grid" class="grid span4" style="width:96%; margin: 0 auto; margin-top:30px;">
							<div class="grid-content" style="padding-top:30px; padding-left: 2%; overflow: scroll;">
								 <span class="label label-info" style="left:0px; margin-top:40px; font-size:30px; " lang="en">Upcoming Appointments</span>
                                <br/><br/>
                                <div id="appointments_container">
                                    <!--
                                    <h3 style="text-align: center; font-size: 20px;">Wednesday June 25, 2014</h3>
                                    <div style="text-align: center; margin-right: 10px; background-color: #7EC1FF; border-top-left-radius: 8px; border-top-right-radius: 8px; color: #FFF; font-size: 16px; font-weight: bold; padding: 5px;">8:00 AM - 10:00 AM</div>
                                    <div style="text-align: left; margin-right: 10px; background-color: #F3F3F3; color: #000; font-size: 14px; padding: 4px; padding-left: 10px;"><button style="width: 18px; height: 18px; float: right; color: #F00; padding: 0px; background-color: inherit; border: 0px solid #FFF; border-radius: 3px; outline: 0px;"><i class="icon-remove" style="width: 12px; height: 12px;"></i></button>Jane Doesix</div>
                                    <div style="text-align: left; margin-right: 10px; background-color: #DADADA; color: #000; font-size: 14px; padding: 4px; padding-left: 10px;"><button style="width: 18px; height: 18px; float: right; color: #F00; padding: 0px; background-color: inherit; border: 0px solid #FFF; border-radius: 3px; outline: 0px;"><i class="icon-remove" style="width: 12px; height: 12px;"></i></button>John Doe</div>
                                    <div style="text-align: center; margin-right: 10px; background-color: #7EC1FF; color: #FFF; font-size: 16px; font-weight: bold; padding: 5px;">2:00 PM - 4:00 PM</div>
                                    <div style="text-align: left; margin-right: 10px; background-color: #F3F3F3; color: #000; font-size: 14px; padding: 4px; padding-left: 10px;"><button style="width: 18px; height: 18px; float: right; color: #F00; padding: 0px; background-color: inherit; border: 0px solid #FFF; border-radius: 3px; outline: 0px;"><i class="icon-remove" style="width: 12px; height: 12px;"></i></button>Jane Doesix</div>
                                    <div style="text-align: left; margin-right: 10px; background-color: #DADADA; color: #000; font-size: 14px; padding: 4px; padding-left: 10px;"><button style="width: 18px; height: 18px; float: right; color: #F00; padding: 0px; background-color: inherit; border: 0px solid #FFF; border-radius: 3px; outline: 0px;"><i class="icon-remove" style="width: 12px; height: 12px;"></i></button>John Doe</div>
                                    <div style="text-align: left; margin-right: 10px; background-color: #F3F3F3; color: #000; font-size: 14px; padding: 4px; padding-left: 10px; border-bottom-left-radius: 8px; border-bottom-right-radius: 8px;"><button style="width: 18px; height: 18px; float: right; color: #F00; padding: 0px; background-color: inherit; border: 0px solid #FFF; border-radius: 3px; outline: 0px;"><i class="icon-remove" style="width: 12px; height: 12px;"></i></button>Jane Doesix</div>
                                    -->

                                </div>

									
					 				  
							</div>	 
					    </div>
					 
				 </div>





			</div>
		</div>
	</div>





	
	</div>
	
	</div>
	
	</div>
    <!--Content END-->

    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="js/jquery.min.js"></script>
    <script src="js/jquery-ui.min.js"></script>
    <script src="js/jquery.easing.1.3.js"></script>
   
    <script src="js/bootstrap.min.js"></script>
    <script src="js/bootstrap-datepicker.js"></script>
    <script src="js/bootstrap-colorpicker.js"></script>
    <script src="js/google-code-prettify/prettify.js"></script>
   <script src="js/timezones.js" type="text/javascript"></script>
    <script src="js/jquery.timepicker.js"></script>   
    <script src="js/jquery.flot.min.js"></script>
    <script src="js/jquery.flot.pie.js"></script>
    <script src="js/jquery.flot.orderBars.js"></script>
    <script src="js/jquery.flot.resize.js"></script>
    <script src="js/graphtable.js"></script>
    <script src="js/fullcalendar.min.js"></script>
    <script src="js/chosen.jquery.min.js"></script>
    <script src="js/autoresize.jquery.min.js"></script>
    <script src="js/jquery.tagsinput.min.js"></script>
    <script src="js/jquery.autotab.js"></script>
    <script src="js/elfinder/js/elfinder.min.js" charset="utf-8"></script>
	<script src="js/tiny_mce/tiny_mce.js"></script>
    <script src="js/validation/languages/jquery.validationEngine-en.js" charset="utf-8"></script>
	<script src="js/validation/jquery.validationEngine.js" charset="utf-8"></script>
    <script src="js/jquery.jgrowl_minimized.js"></script>
    <script src="js/jquery.dataTables.min.js"></script>
    <script src="js/jquery.mousewheel.js"></script>
    <script src="js/jquery.jscrollpane.min.js"></script>
    <script src="js/jquery.stepy.min.js"></script>
    <script src="js/jquery.validate.min.js"></script>
    <script src="js/raphael.2.1.0.min.js"></script>
    <script src="js/justgage.1.0.1.min.js"></script>
	<script src="js/glisse.js"></script>
    <script src="js/bootstrap-tooltip.js"></script>
    
	<script src="js/application.js"></script>
   <script src="realtime-notifications/lib/gritter/js/jquery.gritter.min.js"></script>
    <link href="realtime-notifications/lib/gritter/css/jquery.gritter.css"rel="stylesheet" type="text/css" />
	
	<link rel="stylesheet" media="screen" type="text/css" href="css/colorpicker2.css" />
	<script type="text/javascript" src="js/colorpicker.js"></script>
	<script type="text/javascript" src="jscolor/jscolor.js"></script>
    <script type="text/javascript" src="js/uploadify/jquery.uploadify.min.js"></script>

    <script type="text/javascript" src="https://js.stripe.com/v2/"></script>
    <script src="build/js/intlTelInput.js"></script>
    <script src="js/isValidNumber.js"></script>	
	
    <script type="text/javascript" >
	var timeoutTime = 18000000;
	//var timeoutTime = 300000;  //5minutes
	var timeoutTimer = setTimeout(ShowTimeOutWarning, timeoutTime);
	var predefined_events = 0;
	var deleted_elements = new Array();

	var active_session_timer = 60000; //1minute
	var sessionTimer = setTimeout(inform_about_session, active_session_timer);

    $('#file_upload').uploadify({
        <?php $timestamp = time();?>
		'method'   : 'post',
		'formData'     : {
					'timestamp' : '<?php echo $timestamp;?>',
					'token'     : '<?php echo md5('unique_salt' . $timestamp);?>'
				},
        'swf'      : 'js/uploadify/uploadify.swf',
        'uploader' : 'uploadifyDoctor.php',
		'multi'    :  false,
        'onUploadSuccess' : function(file, data, response) {
            var split = data.split('|');
            //alert('The file was saved to: ' + split[0]);
            if(split[1]=="1")
            {
                alert("Kindly upload image of minimum dimensions 70X70");
                return;	
            }
            
            if(split[0]=="fileError")
            {
                alert("Please select a file belonging to one of the following types: jpeg,gif or png");
                $('#doctorImage').attr('src','DoctorImage/defaultDP.jpg');
                return;
            }
            var d = new Date();
            $('#doctorImage').attr('src',split[0]+"?"+d.getTime());
        }
    }); 
    //VALIDATION CODE
    
    function alarma(mensaje,selector)
	 {
	 if (mensaje=='') { var tama = '0px'; $(selector).css ('background-color','white'); }else { var tama = '40px'; $(selector).css ('background-color','#FFF8DC'); }
	 
	 $('.MsgAlarma2').animate({
		    height: tama
		      }, 500, function() {
			      $(".MsgAlarma2").html('<p style="font-size:18px; color:white; margin:10px; top:10px; position:relative;">'+mensaje+'</p>');
		});
	 }
    
    function validateEmail($email) {
        var emailReg = /^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;
        if( !emailReg.test( $email ) ) {
            return false;
        } else {
            return true;
        }
    } 
    //Email Validation
    /*$('#Vemail').bind("focusout", function(){    
        emailaddress =  $('#Vemail').val(); 
        if( !validateEmail(emailaddress)) 
        { 
            alert("Invalid Email Address"); 
        }    
    });*/ 
    //Phone number validation    
    $("#Vphone").intlTelInput();
            
    $('#Vphone').bind("focusout", function(){
            
           // alert('validating Phone Number');
        
         /*   if($("#Vphone").intlTelInput("isValidNumber")==false)
            {
                //alert('Invalid Phone Number');
                $('#phoneError').show();
                //$('#Vphone').focus();
                //return;
                //alarma ('Invalid Phone Number','#Vphone');
                //$('#ValorGlobal').val('-1');
            }
            else
            {	
                //$('#Phone').val($('#Phone').val().replace(/-/g, '')); //remove dashes
                $('#Vphone').val($('#Vphone').val().replace(/\s+/g, '')); //remove spaces
                //$('#ValorGlobal').val('0')
                $('#phoneError').hide();
            } */
        
    });  
        
    function checkPhoneFormat(field, rules, i, options){
      //if (field.val() != "HELLO") {
         // this allows the use of i18 for the error msgs
         // alert('validation alert');
        if($("#Vphone").intlTelInput("isValidNumber")==false) {
         
            return options.allrules.validatePhone.alertText;
        }
        else
        {	
            //$('#Phone').val($('#Phone').val().replace(/-/g, '')); //remove dashes
            $('#Vphone').val($('#Vphone').val().replace(/\s+/g, '')); //remove spaces
            //$('#ValorGlobal').val('0')
            //$('#phoneError').hide();
           return;
        } 
    }
    //end phone number validation
        
	$(window).load(function() {
	//alert("started");
        
	$(".loader_spinner").fadeOut("slow");
	})

	//This function is called at regular intervals and it updates ongoing_sessions lastseen time
	function inform_about_session()
	{
		$.ajax({
			url: '<?php echo $domain?>/ongoing_sessions.php?userid='+<?php echo $_SESSION['MEDID'] ?>,
			success: function(data){
			//alert('done');
			}
		});
		clearTimeout(sessionTimer);
		sessionTimer = setTimeout(inform_about_session, active_session_timer);
	}

	function ShowTimeOutWarning()
	{
		alert ('Session expired');
		var a=0;
		window.location = 'timeout.php';
	}
	
	function get_user_event_config(serviceURL) 
	{
		$.ajax(
		{
			url: serviceURL,
			dataType: "json",
			async: false,
			
			success: function(data)
			{
				event_config = data.items;
						
			}
		});
	}
	
	function displaynotification(status,message){
  
	  var gritterOptions = {
				   title: status,
				   text: message,
				   image:'images/Icono_H2M.png',
				   sticky: false,
				   time: '3000'
				  };
		$.gritter.add(gritterOptions);
		
	  }
	
	function get_user_timezone(serviceURL) 
	{
		$.ajax(
		{
			url: serviceURL,
			dataType: "json",
			async: false,
			
			success: function(data)
			{
				user_timezone = data.items;
						
			}
		});
	}
	
	function get_timezones(serviceURL) 
	{
		$.ajax(
		{
			url: serviceURL,
			dataType: "json",
			async: false,
			
			success: function(data)
			{
				timezones = data.items;
						
			}
		});
	}
	function get_user_notify_time(serviceURL) 
	{
		$.ajax(
		{
			url: serviceURL,
			dataType: "json",
			async: false,
			success: function(data)
			{
				notify_time = data.items;
						
			}
		});
	}
	
	function get_emr_config(serviceURL) 
	{
		$.ajax(
		{
			url: serviceURL,
			dataType: "json",
			async: false,
			success: function(data)
			{
				emr_config = data.items;
						
			}
		});
	}
    
    $(document).ready(function() {
        var message = '';
        var unsaved_changes = false;
        <?php if(isset($message)){ echo 'message = "'.$message.'";';} ?>
        if(message.length > 0)
        {
            alert(message);
            window.location = "medicalConfiguration.php";
        }
        $("#change_password_validate_button").live('click', function()
        {
            $.post("validate_password.php", {doc_id: $("#USERDID").val(), pw: $("#pw1").val()}, function(data, status)
            {
                console.log(data);
                if(data == '1' && $("#change_password_validated_section").css("display") == 'none')
                {
                    $("#change_password_validated_section").slideDown();

                }
                else
                {
                    $("#password_notification").css("background-color", "#D5483A");
                    $("#password_notification").html('<p style="color: #fff;">Password Incorrect</p>');
                    $("#password_notification_container").animate({opacity: '1.0'}, {duration: 1000, easing: 'easeInOutQuad', complete: function() {
                        setTimeout(function(){$("#password_notification_container").animate({opacity: '0.0'}, {duration: 1000, easing: 'easeInOutQuad', complete: function() {}});}, 2000);
                    }});
                }
            });

        });
		var translation9 = '';

		if(language == 'th'){
		translation9 = 'Contraseña Cambiada';
		}else if(language == 'en'){
		translation9 = 'Password Changed Successfully!';
		}
		
        $("#change_password_finish_button").live('click', function()
        {
            if($("#pw2").val() == $("#pw3").val())
            {
                $("#pw1").val("");
                $("#change_password_validated_section").slideUp();
                $.post("update_doctor.php", {new_pw: $("#pw2").val(), doc_id: $("#USERDID").val()}, function(data, status)
                {
                    $("#pw2").val("");
                    $("#pw3").val("");
                    $("#password_notification").css("background-color", "#52D859");
                    $("#password_notification").html('<p style="color: #fff;">'+translation9+'</p>');
                    $("#password_notification_container").animate({opacity: '1.0'}, {duration: 1000, easing: 'easeInOutQuad', complete: function() {
                        setTimeout(function(){$("#password_notification_container").animate({opacity: '0.0'}, {duration: 1000, easing: 'easeInOutQuad', complete: function() {}});}, 2000);
                    }});
                });
            }
            else
            {
                $("#password_notification").css("background-color", "#D5483A");
                $("#password_notification").html('<p style="color: #fff;">Passwords Did Not Match</p>');
                $("#password_notification_container").animate({opacity: '1.0'}, {duration: 1000, easing: 'easeInOutQuad', complete: function() {
                    setTimeout(function(){$("#password_notification_container").animate({opacity: '0.0'}, {duration: 1000, easing: 'easeInOutQuad', complete: function() {}});}, 2000);
                    }});
            }
        });
        
        
        $(window).bind('beforeunload', function() 
        {
            if(unsaved_changes)
                return "You have unsaved changes.";
            
        });
        $("#submit_button").on('click', function()
        {
            unsaved_changes = false;
        });
        setTimeout(function()
        {
           $("#formID input").on('input', function()
            {
                unsaved_changes = true;
            });
            $("#formID input").on('change', function()
            {
                unsaved_changes = true;
            });
            $("#formID select").on('change', function()
            {
                unsaved_changes = true;
            });
        }, 2000);
        
        var CustomLook = "<?php echo $CustomLook; ?>";
        
        //hide appointments
        if (CustomLook == "COL"){
            $("#appointments_tab").hide();
            $("#payments_tab").hide();
        } else {
            $("#appointments_tab").show();
             $("#payments_tab").show();
        }    
        
        var country = "<?php echo $country; ?>";
        var state = "<?php echo $state; ?>";
        if(country.length > 0)
        {
            $("#country").val(country).trigger('change');
            console.log(country);
            if(country == 'USA')
            {
                $("#state").parent().parent().css("display", "block");
            }
            
            if(state.length > 0)
            {
                setTimeout(function(){$("#state").val(state);}, 100);
            }
            
        }
        $("#country").on('change', function()
        {
            // the following code is to show the region select menu if the country is USA.
            if($(this).val() == 'USA')
            {
                $("#state").parent().parent().css('display', 'block');
            }
            else
            {
                $("#state").parent().parent().css('display', 'none');
            }
        });
        $("#speciality").val("<?php echo $speciality; ?>");
        if($("#telemed_on").val() == "0")
        {
		var translation2 = '';

		if(language == 'th'){
		translation2 = 'No connectado';
		}else if(language == 'en'){
		translation2 = 'Offline';
		}
		
            $("#start_telemed").css("background-color", "#F66765");
            $("#start_telemed").css("border-color", "#F66765");
            $("#start_telemed").text(translation2);
        }
        else
        {
		var translation2 = '';

		if(language == 'th'){
		translation2 = 'En línea / Modo Editor';
		}else if(language == 'en'){
		translation2 = 'Online / Edit Mode';
		}
		
            $("#start_telemed").css("background-color", "#74F677");
            $("#start_telemed").css("border-color", "#74F677");
            $("#start_telemed").text(translation2);
        }
        
        $("#Haddress").keydown(function(e) 
        {
            var newLines = $(this).val().split("\n").length;
            
            if(e.keyCode == 13 && newLines >= 3) 
            {
                return false;
            }
        });
        // functions and events for credit cards   
        Stripe.setPublishableKey("pk_test_YBtrxG7xwZU9RO1VY8SeaEe9");
        function stripeResponseHandler(status, response) {
        
            if (response.error) 
            {
                $(".credit_card_notification").css("background-color", "#D5483A");
                $(".credit_card_notification").text('Unable To Add Bank Account');
                $(".credit_card_notification").animate({opacity: '1.0'}, {duration: 1000, easing: 'easeInOutQuad', complete: function() {
                    setTimeout(function(){$(".credit_card_notification").animate({opacity: '0.0'}, {duration: 1000, easing: 'easeInOutQuad', complete: function() {}});}, 2000);
                }});
            } 
            else 
            {
                $("#credit_card_loader").css("visibility", "visible");
                $.post("change_credit_card.php", {type: '1', action: '1', id: $("#USERDID").val(), token: response.id, full_name: $("#bank_account_name").val()}, function(data, status)
                {
                    console.log(data);
                    $("#credit_card_loader").css("visibility", "hidden");
                    if(data == '1')
                    {
                        $(".credit_card_notification").css("background-color", "#52D859");
                        $(".credit_card_notification").text('Bank Account Added!');
                        $(".credit_card_notification").animate({opacity: '1.0'}, {duration: 1000, easing: 'easeInOutQuad', complete: function() {
                            setTimeout(function(){$(".credit_card_notification").animate({opacity: '0.0'}, {duration: 1000, easing: 'easeInOutQuad', complete: function() {}});}, 2000);
                        }});
                        $.post("get_doctor_credit_cards.php", {id: $("#USERDID").val()}, function(data, status)
                        {
                            var info = JSON.parse(data);
                            if(info["active_account"] != null && info["active_account"]["last4"] != null && info["active_account"]["last4"].length > 0)
                            {
                                $("#current_bank_account_number").text("********"+info["active_account"]["last4"]);
                                $(".credit_card_row").css("display", "block");
                            }
                        });
                    }
                    else
                    {
                        $(".credit_card_notification").css("background-color", "#D5483A");
                        $(".credit_card_notification").text('Unable To Add Bank Account');
                        $(".credit_card_notification").animate({opacity: '1.0'}, {duration: 1000, easing: 'easeInOutQuad', complete: function() {
                            setTimeout(function(){$(".credit_card_notification").animate({opacity: '0.0'}, {duration: 1000, easing: 'easeInOutQuad', complete: function() {}});}, 2000);
                        }});
                    }
                });
            }
        }
        
        $("#add_card_button").on('click', function()
        {            
            Stripe.bankAccount.createToken({
                country: $('#bank_account_country').val(),
                routingNumber: $('#bank_account_routing_number').val(),
                accountNumber: $('#bank_account_number').val()
            }, stripeResponseHandler);
            
        });
        $("#remove_card_button").on('click', function()
        {
            $("#credit_card_loader").css("visibility", "visible");
            $.post("change_credit_card.php", {type: '1', action: '2', id: $("#USERDID").val()}, function(data, status)
            {
                $("#credit_card_loader").css("visibility", "hidden");
                if(data == '1')
                {
                    $(".credit_card_notification").css("background-color", "#52D859");
                    $(".credit_card_notification").text('Bank Account Removed');
                    $(".credit_card_notification").animate({opacity: '1.0'}, {duration: 1000, easing: 'easeInOutQuad', complete: function() {
                        setTimeout(function(){$(".credit_card_notification").animate({opacity: '0.0'}, {duration: 1000, easing: 'easeInOutQuad', complete: function() {}});}, 2000);
                    }});
                    /*$.post("get_doctor_credit_cards.php", {id: $("#USERDID").val()}, function(data, status)
                    {
                        var info = JSON.parse(data);
                        if(info.hasOwnProperty('cards') && info['cards'].length > 0)
                        {
                            load_credit_cards(info['cards']);
                        }
                        console.log(data);
                    });*/
                    $(".credit_card_row").css("display", "none");
                }
                else
                {
                    $(".credit_card_notification").css("background-color", "#D5483A");
                    $(".credit_card_notification").text('Unable To Remove Bank Account');
                    $(".credit_card_notification").animate({opacity: '1.0'}, {duration: 1000, easing: 'easeInOutQuad', complete: function() {
                        setTimeout(function(){$(".credit_card_notification").animate({opacity: '0.0'}, {duration: 1000, easing: 'easeInOutQuad', complete: function() {}});}, 2000);
                    }});
                }
            });
        });
        
        $.post("get_doctor_credit_cards.php", {id: $("#USERDID").val()}, function(data, status)
        {
            /*var info = JSON.parse(data);
            if(info.hasOwnProperty('cards') && info['cards'].length > 0)
            {
                load_credit_cards(info['cards']);
            }*/
            var info = JSON.parse(data);
            if(info["active_account"] != null && info["active_account"]["last4"] != null && info["active_account"]["last4"].length > 0)
            {
                $("#current_bank_account_number").text("********"+info["active_account"]["last4"]);
                $(".credit_card_row").css("display", "block");
            }
            //console.log(info["active_account"]["last4"]);
        });
        
        // end functions and events for credit cards
        
        
        // functions and events for certifications
        
        function basename(path)
        {
            return path.split(/[\\/]/).pop();
        }
        function handleSelectedCertification(item, value)
        {      
            var index = item.split("_")[2];
            if(certifications.hasOwnProperty(value))
            {
                var image = certifications[value];
                $("#certification_image_"+index).attr("src", image);
                $("#certification_filename_"+index).val(basename(image));
            }
            else
            {
                $("#certification_image_"+index).attr("src", "CertificationImages/none.jpg");
                $("#certification_filename_"+index).val("");
            }
            $("#certification_filedata_"+index).val("");
            
        }
        var certifications, keys;
        $.get("get_certifications.php", function(data, status)
        {
            certifications = JSON.parse(data);
            keys = Object.keys(certifications);
            
            $.post("get_certifications.php", {id: $("#USERDID").val()}, function(data, status)
            {
                var info = JSON.parse(data);
                $("#certifications_container").html('');
                for(var i = 0; i < info.length; i++)
                {
                    var html = '';
                    var number = $("#certifications_container").children().length + 1;
                    while($("#certification_name_"+number).length)
                    {
                        number += 1;
                    }
                    html += '<div style="width:85%; height: 70px; background-color: #FBFBFB; ';
                    if(info[i]['isPrimary'] == '1')
                    {
                        html += 'border: 2px solid #22AEFF;';
                    }
                    else
                    {
                        html += 'border: 1px solid #E5E5E5;';
                    }
                    html += ' padding: 2%; margin: auto; margin-bottom: 10px; margin-top: 15px; border-radius: 5px;">';
                    html += '<div style="width: 220px; height: 70px; float: right;">';
                    html += '<button class="certification_button" id="certification_changeimage_'+number+'" style="width: 45%; float: right; margin-left: 3%;">Change Image</button>';
                    html += '<button class="certification_button" id="certification_makeprimary_'+number+'" style="width: 45%; float: right;">Make Primary</button>';
                    html += '<input type="file" id="certification_file_'+number+'" name="certification_file_'+number+'" style="display: none;" />';
                    html += '<input type="hidden" id="certification_filedata_'+number+'" name="certification_filedata_'+number+'" value="" />';
                    html += '<input type="hidden" id="certification_filename_'+number+'" name="certification_filename_'+number+'" value="';
                    if(info[i]['image'] != null && info[i]['image'].length > 0)
                    {
                        html += basename(info[i]['image']);
                    }
                    html += '" />';
                    html += '<input type="hidden" id="certification_primary_'+number+'" name="certification_primary_'+number+'" value="';
                    if(info[i]['isPrimary'] == '1')
                    {
                        html += '1';
                    }
                    else
                    {
                        html += '0';
                    }
                    html += '" />';
                    html += '<button class="certification_button" style="background-color: #D84840; margin-top: 10px; width: 93%; float: right;">Delete</button>';
                    html += '</div>';
                    html += '<img id="certification_image_'+number+'" style="width: 70px; height: 70px; float: right; margin-right: 15px; border-radius: 70px; border: 1px solid #333;" src="';
                    if(info[i]['image'] != null && info[i]['image'].length > 0)
                    {
                        html += info[i]['image'];
                    }
                    else
                    {
                        html += 'CertificationImages/none.jpg';
                    }
                    html += '"/>';
                    html += '<input type="checkbox" />';
                    html += '<input type="text" id="certification_name_'+number+'" name="certification_name_'+number+'" placeholder="Certification Name" style="border: 1px solid #CCC; box-shadow: none; width: 216px; height: 25px; border-radius: 0px; padding: 4px; padding-left: 10px; margin-bottom: 0px; border-top-left-radius: 5px; border-top-right-radius: 5px; color: #989898;" value="';
                    if(info[i]['name'] != null && info[i]['name'].length > 0)
                    {
                        html += info[i]['name'];
                    }
                    html += '"  />';
                    html += '<div style="width: 100%; height: 40px; margin-top: 0px;">';
                    html += '<div style="height: 22px; width: 64px; border: 1px solid #CCC; border-right: 0px solid #333; float: left; padding: 4px; padding-left: 10px; padding-top: 7px; background-color: #FFF; color: #989898;  border-bottom-left-radius: 5px;">Start Date: </div>';
                    html += '<input type="date" name="certification_date_'+number+'" id="certification_date_'+number+'"  style="height: 25px; width: 140px; float: left; border: 1px solid #CCC; border-left: 0px solid #333; border-radius: 0px; color: #989898; box-shadow: none; outline: 0px;  border-bottom-right-radius: 5px;" value="';
                    if(info[i]['start_date'] != null && info[i]['start_date'].length > 0)
                    {
                        html += info[i]['start_date'];
                    }
                    html += '" />';
                    html += '</div>';
                    html += '</div>';
                    $("#certifications_container").append(html);
                    if($("#certifications_max_count").val() < number)
                    {
                        $("#certifications_max_count").val(number);
                    }
                }
                $(".certification_button").on('click', function(e)
                {
                    e.preventDefault();
                    if($(this).text() == 'Change Image')
                    {
                        var index = $(this).attr("id").split("_")[2];
                        $("#certification_file_"+index).trigger('click');
                    }
                    else if($(this).text() == "Delete")
                    {
                        $(this).parent().parent().remove();
                    }
                    else if($(this).text() == "Make Primary")
                    {
                        $(this).parent().parent().parent().children().each(function()
                        {
                            $(this).css("border", "1px solid #E5E5E5");
                            $(this).children().eq(0).children('input').eq(3).val("0");
                        });
                        $(this).parent().parent().css("border", "2px solid #22AEFF");
                        $(this).parent().parent().children().eq(0).children('input').eq(3).val("1");
                    }
                    
                    
                });
                $('input[id^="certification_file_"]').change( function()
                {
                    var index = $(this).attr("id").split("_")[2];
                    if (this.files && this.files[0]) 
                    {
                        var reader = new FileReader();
            
                        reader.onload = function (e) 
                        {
                            $("#certification_image_"+index).attr('src', e.target.result);
                            $("#certification_filedata_"+index).val(e.target.result);
                        }
            
                        reader.readAsDataURL(this.files[0]);
                        $("#certification_filename_"+index).val(this.files[0].name);
                    }
                });
                $('input[id^="certification_name_"]').keyup(function(e)
                {
                    handleSelectedCertification($(this).attr("id"), $(this).val());
                });
                $('input[id^="certification_name_"]').autocomplete(
                {
                    source: keys,
                    select: function (event, ui) 
                    {
                        handleSelectedCertification($(this).attr("id"), ui.item.value);
                    }
                });
            });
        });
        
        
        $(".add_new_certification_button").on('click', function(e)
        {
            e.preventDefault();
            var html = '';
            var number = $("#certifications_container").children().length + 1;
            while($("#certification_name_"+number).length)
            {
                number += 1;
            }
            html += '<div style="width:85%; height: 70px; background-color: #FBFBFB; ';
            if(number == 1)
            {
                html += 'border: 2px solid #22AEFF; ';
            }
            else
            {
                html += 'border: 1px solid #E5E5E5; ';
            }
            
            html += 'padding: 2%; margin: auto; margin-bottom: 10px; margin-top: 15px; border-radius: 5px;">';
            html += '<div style="width: 220px; height: 70px; float: right;">';
            html += '<button class="certification_button" id="certification_changeimage_'+number+'" style="width: 45%; float: right; margin-left: 3%;">Change Image</button>';
            html += '<button class="certification_button" id="certification_makeprimary_'+number+'" style="width: 45%; float: right;">Make Primary</button>';
            html += '<input type="file" id="certification_file_'+number+'" name="certification_file_'+number+'" style="display: none;" />';
            html += '<input type="hidden" id="certification_filedata_'+number+'" name="certification_filedata_'+number+'" value="" />';
            html += '<input type="hidden" id="certification_filename_'+number+'" name="certification_filename_'+number+'" value="" />';
            html += '<input type="hidden" id="certification_primary_'+number+'" name="certification_primary_'+number+'" value="';
            if(number == 1)
            {
                html += '1';
            }
            else
            {
                html += '0';
            }
            html += '" />';
            html += '<button class="certification_button" style="width: 93%; background-color: #D84840; margin-top: 10px; float: right;">delete</button>';
            html += '</div>';
            html += '<img id="certification_image_'+number+'" style="width: 70px; height: 70px; float: right; margin-right: 15px; border-radius: 70px; border: 1px solid #333;" src="CertificationImages/none.jpg"/>';
            html += '<input type="text" id="certification_name_'+number+'" name="certification_name_'+number+'" placeholder="Certification Name" style="border: 1px solid #CCC; box-shadow: none; width: 216px; height: 25px; border-radius: 0px; padding: 4px; padding-left: 10px; margin-bottom: 0px; border-top-left-radius: 5px; border-top-right-radius: 5px; color: #989898;"  />';
            html += '<div style="width: 100%; height: 40px; margin-top: 0px;">';
            html += '<div style="height: 22px; width: 64px; border: 1px solid #CCC; border-right: 0px solid #333; float: left; padding: 4px; padding-left: 10px; padding-top: 7px; background-color: #FFF; color: #989898;  border-bottom-left-radius: 5px;">Start Date: </div>';
            html += '<input type="date" name="certification_date_'+number+'" id="certification_date_'+number+'"  style="height: 25px; width: 140px; float: left; border: 1px solid #CCC; border-left: 0px solid #333; border-radius: 0px; color: #989898; box-shadow: none; outline: 0px;  border-bottom-right-radius: 5px;" />';
            html += '</div>';
            html += '</div>';
            $("#certifications_container").append(html);
            if($("#certifications_max_count").val() < number)
            {
                $("#certifications_max_count").val(number);
            }
            $(".certification_button").on('click', function(e)
            {
                e.preventDefault();
                if($(this).text() == 'Change Image')
                {
                    var index = $(this).attr("id").split("_")[2];
                    $("#certification_file_"+index).trigger('click');
                }
                else if($(this).text() == "Delete")
                {
                    $(this).parent().parent().remove();
                }
                else if($(this).text() == "Make Primary")
                {
                    $(this).parent().parent().parent().children().each(function()
                    {
                        $(this).css("border", "1px solid #E5E5E5");
                        $(this).children().eq(0).children('input').eq(3).val("0");
                    });
                    $(this).parent().parent().css("border", "2px solid #22AEFF");
                    $(this).parent().parent().children().eq(0).children('input').eq(3).val("1");
                }
                
                
            });
            $('input[id^="certification_file_"]').change( function()
            {
                var index = $(this).attr("id").split("_")[2];
                if (this.files && this.files[0]) 
                {
                    var reader = new FileReader();
        
                    reader.onload = function (e) 
                    {
                        $("#certification_image_"+index).attr('src', e.target.result);
                        $("#certification_filedata_"+index).val(e.target.result);
                        
                    }
        
                    reader.readAsDataURL(this.files[0]);
                    $("#certification_filename_"+index).val(this.files[0].name);
                }
            });
            $('input[id^="certification_name_"]').keyup(function(e)
            {
                handleSelectedCertification($(this).attr("id"), $(this).val());
            });
            $('input[id^="certification_name_"]').autocomplete(
            {
                source: keys,
                select: function (event, ui) 
                {
                    handleSelectedCertification($(this).attr("id"), ui.item.value);
                }
            });
        });
        
        // end functions and events for certification files
        
        
        
        
        
        $("#set_rate").live('click',function() 
        {
            var isNumber =  /^\d+$/.test($("#rate").val());
            if(isNumber)
            {
                $.post("UpdateMEDUser.php", {telemed: true, hr_rate: $("#rate").val(), EnviaUserid: $("#USERDID").val()}, function(data, status){console.log(data);});
            }
            else
            {
                alert("Invalid rate amount, please try again");
            }
        });
        $("#start_telemed").live('click',function() 
        {
            if($("#telemed_on").val() == "0")
            {
                $.post("getTelemedAvailability.php", {get_telemed_info: 1, med_id: $("#USERDID").val()}, function(data, status)
                {
                    var items = JSON.parse(data);
                    //if(items.speciality != null && items.speciality.length > 0 && items.location != null && items.location.length > 0 && items.rate > 0)
                    //{
                        $("#telemed_on").val("1");
                        $.post("getTelemedAvailability.php", {med_id: $("#USERDID").val(), set_on: 1}, function(data, status){});
                        $("#start_telemed").css("background-color", "#74F677");
                        $("#start_telemed").css("border-color", "#74F677");
                        $("#start_telemed").text("Online / Edit Mode");
                    //}
                    //else
                    //{
                    //    alert("Please configure your location, speciality, and hourly rate before turning on telemedicine.");
                    //}
                });
            }
            else
            {
                $("#telemed_on").val("0");
                $.post("getTelemedAvailability.php", {med_id: $("#USERDID").val(), set_on: 0}, function(data, status){});
                $("#start_telemed").css("background-color", "#F66765");
                $("#start_telemed").css("border-color", "#F66765");
                $("#start_telemed").text("Offline");
            }
        });
        
        var appt_data = null;
        function load_appointments()
        {
            // reload upcoming appointments information here
            $.get("get_appointments.php?doc_id="+$("#USERDID").val(), function(data, status)
            {
                console.log(data);
                appt_data = JSON.parse(data);
                refresh_appointments();
            });
        }
        function refresh_appointments()
        {
            var last_date_str = '';
            var last_time_slot_str = '';
            var last_date = null;
            var html = '';
            var count = 0;
            var start_time = null;
            var end_time = null;
            var start_hour = 0;
            var end_hour = 0;
            var start_m = 'AM';
            var end_m = 'AM';
            var sp_times = new Object();
            for(var i = 0; i < appt_data.length; ++i)
            {
                var new_date = false;
                var new_timeslot = false;
                
                if(appt_data[i]['date'] != last_date_str)
                {
                    last_date_str = appt_data[i]['date'];
                    last_date = new Date();
                    last_date.setFullYear(parseInt(last_date_str.substr(0, 4)));
                    last_date.setMonth(parseInt(last_date_str.substr(5, 2)) - 1);
                    last_date.setDate(parseInt(last_date_str.substr(8, 2)));
                    html += '<h3 style="text-align: center; font-size: 20px;">';
                    html += last_date.toDateString();
                    html += '</h3>';
                    new_date = true;
                    last_time_slot_str = '';
                    
                }
                if(appt_data[i]['start_time'] != last_time_slot_str)
                {
                    last_time_slot_str = appt_data[i]['start_time'];
                    new_timeslot = true;
                    count = 0;
                    html += '<div style="text-align: center; margin-right: 10px; background-color: #7EC1FF;'
                    if(new_date)
                    {
                        html += ' border-top-left-radius: 8px; border-top-right-radius: 8px;';
                    }
                    html += ' color: #FFF; font-size: 16px; font-weight: bold; padding: 5px;">';
                    //8:00 AM - 10:00 AM
                    start_time = appt_data[i]['start_time'].split(":");
                    end_time = appt_data[i]['end_time'].split(":");
                    start_hour = parseInt(start_time[0]);
                    end_hour = parseInt(end_time[0]);
                    start_m = 'AM';
                    end_m = 'AM';
                    if(start_hour > 11)
                    {
                        start_m = 'PM';
                        if(start_hour > 12)
                        {
                            start_hour -= 12;
                        }
                    }
                    else if(start_hour == 0)
                    {
                        start_hour = 12;
                        start_m = 'AM';
                    }
                    if(end_hour > 11)
                    {
                        end_m = 'PM';
                        if(end_hour > 12)
                        {
                            end_hour -= 12;
                        }
                    }
                    else if(end_hour == 0)
                    {
                        end_hour = 12;
                        end_m = 'AM';
                    }
                    html += start_hour+":"+start_time[1]+" "+start_m+" - "+end_hour+":"+end_time[1]+" "+end_m;
                    html += '</div>';
                }
                html += '<div style="text-align: left; margin-right: 10px; background-color: ';
                if(count % 2 == 1)
                {
                    html += '#E3E3E3;';
                }
                else
                {
                    html += '#F3F3F3;';
                }
                html += ' color: #000; font-size: 14px; padding: 4px; padding-left: 10px;';
                if((i < appt_data.length - 1 && appt_data[i + 1]['date'] != last_date_str) || i == appt_data.length - 1)
                {
                    html += ' border-bottom-left-radius: 8px; border-bottom-right-radius: 8px;';
                }
                html += '"><button id="';
                html += 'app_del_'+appt_data[i]['id']+'_'+i;
                html += '" style="width: 18px; height: 18px; float: right; color: #F00; padding: 0px; background-color: inherit; border: 0px solid #FFF; border-radius: 3px; outline: 0px;"><i class="icon-remove" style="width: 12px; height: 12px;"></i></button>';
                html += '<div style="width: 650px; height: 22px;">';
                html += '<div style="width: 315px; float: left;">';
                html += '<a href="patientdetailMED-new.php?IdUsu='+appt_data[i]['pat_id']+'" style="color: #46D542;">'+appt_data[i]['pat_name']+'</a></div>';
                html += '<div style="width: 140px; float: left; color: #777;">Set a specific time: </div>';
                html += '<input id="specific_time_'+appt_data[i]['id']+'_'+start_hour+':'+start_time[1]+start_m.toLowerCase()+'_'+end_hour+':'+end_time[1]+end_m.toLowerCase()+'" value="" type="text" style="width: 75px; padding: 0px; padding-left: 5px; margin-bottom: 0px; height: 20px; float: left;" ';
                if(appt_data[i]['specific_time'] != null)
                {
                    //html += 'value="'+dat[i]['specific_time']+'" ';
                    sp_times[(appt_data[i]['id'])] = appt_data[i]['specific_time'];
                }
                html += '/>';
                html += '<button class="app_save" style="height: 22px; width: 50px; background-color: inherit; border-radius: 2px; color: #22AEFF; border: 0px solid #FFF; outline: 0px;">Save</button>';
                html += '<button class="app_clear" style="height: 22px; width: 50px; background-color: inherit; border-radius: 2px; color: #D84840; border: 0px solid #FFF; outline: 0px;">Clear</button>';
                html += '</div></div>';
                ++count;
            }
            html += '<br/><br/>';
            $("#appointments_container").html(html);
            $("input[id^='specific_time_']").each(function(index, value) 
            {
                var info = $(this).attr("id").split("_");
                $(this).timepicker({'step': 5, 'minTime': info[3], 'maxTime': info[4]});
                if(info[2] in sp_times)
                {
                    var date = new Date();
                    var date_info = sp_times[(info[2])].split(":");
                    date.setHours(parseInt(date_info[0]));
                    date.setMinutes(parseInt(date_info[1]));
                    $(this).timepicker('setTime', date);
                }
            });
            $("#app_clear").off('click');
            $("input[id^='specific_time_']").off('change');
            $("button[id^='app_del_']").on('click');
            $(".app_clear").on('click', function()
            {
                $(this).parent().children("input^=['specific_time_']").val('');
                var info = $(this).parent().children("input^=['specific_time_']").attr("id").split("_");
                $.post("update_appointment.php", {id: info[2], specific_time: 'n'}, function(data, status){console.log(data);});
            });
            $("input[id^='specific_time_']").on('change', function()
            {
                var info = $(this).attr("id").split("_");
                console.log(info[2] + ' ' + $(this).val());
                $.post("update_appointment.php", {id: info[2], specific_time: $(this).val()}, function(data, status){console.log(data);});
            });
            $(".app_save").on('click', function()
            {
                var info = $(this).prev().attr("id").split("_");
                $.post("update_appointment.php", {id: info[2], specific_time: $(this).prev().val()}, function(data, status){console.log(data);});
                alert("Appointment Saved");
            });
            $("button[id^='app_del_']").on('click', function()
            {
                var item = $(this).parent();
                var answer = confirm("Are you sure you want to cancel this appointment with member "+$(this).parent().children('div').children('div').children('a').eq(0).text()+"? This action cannot be undone.");
                if(answer)
                {
                    var info = $(this).attr("id").split("_");
                    $.get("delete_appointment.php?id="+info[2], function(d, status)
                    {
                        if(d == '1')
                        {
                            appt_data.splice(info[3], 1);
                            refresh_appointments();
                            
                        }
                    });
                    
                    
                }
                
            });
        
        }
        
        $("#app_config_button").live('click', function()
        {
             load_appointments();                
                                
        });
        
		get_user_event_config('getusereventconfig.php');
		//predefined_events = event_config.length;
		for(var i=0;i<event_config.length;i++)
		{
			add_event_config(i,event_config[i].title,event_config[i].hours,event_config[i].minutes,event_config[i].colour)
		}
		
		
		
		get_user_notify_time('getusernotifytime.php');
		var appoint_notify = document.getElementById('appoint_notify');
		for(var j=1;j<61;j++)
		{
			appoint_notify.options[appoint_notify.options.length]= new Option(j, j);
		}
		appoint_notify.options[parseInt(notify_time[0].minutes)-1].setAttribute('selected',true);
		$('#notify_id').val(notify_time[0].id);
		
		get_timezones('gettimezones.php');
		var tz = document.getElementById('Timezone');
		for(var i=0;i<timezones.length;i++)
		{
			tz.options[tz.options.length] = new Option(timezones[i].timezones,timezones[i].id);
		}
		get_user_timezone('getusertimezone.php');
		tz.options[parseInt(user_timezone[0].timez)-1].setAttribute('selected',true);
		//$('#Timezone :selected').text(user_timezone[0].timezones);
   
		get_emr_config('getemrconfig.php');
		//alert(emr_config.length);
		set_checkbox_value('emr_personal',emr_config[0].personal);
		set_checkbox_value('emr_family',emr_config[0].family);
		set_checkbox_value('emr_pastdx',emr_config[0].pastdx);
		set_checkbox_value('emr_medications',emr_config[0].medications);
		set_checkbox_value('emr_immunizations',emr_config[0].immunizations);
		set_checkbox_value('emr_allergies',emr_config[0].allergies);
   
		set_checkbox_value('emr_address',emr_config[0].address);
		set_checkbox_value('emr_address2',emr_config[0].address2);
		set_checkbox_value('emr_city',emr_config[0].city);
		set_checkbox_value('emr_state',emr_config[0].state);
		set_checkbox_value('emr_country',emr_config[0].country);
		set_checkbox_value('emr_notes',emr_config[0].notes);
		set_checkbox_value('emr_phone',emr_config[0].phone);
		set_checkbox_value('emr_insurance',emr_config[0].insurance);
		set_checkbox_value('emr_fractures',emr_config[0].fractures);
		set_checkbox_value('emr_surgeries',emr_config[0].surgeries);
		set_checkbox_value('emr_otherknown',emr_config[0].otherknown);
		set_checkbox_value('emr_obstetric',emr_config[0].obstetric);
		set_checkbox_value('emr_othermed',emr_config[0].othermed);
		
		set_checkbox_value('emr_father',emr_config[0].father);
		set_checkbox_value('emr_mother',emr_config[0].mother);
		set_checkbox_value('emr_siblings',emr_config[0].siblings);
   
	$('body').bind('mousedown keydown', function(event) {
        clearTimeout(timeoutTimer);
        timeoutTimer = setTimeout(ShowTimeOutWarning, timeoutTime);
		//alert('Reset counter');
    });
   		
   	$('#dp32').live("change", function(){
	     getIdUsFIXED();
   		});	
 	
   		
    $('#gender').bind("focusout change", function(){
	     getIdUsFIXED();  		
   		});
 
     $('#orderOB').bind("focusout  change", function(){
	     getIdUsFIXED();
   		});
   	     
   	$('#Vname').bind("focusout  change", function(){
	     getIdUsFIXEDNAME();
   		});	

   	$('#Vsurname').bind("focusout  change", function(){
	     getIdUsFIXEDNAME();
   		});	
   		  		  
    $("#c2").click(function(event) {
	    	$("#MULTIPLE").css("display","inherit");
	    	var cosa=chkb($("#c2").is(':checked'));
	    	if (cosa==1){
		    	$("#MULTIPLE").css("display","inherit");
	    	}else{
		    	$("#MULTIPLE").css("display","none");
		    	$("#orderOB").val('0');
	    	}
  	  	     getIdUsFIXED();
			 
			 
  
    });
	
	$("#emr_personal").click(function(event) {
	    	$("#PH_Tab").css("display","inherit");
	    	var cosa=chkb($("#emr_personal").is(':checked'));
	    	if (cosa==1){
		    	$("#PH_Tab").css("display","inherit");
	    	}else{
		    	$("#PH_Tab").css("display","none");
		    
	    	}
  	  	      
    });
	
	$("#emr_family").click(function(event) {
			//alert('Here');
	    	$("#FA_Tab").css("display","inherit");
	    	var cosa=chkb($("#emr_family").is(':checked'));
	    	if (cosa==1){
		    	$("#FA_Tab").css("display","inherit");
	    	}else{
		    	$("#FA_Tab").css("display","none");
		    
	    	}
  	  	      
    });
	
	//Added for getting the notification state and updating it
	 setTimeout(function(){
	 var cadena = '<?php echo $domain;?>/linkNotifications.php?idDoc=<?php echo $_SESSION['MEDID']?>&state=0&value=0';
	 var state=LanzaAjax(cadena);
	 //alert('state'+state);
	 if(parseInt(state))
	 $("#notify_link").prop('checked', true);
	 else
	 $("#notify_link").prop('checked', false);
	 },500);
	
	
	/*$("#notify_link").click(function(event) {
		
		var chkval=chkb($("#notify_link").is(':checked'));
		/*if(chkval==1){
			alert("Linked");
		}else {
			alert("Delinked");
		}*/
		
		 //alert(chkval);
		 //updating the link state in the database state signfy an update to the database;
		/* var cadena = '<?php echo $domain;?>/linkNotifications.php?idDoc=<?php echo $_SESSION['MEDID']?>&state=1&value='+chkval;
		 LanzaAjax(cadena);
		 displayalertnotification('Status Updated');
		
	});*/
	
	$("#notif_update").click(function() {
	
		var chkval=chkb($("#notify_link").is(':checked'));
		/*if(chkval==1){
			alert("Linked");
		}else {
			alert("Delinked");
		}*/
		
		 //alert(chkval);
		 //updating the link state in the database state signfy an update to the database;
		 var cadena = '<?php echo $domain;?>/linkNotifications.php?idDoc=<?php echo $_SESSION['MEDID']?>&state=1&value='+chkval;
		 LanzaAjax(cadena);
		 displayalertnotification('Status Updated');
	
	
	
	
	});
 
    function getIdUsFIXED(){
    	var fnac = $("#dp32").val();
   		var fnacnum = fnac.substr(6,4)+fnac.substr(3,2)+fnac.substr(0,2);
   		var gender = chkb($("#c2").is(':checked'));
   		
   		var gender = $("#gender").val();
   		var orderOB = $("#orderOB").val();
   		if (gender==0){ gender='0';}
   		if (orderOB==0){ orderOB='0';}
   		
   		var VIdUsFIXED = fnacnum+gender+orderOB;
   		$('#VIdUsFIXED').html(VIdUsFIXED);
   		$('#VIdUsFIXEDINSERT').val(VIdUsFIXED);
   		
    	}
 
     function getIdUsFIXEDNAME(){
    	var vname = $("#Vname").val().toLowerCase().replace(".","").replace(" ","");
   		var vsurname = $("#Vsurname").val().toLowerCase().replace(".","").replace(" ","");
    		
   		var VIdUsFIXEDNAME = vname+'.'+vsurname;
   		$('#VIdUsFIXEDNAME').html(VIdUsFIXEDNAME);
   		$('#VIdUsFIXEDNAMEINSERT').val(VIdUsFIXEDNAME);
    	}

    function chkb(bool){
	    if(bool)
	    	return 1;
	    	return 0;
	   }
	   
	 function LanzaAjax (DirURL)
		{
		var RecTipo = 'SIN MODIFICACIÓN';
	    $.ajax(
           {
           url: DirURL,
           dataType: "html",
           async: false,
           complete: function(){ //alert('Completed');
                    },
           success: function(data) {
                    if (typeof data == "string") {
                                RecTipo = data;
                                }
                     }
            });
		return RecTipo;
		}

	 function displayalertnotification(message){
	 
	  var gritterOptions = {
				   title: 'status',
				   text: message,
				   image:'images/Icono_H2M.png',
				   sticky: false,
				   time: '3000'
				  };
		$.gritter.add(gritterOptions);
	   
	  } 
	  
	  function set_checkbox_value(element_name,value)
	  {
		var element = document.getElementById(element_name);
		//alert('Setting to checked ' + element_name + '  ' + value);
		if(value==1)
		{
			element.checked='checked';
			if(element_name == 'emr_family')
			{
					$("#FA_Tab").css("display","inherit");
					var cosa=chkb($("#emr_family").is(':checked'));
					if (cosa==1){
					$("#FA_Tab").css("display","inherit");
					}else{
						$("#FA_Tab").css("display","none");
		    
					}
			}
			else if(element_name == 'emr_personal')
			{
				$("#PH_Tab").css("display","inherit");
				var cosa=chkb($("#emr_personal").is(':checked'));
				if (cosa==1){
					$("#PH_Tab").css("display","inherit");
				}else{
					$("#PH_Tab").css("display","none");
				
				}
				}

			}
	
	  }
 
    });
	
	function LanzaAjax (DirURL)
		{
		var RecTipo = 'SIN MODIFICACIÓN';
	    $.ajax(
           {
           url: DirURL,
           dataType: "html",
           async: false,
           complete: function(){ //alert('Completed');
                    },
           success: function(data) {
                    if (typeof data == "string") {
                                RecTipo = data;
                                }
                     }
            });
		return RecTipo;
		}

		
	function saveEMRConfig()
	{
		var demographics_checked = 1;   //Demographics has to be 1 by default
			var name_checked = 1;
			var middle_checked = 1;
			var surname_checked = 1;
			var gender_checked = 1;
			var dob_checked = 1;
			var address_checked = get_checkbox_value('emr_address');
			var address2_checked = get_checkbox_value('emr_address2');
			var city_checked = get_checkbox_value('emr_city');
			var state_checked = get_checkbox_value('emr_state');
			var country_checked = get_checkbox_value('emr_country');
			var notes_checked = get_checkbox_value('emr_notes');
			var phone_checked = get_checkbox_value('emr_phone');
			var insurance_checked = get_checkbox_value('emr_insurance');
			
		var personal_checked = get_checkbox_value('emr_personal');
			var fractures_checked = 0;
			var surgeries_checked = 0;
			var otherknown_checked = 0;
			var obstetric_checked = 0;
			var othermed_checked = 0;
			if(personal_checked)
			{
				fractures_checked = get_checkbox_value('emr_fractures');
				surgeries_checked = get_checkbox_value('emr_surgeries');
				otherknown_checked = get_checkbox_value('emr_otherknown');
				obstetric_checked = get_checkbox_value('emr_obstetric');
				othermed_checked = get_checkbox_value('emr_othermed');
			}
		var family_checked = get_checkbox_value('emr_family');
			var father_checked = 0;
			var mother_checked = 0;
			var siblings_checked = 0;
			if(family_checked)
			{
				father_checked = get_checkbox_value('emr_father');
				mother_checked = get_checkbox_value('emr_mother');
				siblings_checked = get_checkbox_value('emr_siblings');
			}
			
		var pastdx_checked = get_checkbox_value('emr_pastdx');
		var medications_checked = get_checkbox_value('emr_medications');
		var immunizations_checked = get_checkbox_value('emr_immunizations');
		var allergies_checked = get_checkbox_value('emr_allergies');
		
		var url='save_emr_config.php?ph='+personal_checked+'&fh='+family_checked+'&pastdx='+pastdx_checked+'&medications='+medications_checked+'&immunizations='+immunizations_checked+'&allergies='+allergies_checked+'&address='+address_checked+'&address2='+address2_checked+'&city='+city_checked+'&state='+state_checked+'&country='+country_checked+'&notes='+notes_checked+'&fractures='+fractures_checked+'&surgeries='+surgeries_checked+'&otherknown='+otherknown_checked+'&obstetric='+obstetric_checked+'&othermed='+othermed_checked+'&father='+father_checked+'&mother='+mother_checked+'&siblings='+siblings_checked+'&phone='+phone_checked+'&insurance='+insurance_checked;
		//alert(url);
		var RecTipo = LanzaAjax(url);
		if(RecTipo=="success")
		{
			alert("Changes Saved Successfully !!!");
		}
		else
		{
			alert("Error Saving Changes !!!");
		}
		
		
		//alert(RecTipo);
	}	
	
	function get_checkbox_value(element_name)
	{
		var element = document.getElementById(element_name);
		var element_checked = 0;
		if(element.checked)
		{
			element_checked=1;
		}
		return element_checked;
	}

	function saveSchedulerConfig()
	{	
		var serviceURL = 'clear_scheduler_data.php';
		var RecTipo = LanzaAjax(serviceURL);

		
		for(var j=0;j<predefined_events;j++)
		{
		
			if(deleted_elements.indexOf(j)==-1)
			{
				var title = $('#event'+j).val();
				var hours = $('#hours'+j).val();
				var minutes = $('#minutes'+j).val();
				var colour = $('#colour'+j).val();
				//alert(title + '  ' + hours + '  ' + minutes);
			
			
				var url = 'create_type_config_entry.php?title='+title+'&hours='+hours+'&minutes='+minutes+' &colour='+colour;
				//alert(url);
				var RecTipo = LanzaAjax(url);
				//alert(RecTipo);
			}
		}
		
		var url = 'save_notify_time.php?id='+ $('#notify_id').val() +'&minutes='+ $('#appoint_notify').val();
		//alert(url);
		RecTipo = LanzaAjax(url);
		
		
		
		var timezone_url = 'save_user_timezone.php?userid=<?php echo $_SESSION['MEDID'];?> &timez=' + $('#Timezone').val();
		//alert(timezone_url);
		Rectipo = LanzaAjax(timezone_url);
		
		window.location.replace("<?php echo $domain;?>/scheduler-n.php?curr_source=<?php echo $_SESSION['MEDID'];?>");
		
	}
	
	
	function add_visit_types()
		{
			add_event_config(predefined_events,'',0,0,'ffffff');
			//predefined_events++;
		}
		
		function add_event_config(i,title,hours,minutes,colour)
		{
			var grandfather = document.getElementById("CLICK_EVENT");
			//alert('Found GrandFather '+grandfather);
			
			var father = document.createElement("div");
				father.setAttribute("class","formRow");
				father.setAttribute("id","row"+i);	
					
					father.innerHTML = "Type : ";
					var title_child = document.createElement("input");
					title_child.setAttribute("type","text");
					title_child.setAttribute("id","event"+i);
					title_child.setAttribute("name","event"+i);
					title_child.setAttribute("value",title);
					title_child.style.width = '8em'
					father.appendChild(title_child);
				
					father.innerHTML += "  Hours : ";
					var hours_child = document.createElement("select");
					hours_child.setAttribute("id","hours"+i);
					hours_child.setAttribute("name","hours"+i);
					hours_child.style.width = '8em'
					for(var j=0;j<25;j++)
					{
						hours_child.options[hours_child.options.length]= new Option(j, j);
					}
					hours_child.options[parseInt(hours)].setAttribute('selected',true)
					
					father.appendChild(hours_child);
					
					father.innerHTML += "  Minutes : ";
					var minutes_child = document.createElement("select");
					minutes_child.setAttribute("id","minutes"+i);
					minutes_child.setAttribute("name","minutes"+i);
					minutes_child.style.width = '8em'
					for(var j=0;j<61;j++)
					{
						minutes_child.options[minutes_child.options.length]= new Option(j, j);
					}
					minutes_child.options[parseInt(minutes)].setAttribute('selected',true)
					father.appendChild(minutes_child);
					
					father.innerHTML += "  Pick Colour: ";
			/*		var color_child = document.createElement("select");
					color_child.class = "color";
					color_child.value = "ffffff";
					father.appendChild(color_child);*/
					
					var input = document.createElement('INPUT');
					input.style.width = '5em';
					input.setAttribute("id","colour"+i);
					input.setAttribute("name","colour"+i);
					// bind jscolor
					var col = new jscolor.color(input);
					//col.fromHSV(6/event_config.length*i, 1, 1);
					col.fromString(colour);
					father.appendChild(input);
					
					var button = document.createElement('input');
					button.setAttribute('type','image');
					button.setAttribute('id','but_'+i);
					button.setAttribute('src','images/del_button.jpg');
					button.style.width='20px';
					button.style.height='20px';
					button.onclick = function () {
						//alert('You pressed '+this.id);
						var n = this.id.split('_');
						//alert('delete' + n[1]);
						var row_to_del = 'row'+n[1];
						var element = document.getElementById(row_to_del);
						element.parentNode.removeChild(element);
						deleted_elements.push(n[1]);	
						//arrayToModify[arrayToModify.length] = this.id;
					};
					
					father.appendChild(button);
			grandfather.appendChild(father);
			predefined_events++;
		
		}
	
	
	
	
	var grptble = LanzaAjax('getGroupDetails.php?docid=<?php echo $_SESSION['MEDID'];?>');
	
	$('#group_details').html(grptble);
	
	var groupid=-1;
	
	$(".CFILADoctor").live('click',function() {
	

     	groupid = $(this).attr("id");

		GetGroupData('getGroupData.php?groupid='+groupid);
			
		var grpdoctble = LanzaAjax('getGroupDocs.php?docid=<?php echo $_SESSION['MEDID'];?>&groupid='+groupid);
		$('#group_members').html(grpdoctble);
		
		$('#editgrpname').val(group_data[0].Name);
		$('#editgrpadd').val(group_data[0].Address);
		$('#editgrpzip').val(group_data[0].ZIP);
		$('#editgrpcity').val(group_data[0].City);
		$('#editgrpstate').val(group_data[0].State);
		$('#editgrpcountry').val(group_data[0].Country);
		
		$("#editgrpname").attr("disabled", "disabled");
		$('#editgrpadd').attr("disabled", "disabled");
		$('#editgrpzip').attr("disabled", "disabled");
		$('#editgrpcity').attr("disabled", "disabled");
		$('#editgrpstate').attr("disabled", "disabled");
		$('#editgrpcountry').attr("disabled", "disabled");
		//disable uploading group picture
		$('#filesToUpload').attr("disabled", "disabled");
		
		var div = document.createElement('div');
		if(group_data[0].Image!=''){
			div.innerHTML = '<img style="width:150px;height:150px;margin-bottom:10px;" src="uploads/' + group_data[0].Image + '" />';
		}else {
			div.innerHTML = '<img style="width:150px;height:150px;margin-bottom:10px;" src="images/defaultgrouppic.jpg" />';
		}
		
		$("#grpimage").html(div);
		
		$("#groupconfig").dialog({bgiframe: true, width: 700, height: 650, modal: true});
		//GetDocs();
		checkowner();
	});
	
	 $("tr.CFILADoctor").live("mouseenter",function () {
			$(this).css("background","LightSteelBlue");
			$(this).css("cursor","pointer");
		});
		
	$("tr.CFILADoctor").live("mouseleave",function () {
			$(this).css("background","");
	});
	
	$('input[type=checkbox][id^="checkcol"]').live('click',function() {
    // this represents the checkbox that was checked
	    
       if($(this).is(':checked'))       		
       		$("#remove_doc").show();			
       else
       		$("#remove_doc").hide();			
      
	});
	
	$('input[type=checkbox][id^="CFILAAdminRole"]').live('click',function() {
    // this represents the checkbox that was checked
	    var parentid=$(this).parents("tr.CFILAGroupDoc").attr("id");
		//alert('hello');
		//alert(parentid);
		var getchkval=checkowner();
		
			if (getchkval>0){
				//alert (" Admin rights");
				if($(this).is(':checked'))  {
					var cadena='addDoctorAsAdmin.php?groupid='+groupid+'&id='+parentid;
					var RecTipo=LanzaAjax(cadena);
					
				}else{
					var cadena='RemoveDocAsAdmin.php?groupid='+groupid+'&id='+parentid;
					var RecTipo=LanzaAjax(cadena);			   
				}
				
				
			}else {
				alert (" Non-Admin rights");
				 
			}
		
				var grpdoctble = LanzaAjax('getGroupDocs.php?docid=<?php echo $_SESSION['MEDID'];?>&groupid='+groupid);
				$('#group_members').html(grpdoctble);
      
	});
	
	$('input[type=checkbox][id^="CFILADocRole"]').live('click',function() {
    // this represents the checkbox that was checked
	    var parentid=$(this).parents("tr.CFILAGroupDoc").attr("id");
		//alert('hello');
		//alert(parentid);	
		var getchkval=checkowner();
		
			if (getchkval>0){
				//alert (" Admin rights");
				if($(this).is(':checked'))  {
					var cadena='addDoctorAsRole.php?groupid='+groupid+'&id='+parentid+'&role=1';
					var RecTipo=LanzaAjax(cadena);
					
				}else{
					var cadena='addDoctorAsRole.php?groupid='+groupid+'&id='+parentid+'&role=2';
					var RecTipo=LanzaAjax(cadena);			   
				}
				
				
			}else {
				alert (" Non-Admin rights");
				 
			}		
			
			var grpdoctble = LanzaAjax('getGroupDocs.php?docid=<?php echo $_SESSION['MEDID'];?>&groupid='+groupid);
			$('#group_members').html(grpdoctble);
      
	});
	
	
	$('input[type=checkbox][id^="CFILAStaffRole"]').live('click',function() {
    // this represents the checkbox that was checked
	    var parentid=$(this).parents("tr.CFILAGroupDoc").attr("id");
		//alert('hello');
		//alert(parentid);	
		var getchkval=checkowner();
		
			if (getchkval>0){
				//alert (" Admin rights");
				if($(this).is(':checked'))  {
					var cadena='addDoctorAsRole.php?groupid='+groupid+'&id='+parentid+'&role=2';
					var RecTipo=LanzaAjax(cadena);
					
				}else{
					var cadena='addDoctorAsRole.php?groupid='+groupid+'&id='+parentid+'&role=1';
					var RecTipo=LanzaAjax(cadena);			   
				}
				
				
			}else {
				alert (" Non-Admin rights");
				 
			}		
			
				var grpdoctble = LanzaAjax('getGroupDocs.php?docid=<?php echo $_SESSION['MEDID'];?>&groupid='+groupid);
				$('#group_members').html(grpdoctble);
      
	});
	
	
	
	$('input[type=checkbox][id^="CFILAReferralRole"]').live('click',function() {
    // this represents the checkbox that was checked
	   var parentid=$(this).parents("tr.CFILAGroupDoc").attr("id");
		//alert('hello');
		//alert(parentid);	
		var getchkval=checkowner();
		
			if (getchkval>0){
				//alert (" Admin rights");
				if($(this).is(':checked'))  {
					var cadena='addDoctorAsRefIncharge.php?groupid='+groupid+'&id='+parentid;
					var RecTipo=LanzaAjax(cadena);
					
				}else{
					var cadena='addDoctorAsRefIncharge?groupid='+groupid+'&id='+parentid;
					var RecTipo=LanzaAjax(cadena);			   
				}
				
				
			}else {
				alert (" Non-Admin rights");
				 
			}		
      			
			    var grpdoctble = LanzaAjax('getGroupDocs.php?docid=<?php echo $_SESSION['MEDID'];?>&groupid='+groupid);
				$('#group_members').html(grpdoctble);
	});
	
	
    function checkowner(){

		var getownerval=LanzaAjax('CheckOwner.php?docid=<?php echo $_SESSION['MEDID'];?>&groupid='+groupid);
		
				
		if(getownerval>0){
			 $("input.group1").attr("disabled", true);
		 }else{
			 $("input.group1").removeAttr("disabled");
	     }
		 
		 return getownerval
	   
	}
	
	 checkowner();
	  
	
	 $("#remove_doc").live('click',function(){
	   var num=0;
	   
	   var checkowner=LanzaAjax('CheckOwner.php?docid=<?php echo $_SESSION['MEDID'];?>&groupid='+groupid);
	   
	   if(checkowner>0){
		   
		   var conf=confirm('Are you sure you want to remove this doctor from the group!Press Ok to confirm.');
		   if(conf){
		   $('input[type=checkbox][id^="checkcol"]').each(
		   function () {
						var sThisVal = (this.checked ? "1" : "0");
						
						//sList += (sList=="" ? sThisVal : "," + sThisVal);
						if(sThisVal==1){
						 var id=$(this).parents("tr.CFILAGroupDoc").attr("id");
						 var docid=$(this).parents("tr.CFILAGroupDoc").children("td.CFILADocname").attr("id");
						 //alert(docid);
						 //alert("Id "+idp+" selected"); 
						 //messageid=messageid+idp+' ,';
						 num=num+1;
						 var cadena='removeDocFromGroup.php?id='+id+'&groupid='+groupid+'&docid='+docid;
						 LanzaAjax(cadena);
						}
				
					
				});
		
			}
			
			var grpdoctble = LanzaAjax('getGroupDocs.php?docid=<?php echo $_SESSION['MEDID'];?>&groupid='+groupid);
			$('#group_members').html(grpdoctble);
		}else
			alert("Removal not allowed since you are not the group owner");
			
		$("#remove_doc").hide();
	});
	
	var DocList;

	
	GetDocs();
	
	function GetDocs(){
			//var queMED = $("#MEDID").val();
			
			var queUrl ='getValidDoctors.php';		
				
			$.ajax(
			{
				url: queUrl,
				dataType: "json",
				async: false,
				success: function(data)
				{
					DocList = data.items;
					//alert(DocList[0].id);
				}
			});
			
	}
	
	
	var VDocId = 0;
	var VDocName = '';
	/*var VDocId1 = 0;
	var VDocName1 = '';
	var VDocId2 = 0;
	var VDocName2 = '';
	var VDocId3 = 0;
	var VDocName3 = '';*/
	
	$("#DoctorSBox").autocomplete({
        source: DocList,
        minLength: 1,
        select: function(event, ui) {
            // feed hidden id field
            $("#field_id").val(ui.item.id);
            // update number of returned rows
            $('#results_count').html('');
            VDocName =  ui.item.label;
            VDocId =  $("#field_id").val();
        },
        open: function(event, ui) {
            // update number of returned rows
            var len = $('.ui-autocomplete > li').length;
            $('#results_count').html('(#' + len + ')');
        },
        close: function(event, ui) {
            // update number of returned rows
            $('#results_count').html('');
        },
        // mustMatch implementation
        change: function (event, ui) {
            if (ui.item === null) {
                $(this).val('');
                $('#field_id').val('');
            }
        }
    });
	/*
	$("#DoctorSBox1").autocomplete({
        source: DocList,
        minLength: 1,
        select: function(event, ui) {
            // feed hidden id field
            $("#field_id1").val(ui.item.id);
            // update number of returned rows
            $('#results_count1').html('');
            VDocName1 =  ui.item.label;
            VDocId1 =  $("#field_id1").val();
        },
        open: function(event, ui) {
            // update number of returned rows
            var len = $('.ui-autocomplete > li').length;
            $('#results_count1').html('(#' + len + ')');
        },
        close: function(event, ui) {
            // update number of returned rows
            $('#results_count1').html('');
        },
        // mustMatch implementation
        change: function (event, ui) {
            if (ui.item === null) {
                $(this).val('');
                $('#field_id1').val('');
            }
        }
    });
	
	$("#DoctorSBox2").autocomplete({
        source: DocList,
        minLength: 1,
        select: function(event, ui) {
            // feed hidden id field
            $("#field_id2").val(ui.item.id);
            // update number of returned rows
            $('#results_count2').html('');
            VDocName2=  ui.item.label;
            VDocId2 =  $("#field_id2").val();
        },
        open: function(event, ui) {
            // update number of returned rows
            var len = $('.ui-autocomplete > li').length;
            $('#results_count2').html('(#' + len + ')');
        },
        close: function(event, ui) {
            // update number of returned rows
            $('#results_count2').html('');
        },
        // mustMatch implementation
        change: function (event, ui) {
            if (ui.item === null) {
                $(this).val('');
                $('#field_id2').val('');
            }
        }
    });
	
	$("#DoctorSBox3").autocomplete({
        source: DocList,
        minLength: 1,
        select: function(event, ui) {
            // feed hidden id field
            $("#field_id3").val(ui.item.id);
            // update number of returned rows
            $('#results_count3').html('');
            VDocName3=  ui.item.label;
            VDocId3 =  $("#field_id3").val();
        },
        open: function(event, ui) {
            // update number of returned rows
            var len = $('.ui-autocomplete > li').length;
            $('#results_count3').html('(#' + len + ')');
        },
        close: function(event, ui) {
            // update number of returned rows
            $('#results_count3').html('');
        },
        // mustMatch implementation
        change: function (event, ui) {
            if (ui.item === null) {
                $(this).val('');
                $('#field_id3').val('');
            }
        }
    });
   */
    $("#DoctorSBox").focusout(function() {
        if ($("#field").val() === '') {
            $('#field_id').val('');
        }
    });
	
	/*$("#DoctorSBox1").focusout(function() {
        if ($("#field").val() === '') {
            $('#field_id1').val('');
        }
    });
	
	$("#DoctorSBox2").focusout(function() {
        if ($("#field").val() === '') {
            $('#field_id2').val('');
        }
    });
	$("#DoctorSBox3").focusout(function() {
        if ($("#field").val() === '') {
            $('#field_id3').val('');
        }
    });*/
	
	//Group Image upload function
		/*function fileSelect(evt) {
			if (window.File && window.FileReader && window.FileList && window.Blob) {
				var files = evt.target.files;
		 
				var result = '';
				var file;
				for (var i = 0; file = files[i]; i++) {
					// if the file is not an image, continue
					if (!file.type.match('image.*')) {
						continue;
					}
		 
					reader = new FileReader();
					reader.onload = (function (tFile) {
						return function (evt) {
							var div = document.createElement('div');
							div.innerHTML = '<img style="width: 90px;" src="' + evt.target.result + '" />';
							document.getElementById('filesInfo').appendChild(div);
						};
					}(file));
					reader.readAsDataURL(file);
				}
			} else {
				alert('The File APIs are not fully supported in this browser.');
			}
		}
		 
		document.getElementById('filesToUpload').addEventListener('change', fileSelect, false);*/
		var whichimage=0;
		
		var picuploaded=0;
		if (window.File && window.FileReader && window.FileList && window.Blob) {
				document.getElementById('filesToUpload').onchange = function(){
					whichimage=1;
					var files = document.getElementById('filesToUpload').files;
					for(var i = 0; i < files.length; i++) {
						resizeAndUpload(files[i]);
					}
				};
				
				document.getElementById('createfilesToUpload').onchange = function(){
					
					whichimage=2;
					var files = document.getElementById('createfilesToUpload').files;
					for(var i = 0; i < files.length; i++) {
						resizeAndUpload(files[i]);
					}
				};
				
				
			} else {
				alert('The File APIs are not fully supported in this browser.');
			}
			 
			function resizeAndUpload(file) {
			var reader = new FileReader();
				
				reader.onloadend = function() {
			 
				var tempImg = new Image();
				tempImg.src = reader.result;
				tempImg.onload = function() {
			 
					var MAX_WIDTH = 400;
					var MAX_HEIGHT = 300;
					var tempW = tempImg.width;
					var tempH = tempImg.height;
					if (tempW > tempH) {
						if (tempW > MAX_WIDTH) {
						   tempH *= MAX_WIDTH / tempW;
						   tempW = MAX_WIDTH;
						}
					} else {
						if (tempH > MAX_HEIGHT) {
						   tempW *= MAX_HEIGHT / tempH;
						   tempH = MAX_HEIGHT;
						}
					}
			 
					var canvas = document.createElement('canvas');
					canvas.width = tempW;
					canvas.height = tempH;
					var ctx = canvas.getContext("2d");
					ctx.drawImage(this, 0, 0, tempW, tempH);
					dataURL = canvas.toDataURL("image/jpeg");
			 
					//start
						var div = document.createElement('div');
						div.innerHTML = '<img style="width:150px;height:150px;margin-bottom:10px;" src="' + dataURL + '" />';
						//document.getElementById('filesInfo').appendChild(div);
						if(whichimage==1)
							$('#grpimage').html(div);
						else if(whichimage==2)
							$('#creategrpimage').html(div);
					
					
					//end
					var xhr = new XMLHttpRequest();
					xhr.onreadystatechange = function(ev){
						//document.getElementById('filesInfo').innerHTML = 'Done!';
						var div = document.createElement('div');
						div.innerHTML = '<img style="width:150px;height:150px;margin-bottom:10px;" src="' + dataURL + '" />';
						//document.getElementById('filesInfo').appendChild(div);
						if(whichimage==1)
							$('#grpimage').html(div);
						else if(whichimage==2)
							$('#creategrpimage').html(div);
					};
					
					if(whichimage==1){
						xhr.open('POST', 'uploadResized.php?groupid='+groupid, true);
						xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");
						var data = 'image=' + dataURL;
						xhr.send(data);
					}
				  }
			 
			   }
			   reader.readAsDataURL(file);
			}

	$('#add_doctors').live('click', function(){
		
		//alert(VDocId);
		if(VDocId==0){
		
			alert("Please enter a valid Doctor Name");
		 
		}else{
			var cadena='addDoctorInGroup.php?groupid='+groupid+'&docid='+VDocId;
			var RecTipo=LanzaAjax(cadena);
			if(RecTipo==0){
				alert('Doctor already present in the Group');
			}else if(RecTipo==1){
				//alert('Doctor added succesfully in the Group');
				//$("#groupconfig").dialog('close');
				var grpdoctble = LanzaAjax('getGroupDocs.php?docid=<?php echo $_SESSION['MEDID'];?>&groupid='+groupid);
				$('#group_members').html(grpdoctble);
			}
			$("#DoctorSBox").val('');
			VDocId=0;
		}
	
	});
	
	/*
	$('#add_admin').live('click', function(){
		
		//alert(VDocId);
		if(VDocId1==0){
		
			alert("Please enter a valid Doctor Name");
		 
		}else{
			var cadena='addDoctorAsAdmin.php?groupid='+groupid+'&docid='+VDocId1;
			var RecTipo=LanzaAjax(cadena);
			if(RecTipo==0){
				alert('Doctor already present as Admin in the Group');
			}else if(RecTipo==1){
				alert('Doctor added succesfully in the Group');
				//$("#groupconfig").dialog('close');
				var grpdoctble = LanzaAjax('getGroupDocs.php?docid=<?php echo $_SESSION['MEDID'];?>&groupid='+groupid);
				$('#group_members').html(grpdoctble);
			}
			$("#DoctorSBox1").val('');
			VDocId1=0;
		}
	
	});
	
	$('#add_refdoc').live('click', function(){
		
		//alert(VDocId);
		if(VDocId2==0){
		
			alert("Please enter a valid Doctor Name");
		 
		}else{
			var cadena='addDoctorAsRefIncharge.php?groupid='+groupid+'&docid='+VDocId2;
			var RecTipo=LanzaAjax(cadena);
			    //alert('Doctor added succesfully in the Group');
				//$("#groupconfig").dialog('close');
				var grpdoctble = LanzaAjax('getGroupDocs.php?docid=<?php echo $_SESSION['MEDID'];?>&groupid='+groupid);
				$('#group_members').html(grpdoctble);
				$("#DoctorSBox2").val('');
				VDocId2=0;
		}
	
	});
	
	
	
	$('#change_owner').live('click', function(){
		
		//alert(VDocId);
		if(VDocId3==0){
		
			alert("Please enter a valid Doctor Name");
		 
		}else{
			var cadena='ChangeGroupOwner.php?groupid='+groupid+'&docid='+VDocId3;
			var RecTipo=LanzaAjax(cadena);
			    //alert('Doctor added succesfully in the Group');
				//$("#groupconfig").dialog('close');
				var grpdoctble = LanzaAjax('getGroupDocs.php?docid=<?php echo $_SESSION['MEDID'];?>&groupid='+groupid);
				$('#group_members').html(grpdoctble);
				$("#DoctorSBox3").val('');
				VDocId3=0;
				checkowner();
		}
	
	});
	*/
	var group_data;
	function GetGroupData(dataurl){
			//var queMED = $("#MEDID").val();
			
			//var queUrl ='getValidDoctors.php';		
				
			$.ajax(
			{
				url: dataurl,
				dataType: "json",
				async: false,
				success: function(data)
				{
					group_data = data.items;
				}
			});
			
			
		
	}
	
	// Variable for capturing local image file
	var dataURL;
        

	$("#create_group").live('click', function(){
	
	  var grpname=$('#Groupname').val();
	  var grpadd=$('#Groupadd').val();
	  var grpzip=$('#Groupzip').val();
	  var grpcity=$('#Groupcity').val();
	  var grpstate=$('#Groupstate').val();
	  var grpcountry=$('#Groupcountry').val();
	  
	  if(grpname==''||grpadd==''||grpzip==''||grpcity==''||grpstate==''||grpcountry==''){
			alert('Empty field not allowed');
	  }else{
	  
	    var cadena='CreateGroup.php?grpname='+grpname+'&grpadd='+grpadd+'&grpzip='+grpzip+'&grpcity='+grpcity+'&grpstate='+grpstate+'&grpcountry='+grpcountry+'&docid=<?php echo $_SESSION['MEDID'];?>';
		var grpid=LanzaAjax(cadena);
//		alert(grpid);
		if(grpid>0){
		
					if(whichimage==2){
					var xhr = new XMLHttpRequest();
					xhr.onreadystatechange = function(ev){
						//document.getElementById('filesInfo').innerHTML = 'Done!';
						/*var div = document.createElement('div');
						div.innerHTML = '<img style="width:150px;height:150px;margin-bottom:10px;" src="' + dataURL + '" />';
						//document.getElementById('filesInfo').appendChild(div);
						/*if(whichimage==1)
							$('#grpimage').html(div);*/
						//else if(whichimage==2)
							//$('#creategrpimage').html(div);
					};
			 
					xhr.open('POST', 'uploadResized.php?groupid='+grpid, true);
					xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");
					var data = 'image=' + dataURL;
					xhr.send(data);
					}
					
				alert('Group Created!');
				var grptble = LanzaAjax('getGroupDetails.php?docid=<?php echo $_SESSION['MEDID'];?>');	
				$('#group_details').html(grptble);
		}
		
		$('#Groupname').val('');
		$('#Groupadd').val('');
		$('#Groupzip').val('');
		$('#Groupcity').val('');
		$('#Groupstate').val('');
		$('#Groupcountry').val('');
		$('#creategrpimage').html('<img style="width:150px;height:150px;margin-bottom:10px" src="images/defaultgrouppic.jpg" alt="Group Picture"/>');
	  
	  }
	  
	  grpname='';
	  grpadd='';
	  grpzip='';
	  grpcity='';
	  grpstate='';
	  grpcountry='';
	
	});
	
	
	$('#Edit_group').live('click', function(){
	
		var checkowner=LanzaAjax('CheckOwner.php?docid=<?php echo $_SESSION['MEDID'];?>&groupid='+groupid);	   
	   if(checkowner>0){
	   
				$("#editgrpname").removeAttr("disabled"); 
				$('#editgrpadd').removeAttr("disabled"); 
				$('#editgrpzip').removeAttr("disabled"); 
				$('#editgrpcity').removeAttr("disabled"); 
				$('#editgrpstate').removeAttr("disabled"); 
				$('#editgrpcountry').removeAttr("disabled"); 
				$('#filesToUpload').removeAttr("disabled"); 
				$('#save_grpdate').show();
	   
	   }else{
			alert('Group data Edit not allowed since you are not the group owner');
	   }
	
	});
	
	$('#save_grpdate').live('click', function(){
	
	  var grpname=$('#editgrpname').val();
	  var grpadd=$('#editgrpadd').val();
	  var grpzip=$('#editgrpzip').val();
	  var grpcity=$('#editgrpcity').val();
	  var grpstate=$('#editgrpstate').val();
	  var grpcountry=$('#editgrpcountry').val();
	  
	  if(grpname==''||grpadd==''||grpzip==''||grpcity==''||grpstate==''||grpcountry==''){
			alert('Empty field not allowed');
	  }else{
	  
	    var cadena='SaveGroup.php?grpname='+grpname+'&grpadd='+grpadd+'&grpzip='+grpzip+'&grpcity='+grpcity+'&grpstate='+grpstate+'&grpcountry='+grpcountry+'&groupid='+groupid;
		var RecTipo=LanzaAjax(cadena);
		
		if(RecTipo==1){
				//alert('Group Created!');
				var grptble = LanzaAjax('getGroupDetails.php?docid=<?php echo $_SESSION['MEDID'];?>');	
				$('#group_details').html(grptble);
		}
		
		$("#editgrpname").attr("disabled", "disabled");
		$('#editgrpadd').attr("disabled", "disabled");
		$('#editgrpzip').attr("disabled", "disabled");
		$('#editgrpcity').attr("disabled", "disabled");
		$('#editgrpstate').attr("disabled", "disabled");
		$('#editgrpcountry').attr("disabled", "disabled");	
		$('#filesToUpload').attr("disabled", "disabled");

		 $('#save_grpdate').hide();
		
	  
	  }
	  
	  grpname='';
	  grpadd='';
	  grpzip='';
	  grpcity='';
	  grpstate='';
	  grpcountry='';
	
	
	
	});
	
	
	//get the timezone from the database
    timezone_db = "<?php echo $timezone; ?>";  
	var current_timezone = get_timezone_offset();
	//console.log("TX:"+current_timezone);
        if (timezone_db != null) {
            timezone_array = timezone_db.split(":");
            timezone_format = timezone_array[0];
            timezone_format_mins = timezone_array[1];
            timezone_minutes = ".0";
            if (timezone_format_mins == "30") {
                timezone_minutes = ".5";   
            }
            timezone_format=parseInt(timezone_format, 10)+timezone_minutes;
            $("#timezone_picker").val(timezone_format); 

        }    
        else if(current_timezone != 'none')
        {
            var v = parseInt(current_timezone.substr(0, 3));
            var m = parseInt(current_timezone.substr(4, 2));
			//alert(v + '  ' + m);
            if(m != 0)
            {
                $("#timezone_picker").val(v+(m / 60.0));
            }
            else
            {
                $("#timezone_picker").val(v+'.0');
				//alert($("#timezone_picker").val());
            }
        }
	//alert(current_timezone);
	
	
	//Code for Telemedicine Tab Starts Here
	
	var d=new Date();
	var sub = d.getDay();
	d.setDate(d.getDate()-sub);
	//alert('Date on Monday was' + d.getDate());
	var startDate = new Date(d);
	d.setDate(d.getDate()+6);
	var endDate = new Date(d);
    var copyDate = startDate;
	$('#CurrentPage').text(getDateRepresentation(startDate) + ' - ' + getDateRepresentation(endDate));
	
	getWeeklyTimeslots(startDate);   //get data for this week
	showAppointmentData(startDate);  //generate html
	
	function getDateDay(index)
	{
		var dayNames= ["Sunday" , "Monday" , "Tuesday" , "Wednesday" , "Thursday" , "Friday" , "Saturday"];
		//console.log(index);
		return dayNames[index];
	}
	
	function getDateRepresentation(d)
	{
	if(language == 'th'){
			var monthNames = [ "Ene", "Feb", "Mar", "Abr", "May", "June","July", "Ago", "Sep", "Oct", "Nov", "Dic" ];
			}else{
			var monthNames = [ "Jan", "Feb", "Mar", "Apr", "May", "June","July", "Aug", "Sep", "Oct", "Nov", "Dec" ];
			}
		
		var day = d.getDate();
		var month = monthNames[d.getMonth()];
		var year = d.getFullYear();
		return month + ' ' + day + ',' + year;
	}
	
	function getDateDatabaseRepresentation(d)
	{
		var day = d.getDate();
		var month = d.getMonth()+1;
		var year = d.getFullYear();
		
		return year+'-'+month+'-'+day;
	
	}
	
	function getTimeRepresentation(baseTime)
	{
		var tok = baseTime.split(':');
		var hours = parseInt(tok[0]);
		var minutes = parseInt(tok[1]);
		var t = 'am';
		
		if(hours == 0)
		{
			hours = 12;
			t='am';
		}
		else if(hours>12)
		{
			hours = hours - 12;
			t='pm';
		}
		else if(hours==12)
		{
			t='pm';
		}
		
		if(minutes==0)
		{
			return hours + '.00 ' + t;
		}
		else
		{
			return hours + '.' + minutes + ' ' + t;
		}
		
		
		
		
	}
        
    $("#copy_week").live('click', function()
    {
        $("#paste_week").css("display", "block");
        copyDate = startDate.toISOString().split("T")[0];
        console.log(copyDate);
        
    });
    $("#paste_week").live('click', function()
    {
        var pasteDate = startDate.toISOString().split("T")[0];
        if(pasteDate != copyDate && endDate >= d)
        {
            $.get("createDoctorTimeslot.php?copy="+copyDate+"&paste="+pasteDate, function(data, status)
            {
                getWeeklyTimeslots(startDate);
                showAppointmentData(startDate);
            });
        }
        else if(endDate < d)
        {
            alert("You cannot paste a week into the past.");
        }
        else
        {
            alert("Please choose another week to paste the copied week into.");
        }
    });
    $("#clear_week").live('click', function()
    {
        var answer = confirm("Are you sure you want to delete this whole week?");
        if(answer)
        {
            $.get("deleteDoctorAvailability.php?clear="+startDate.toISOString().split("T")[0], function(data, status)
            {
                displaynotification('Week Deleted',' ');
                getWeeklyTimeslots(startDate);
                showAppointmentData(startDate);
            });
            
        }
        else
        {
            //do nothing
        }	
        
    });
        

        
    $("#timezone_picker").change(function()
    {
        console.log("Clicked");
        getWeeklyTimeslots(startDate);
        showAppointmentData(startDate);
        //update the database Ajax code here
        email="<?php echo $email ?>";
        current_timezone=$("#timezone_picker").val();
        url= "get_timezone.php?timezone="+current_timezone+"&email="+email+"&type=doctor";
        var RecTipo=LanzaAjax(url);   
    });
	
	$("#next").live('click',function() {
		startDate.setDate(startDate.getDate()+7);
		endDate.setDate(endDate.getDate()+7);
		$('#CurrentPage').text(getDateRepresentation(startDate) + ' - ' + getDateRepresentation(endDate));
		getWeeklyTimeslots(startDate);
		showAppointmentData(startDate);
		
		lastSelected='';
		selectedRow = -1;
		selectedColumn = -1;
		selectedTime = '';
		
		
	 });	
	 
	$("#prev").live('click',function() {
		startDate.setDate(startDate.getDate()-7);
		endDate.setDate(endDate.getDate()-7);
		$('#CurrentPage').text(getDateRepresentation(startDate) + ' - ' + getDateRepresentation(endDate));
		getWeeklyTimeslots(startDate);
		showAppointmentData(startDate);
		
		lastSelected='';
		selectedRow = -1;
		selectedColumn = -1;
		selectedTime = '';
		
		
	 });	 
	 
	 function showAppointmentData(sDate)
	 {
		
		var origDt = new Date(sDate);
		var dt = new Date();
		//console.log('Start Date = ' + getDateRepresentation(origDt));
		var AppointmentBox='<button type="button" id="popover_btn" data-container="body" data-toggle="popover" data-placement="left" style="float: right; background-color: #FFF; outline: 0px; border: 0px solid #FFF;" data-content="To add a new availability timeslot, simply click on the time where you would like it to start, and then click on the time where you would like it to end.<br/><br/>To delete an availability timeslot, simply click on it and select \'OK\'. "><i class="icon-info-sign"></i></button>';
		for(i=0;i<7;++i)
		{
			if(i==6)
			{
			
				AppointmentBox += '<div class="InfoRow" style="height:40px;padding-top:40px;padding-bottom:40px" id='+getDateDatabaseRepresentation(origDt)+'>';
			}
			else
			{
				AppointmentBox += '<div class="InfoRow" style="height:40px;padding-top:40px" id='+getDateDatabaseRepresentation(origDt)+'>';
			}
			//AppointmentBox += '<div style="width:100px; float:left; text-align:left;margin-left:10px"><span class="PatName">'+getDateDay(i) + ' ' + getDateRepresentation(origDt)+'</span></div>';
		var translation3 = '';
		var translationString = ''

		if(language == 'th'){
		
		if(getDateDay(i) == 'Sunday'){
		translation3 = 'Domingo';
		}
		if(getDateDay(i) == 'Monday'){
		translation3 = 'Lunes';
		}
		if(getDateDay(i) == 'Tuesday'){
		translation3 = 'Martes';
		}
		if(getDateDay(i) == 'Wednesday'){
		translation3 = 'Miércoles';
		}
		if(getDateDay(i) == 'Thursday'){
		translation3 = 'Jueves';
		}
		if(getDateDay(i) == 'Friday'){
		translation3 = 'Viernes';
		}
		if(getDateDay(i) == 'Saturday'){
		translation3 = 'Sábado';
		}
		
		
		var str = getDateRepresentation(origDt);
		var getString = str.substring(0,3);
		var getEnd = str.substring(4,11);
		if(getString == 'Ene'){
		translationString = 'Ene '+getEnd;
		}
		if(getString == 'Feb'){
		translationString = 'Feb '+getEnd;
		}
		if(getString == 'Mar'){
		translationString = 'Mar '+getEnd;
		}
		if(getString == 'Abr'){
		translationString = 'Abr '+getEnd;
		}
		if(getString == 'May'){
		translationString = 'May '+getEnd;
		}
		if(getString == 'Jun'){
		translationString = 'Jun '+getEnd;
		}
		if(getString == 'Jul'){
		translationString = 'Jul '+getEnd;
		}
		if(getString == 'Ago'){
		translationString = 'Ago '+getEnd;
		}
		if(getString == 'Sep'){
		translationString = 'Sep '+getEnd;
		}
		if(getString == 'Oct'){
		translationString = 'Oct '+getEnd;
		}
		if(getString == 'Nov'){
		translationString = 'Nov '+getEnd;
		}
		if(getString == 'Dic'){
		translationString = 'Dic '+getEnd;
		}
		
		}else if(language == 'en'){
		
		if(getDateDay(i) == 'Sunday'){
		translation3 = 'Sunday';
		}
		if(getDateDay(i) == 'Monday'){
		translation3 = 'Monday';
		}
		if(getDateDay(i) == 'Tuesday'){
		translation3 = 'Tuesday';
		}
		if(getDateDay(i) == 'Wednesday'){
		translation3 = 'Wednesday';
		}
		if(getDateDay(i) == 'Thursday'){
		translation3 = 'Thursday';
		}
		if(getDateDay(i) == 'Friday'){
		translation3 = 'Friday';
		}
		if(getDateDay(i) == 'Saturday'){
		translation3 = 'Saturday';
		}
		
		
		var str2 = getDateRepresentation(origDt);
		var getString2 = str2.substring(0,3);
		var getEnd2 = str2.substring(4,11);
		if(getString2 == 'Jan'){
		translationString = 'Jan '+getEnd2;
		}
		if(getString2 == 'Feb'){
		translationString = 'Feb '+getEnd2;
		}
		if(getString2 == 'Mar'){
		translationString = 'Mar '+getEnd2;
		}
		if(getString2 == 'Apr'){
		translationString = 'Apr '+getEnd2;
		}
		if(getString2 == 'May'){
		translationString = 'May '+getEnd2;
		}
		if(getString2 == 'Jun'){
		translationString = 'Jun '+getEnd2;
		}
		if(getString2 == 'Jul'){
		translationString = 'Jul '+getEnd2;
		}
		if(getString2 == 'Aug'){
		translationString = 'Aug '+getEnd2;
		}
		if(getString2 == 'Sep'){
		translationString = 'Sep '+getEnd2;
		}
		if(getString2 == 'Oct'){
		translationString = 'Oct '+getEnd2;
		}
		if(getString2 == 'Nov'){
		translationString = 'Nov '+getEnd2;
		}
		if(getString2 == 'Dec'){
		translationString = 'Dec '+getEnd2;
		}
		
		}
		
			AppointmentBox += '<div style="width:100px; float:left; margin-left:10px"><span class="PatName">'+translationString+'</span>';
			AppointmentBox += '<div style="width:100%;"></div>';
			AppointmentBox += '<div style="width:100px; float:left; margin-left:10px"><span>'+translation3+'</span></div>';
            AppointmentBox += '</div>';    
			
			AppointmentBox += '<div style="float:left; text-align:left;">'+generateTimeline(i)+'</div>';
			//AppointmentBox += '<div class="DeleteDeck" style="width:40px; float:left;margin-left:10px"><a class="btn" style="height: 15px; padding-top: 0px; margin-top: -5px; color:red;">Del</a></div>';
			AppointmentBox += '</div>';
			
			
			origDt.setDate(origDt.getDate()+1);
			
		}
		
		$('#AppointmentContainer').html(AppointmentBox);
		$('#popover_btn').popover();
		origDt = new Date(sDate);
		
		for(i=0;i<7;++i) 
		{
			//console.log('Loading Data for ' + getDateRepresentation(origDt));
			loadTimeSlots(origDt,i);
			//break;
			origDt.setDate(origDt.getDate()+1);
		}
		
	 }

	 
	 function generateTimeline(row)
	 {
			
			var string = '<div class="timeCell" id="tc'+row+'_'+'1" ><div class="timeCellIndicator" style="border-top-left-radius: 3px; border-bottom-left-radius: 3px; -webkit-border-top-left-radius: 3px; -moz-border-top-left-radius: 3px;  -webkit-border-bottom-left-radius: 3px; -moz-border-bottom-left-radius: 3px;"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff" ></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">12 am</span></div>'
               +' <div class="timeCell" id="tc'+row+'_'+'2"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">1 am</span></div>'
               +' <div class="timeCell" id="tc'+row+'_'+'3"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">2 am</span></div>'
               +' <div class="timeCell" id="tc'+row+'_'+'4"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">3 am</span></div>'
               +' <div class="timeCell" id="tc'+row+'_'+'5"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">4 am</span></div>'
               +' <div class="timeCell" id="tc'+row+'_'+'6"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">5 am</span></div>'
               +' <div class="timeCell" id="tc'+row+'_'+'7"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">6 am</span></div>'
               +' <div class="timeCell" id="tc'+row+'_'+'8"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">7 am</span></div>'
               +' <div class="timeCell" id="tc'+row+'_'+'9"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">8 am</span></div>'
               +' <div class="timeCell" id="tc'+row+'_'+'10"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">9 am</span></div>'
               +' <div class="timeCell" id="tc'+row+'_'+'11"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">10 am</span></div>'
               +' <div class="timeCell" id="tc'+row+'_'+'12"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">11 am</span></div>'
               +' <div class="timeCell" id="tc'+row+'_'+'13"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">12 pm</span></div>'
               +' <div class="timeCell" id="tc'+row+'_'+'14"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">1 pm</span></div>'
               +' <div class="timeCell" id="tc'+row+'_'+'15"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">2 pm</span></div>'
               +' <div class="timeCell" id="tc'+row+'_'+'16"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">3 pm</span></div>'
               +' <div class="timeCell" id="tc'+row+'_'+'17"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">4 pm</span></div>'
               +' <div class="timeCell" id="tc'+row+'_'+'18"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">5 pm</span></div>'
               +' <div class="timeCell" id="tc'+row+'_'+'19"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">6 pm</span></div>'
               +' <div class="timeCell" id="tc'+row+'_'+'20"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">7 pm</span></div>'
               +' <div class="timeCell" id="tc'+row+'_'+'21"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">8 pm</span></div>'
               +' <div class="timeCell" id="tc'+row+'_'+'22"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">9 pm</span></div>'
               +' <div class="timeCell" id="tc'+row+'_'+'23"><div class="timeCellIndicator"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div></div><span class="timeLabel">10 pm</span></div>'
               +' <div class="timeCell" id="tc'+row+'_'+'24"><div class="timeCellIndicator" style="border-top-right-radius: 3px; border-bottom-right-radius: 3px; -webkit-border-top-right-radius: 3px; -moz-border-top-right-radius: 3px;  -webkit-border-bottom-right-radius: 3px; -moz-border-bottom-right-radius: 3px;"><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff"></div><div class="timeCellIndicatorOff" ></div></div><span class="timeLabel">11 pm</span></div>';
	
				
			return string;
			

	 }
	 var TimeSlotData = new Array();
	 
	 function getWeeklyTimeslots(js_date)
     {
        var day = js_date.getDate();
		    var month = js_date.getMonth()+1;
		    var year = js_date.getFullYear();
			var sqlDate = year+'-'+month+'-'+day;
	 
			var queUrl = 'getDoctorWeeklySchedule.php?week='+sqlDate;
			//console.log(queUrl);
			$.ajax(
			{
				url: queUrl,
				dataType: "json",
				async: false,
				success: function(data)
				{
					//alert('Data Fetched = ' + data);
					//console.log('Data Fetched for week of ' + sqlDate);
					TimeSlotData = data;
				},
				error: function(data, errorThrown){
					alert(errorThrown);
              } 
			});
 
     }
	 
	 
	 
	 
	 
	 function loadTimeSlots(js_date,row)
	 {
			numTimeSlots = TimeSlotData.length;
			if(numTimeSlots==0)
			{
				return;   //no need to process this week as there is no data
			}
				
			
			var wkdy = js_date.getUTCDay();
			//alert(wkdy);
			
            var next_wkdy = wkdy + 1;
            var prev_wkdy = wkdy - 1;
            if(next_wkdy > 6)
            {
                next_wkdy = 0;
            }
            if(prev_wkdy < 0)
            {
                prev_wkdy = 6;
            }
			
			
			for(var i = 0; i < numTimeSlots; i++)
			{
			
				var data = TimeSlotData[i];
				var tok = data.split('_');
				var id = parseInt(tok[0]);
				var timeslot = tok[1];
				var eventID = 'event_'+id;
				
				var slotweek = new Date(2000, 1, 2, 0, 0, 0, 0);
				
				slotweek.setUTCFullYear(parseInt(timeslot.substr(14, 4)),parseInt(timeslot.substr(18, 2)) - 1,parseInt(timeslot.substr(20, 2)));
				
				
				slotweek.setHours(0);
                slotweek.setMinutes(0);
				var slotweek_end = new Date();
                slotweek_end.setUTCDate(slotweek.getDate()+6);
                slotweek_end.setHours(23);
                slotweek_end.setMinutes(59);
                slotweek_end.setSeconds(59);
				
				
				//if(js_date.getTime() >= slotweek.getTime() && js_date.getTime() <= slotweek_end.getTime())
                //{
					
                    var start_hour = parseInt(timeslot.substr(1, 2));
					
                    var start_minute = parseInt(timeslot.substr(3, 2));
					
                    var end_hour = parseInt(timeslot.substr(5, 2));
					
                    var end_minute = parseInt(timeslot.substr(7, 2));
                    
					//console.log('Initially->' + start_hour + '  ' + start_minute + '   ' + end_hour + '   ' + end_minute);
					//Convert Time to GMT	
					
                    var add_zone = 0;
                    if(timeslot.substr(9, 1) == '+')
                    {
                        add_zone = 1;
                    }
                    if(add_zone)
                    {
						
                        var delta_hour = parseInt(timeslot.substr(10, 2));
                        var delta_minute = parseInt(timeslot.substr(12, 2));
                        start_hour -= delta_hour;
                        end_hour -= delta_hour;
                        start_minute -= delta_minute;
                        end_minute -= delta_minute;
                        if(start_minute >= 60)
                        {
                            start_minute -= 60;
                            start_hour += 1;
                            
                        }
                        else if(start_minute < 0)
                        {
                            start_minute += 60;
                            start_hour -= 1;
                        }
                        if(end_minute >= 60)
                        {
                            end_minute -= 60;
                            end_hour += 1;
                            
                        }
                        else if(end_minute < 0)
                        {
                            end_minute += 60;
                            end_hour -= 1;
                        }
                        
                    }
                    else
                    {
						
                        var delta_hour = parseInt(timeslot.substr(10, 2));
                        var delta_minute = parseInt(timeslot.substr(12, 2));
                        start_hour += delta_hour;
                        end_hour += delta_hour;
                        start_minute += delta_minute;
                        end_minute += delta_minute;
                        if(start_minute >= 60)
                        {
                            start_minute -= 60;
                            start_hour += 1;
                            
                        }
                        else if(start_minute < 0)
                        {
                            start_minute += 60;
                            start_hour -= 1;
                        }
                        if(end_minute >= 60)
                        {
                            end_minute -= 60;
                            end_hour += 1;
                            
                        }
                        else if(end_minute < 0)
                        {
                            end_minute += 60;
                            end_hour -= 1;
                        }
                    }
					
					//console.log('GMT->' + start_hour + '  ' + start_minute + '   ' + end_hour + '   ' + end_minute);
					//Convert GMT Time to Local Time
								
						
					            
					//var currentTimezone = parseFloat(get_timezone_offset());
                    // *************************************************** //
                    // Get timezone from select field instead
                    // *************************************************** //
                    var currentTimezone = parseFloat($("#timezone_picker").val());
                    
                    var currentTimezoneHour = Math.floor(currentTimezone);
					
                    var currentTimezoneMinute = (currentTimezone - currentTimezoneHour) * 60;
                    if(add_zone == 0)
                    {
                        currentTimezoneHour = Math.ceil(currentTimezone);
                        currentTimezoneMinute = (currentTimezone - currentTimezoneHour) * 60;
                    }
					
					
					
                    start_hour += currentTimezoneHour;
                    end_hour += currentTimezoneHour;
					
                    start_minute += currentTimezoneMinute;
                    end_minute += currentTimezoneMinute;
                    
					
					
					
					if(start_minute >= 60)
                    {
                        start_minute -= 60;
                        start_hour += 1;
                        
                    }
                    else if(start_minute < 0)
                    {
                        start_minute += 60;
                        start_hour -= 1;
                    }
                    if(end_minute >= 60)
                    {
                        end_minute -= 60;
                        end_hour += 1;
                        
                    }
                    else if(end_minute < 0)
                    {
                        end_minute += 60;
                        end_hour -= 1;
                    }
					
					
					
                    if(parseInt(timeslot[0]) == next_wkdy)
                    {
                        start_hour += 24;
                        end_hour += 24;
                    }
                    else if(parseInt(timeslot[0]) == prev_wkdy)
                    {
                        start_hour -= 24;
                        end_hour -= 24;
                    }
					
					//console.log('Final->' + start_hour + '  ' + start_minute + '   ' + end_hour + '   ' + end_minute + '***' + wkdy);
					
                    if(parseInt(timeslot[0]) == wkdy || parseInt(timeslot[0]) == next_wkdy || parseInt(timeslot[0]) == prev_wkdy)
                    {   
					
						//console.log('**coloring ' + "#tc"+row+"_"+(start_hour + 1) + '   ' + start_minute + '   ' + end_minute + '  ' + eventID);
                        if(start_hour < 24 )//&& end_hour > 0)
                        {
							

							if(start_hour==end_hour)
							{
								//alert('special case');
								var start=1;
								if(start_minute==0)
									start=1;
								else
									start = (start_minute / 15)+1;
														
                                var end = end_minute / 15;
								//console.log(start + '  ' + end);
								
								for(var j=1;j<5;++j)
								{
								
									if(j>=start && j<=end)
									{
										switch(j)
										{
											
											case 1:$("#tc"+row+"_"+(start_hour + 1)).children(".timeCellIndicator").children().first().attr("class", "timeCellIndicatorOn " + eventID);
													break;
											case 2:$("#tc"+row+"_"+(start_hour + 1)).children(".timeCellIndicator").children().first().next().attr("class", "timeCellIndicatorOn " + eventID);
													break;
											case 3:	$("#tc"+row+"_"+(start_hour + 1)).children(".timeCellIndicator").children().last().prev().attr("class", "timeCellIndicatorOn " + eventID);
													break;
											case 4:$("#tc"+row+"_"+(start_hour + 1)).children(".timeCellIndicator").children().last().attr("class", "timeCellIndicatorOn " + eventID);
													break;
										}
									}
								}
								
								
								
								
								//colorSlot(row,start_hour + 1,start_hour + 1,eventID);
								continue;
							}
								
							//console.log('other part');
                            if(start_hour >= 0)
                            {
                                var start = start_minute / 15;
                                var end = end_minute / 15;
                                if(start <= 3)
                                {
									
									//console.log('****coloring ' + "#tc"+row+"_"+(start_hour + 1) + '   ' + start + '   ' + end + '  ' + eventID);
                                    //$("#tc"+row+"_"+(start_hour + 1)).children(".timeCellIndicator").children().last().attr("class", "timeCellIndicatorOn");
									$("#tc"+row+"_"+(start_hour + 1)).children(".timeCellIndicator").children().last().attr("class", "timeCellIndicatorOn " + eventID);
									
									
									//var elem = document.getElementById('tc5_4');
									//alert(elem);
									
                                    if(start <= 2)
                                    {
										//console.log('coloring ' + "#tc"+row+"."+(start_hour + 1));
                                        $("#tc"+row+"_"+(start_hour + 1)).children(".timeCellIndicator").children().last().prev().attr("class", "timeCellIndicatorOn " + eventID);
                                        if(start <= 1)
                                        {
                                            $("#tc"+row+"_"+(start_hour + 1)).children(".timeCellIndicator").children().first().next().attr("class", "timeCellIndicatorOn " + eventID);
                                            if(start == 0)
                                            {
                                                $("#tc"+row+"_"+(start_hour + 1)).children(".timeCellIndicator").children().first().attr("class", "timeCellIndicatorOn " + eventID);
                                            }
                                        }
                                    }
                                }
                            }
                            var k = start_hour + 2;
                            if(k < 1)
                            {
                                k = 1;
                            }
                            var k2 = end_hour;
                            if(k2 > 24)
                            {
                                k2 = 24
                            }
                            for(; k <= k2; k++)
                            {
                                $("#tc"+row+"_"+k).children(".timeCellIndicator").children().first().attr("class", "timeCellIndicatorOn " + eventID);
                                $("#tc"+row+"_"+k).children(".timeCellIndicator").children().first().next().attr("class", "timeCellIndicatorOn " + eventID);
                                $("#tc"+row+"_"+k).children(".timeCellIndicator").children().last().prev().attr("class", "timeCellIndicatorOn " + eventID);
                                $("#tc"+row+"_"+k).children(".timeCellIndicator").children().last().attr("class", "timeCellIndicatorOn " + eventID);
                            }
                            if(end_hour < 24 && end >= 1)
                            {
                                $("#tc"+row+"_"+(end_hour + 1)).children(".timeCellIndicator").children().first().attr("class", "timeCellIndicatorOn " + eventID);
                                if(end >= 2)
                                {
                                    $("#tc"+row+"_"+(end_hour + 1)).children(".timeCellIndicator").children().first().next().attr("class", "timeCellIndicatorOn " + eventID);
                                    if(end >= 3)
                                    {
                                        $("#tc"+row+"_"+(end_hour + 1)).children(".timeCellIndicator").children().last().prev().attr("class", "timeCellIndicatorOn " + eventID);
                                    }
                                }
                            }
                        }
                        
                    }
                //}
				
				
			
				
			}
	 }
	 
	 
	 var lastSelected='';
	 var selectedRow = -1;
	 var selectedColumn = -1;
	 var selectedTime = '';
	 
	 
	 $( ".timeCellIndicatorOff" ).live('mouseover',function() {
	   if($("#telemed_on").val() == 1)
        {
			var thisDate = $(this).parent().parent().parent().parent().attr('id');
			var d1 = new Date(thisDate);
			var d2 = new Date();
			if(DateDiff.inDays(d2, d1)<0)
			{
				return;
			}
	 
	 
			$(this).addClass('timeCellIndicatorTempOn');
			//$(this).attr('class','timeCellIndicatorTempOn');
        }
			
	 });
	 
	 $( ".timeCellIndicatorOff" ).live('mouseout',function() {
         if($("#telemed_on").val() == 1)
        {
			var thisDate = $(this).parent().parent().parent().parent().attr('id');
			var d1 = new Date(thisDate);
			var d2 = new Date();
			if(DateDiff.inDays(d2, d1)<0)
			{
				return;
			}
			
			
            if($(this).hasClass('tempSelection') )//|| $(this).hasClass('timeCellIndicatorOn'))
            {
                
                //console.log('true');
            }
            else
            {
                //console.log('false');
                $(this).removeClass('timeCellIndicatorTempOn');
                //$(this).attr('class','timeCellIndicatorOff');
            }
        }
	 });
	 
	 
	 //For deleting events
	 $( ".timeCellIndicatorOn" ).live("click", function(){
		if($("#telemed_on").val() == 1)
        {
		var thisDate = $(this).parent().parent().parent().parent().attr('id');
		var d1 = new Date(thisDate);
		var d2 = new Date();
		if(DateDiff.inDays(d2, d1)<0)
		{
			displaynotification(' ','You cannot delete timeslots from the past');
			return;
		}
		
		
		var myID = $(this).parent().parent().attr('id');
		var myRow = getRowFromId(myID);
		
		
		
		if(lastSelected == myID)
		{
			
			//if you want to select slot for just 15 min
			var startTime = selectedTime;
			var endTime = getTime($(this).parent().parent().children('.timeLabel').text(),$(this).index()+1);
			endTime = add15min(endTime);
			//console.log(startTime+' - '+endTime);
			var insertid = createTimeslot(startTime,endTime,myRow);
			displaynotification('Timeslot Saved',getDateRepresentation(new Date(thisDate)) + ' ' + getTimeRepresentation(startTime) + ' - ' + getTimeRepresentation(endTime));
			//colorSlot(myRow,selectedColumn,selectedColumn,insertid);
			$(this).attr('class','timeCellIndicatorOn event_'+insertid);
			lastSelected='';
			selectedRow = -1;
			selectedColumn = -1;
			selectedTime = '';
			return;
		}
		
		
		
		
		if(lastSelected!='')
		{
			$('#'+lastSelected).children('.timeCellIndicator').children('.tempSelection').attr('class','timeCellIndicatorOff');
			lastSelected='';
			selectedRow = -1;
			selectedColumn = -1;
			selectedTime = '';
			return;
		}
		
		
		
		
		
		var classList =$(this).attr('class').split(/\s+/);
		$.each( classList, function(index, item)
		{
			
			//if there is an eventID associated
			if(item.indexOf('event') > -1)
			{
				var id = parseInt(item.split('_')[1]);
				//alert('Associated ID='+id);
				var answer = confirm("Are you sure you want to delete this event ? ");
				if(answer)
				{
					//alert('deleting ' + id);
					var url = 'deleteDoctorAvailability.php?eventID='+id;
					//console.log(url);
					LanzaAjax(url);
					uncolorEventFromRow(myRow,id);
					displaynotification('Timeslot Deleted',' ');
				}
				else
				{
					//do nothing
				}	
			
			
			}
		});
        }
	 });
	 
	 
	 function uncolorEventFromRow(row,eventID)
	 {
		//alert('I have to uncolor ' + row + ' **' + eventID);
		var eventClass = 'event_'+eventID;
		
		for(var i=0;i<25;++i)
		{
			var cellID = generateID(row,i);
		
			
			if($(cellID).children(".timeCellIndicator").children().first().hasClass(eventClass))
			{
				$(cellID).children(".timeCellIndicator").children().first().attr("class", "timeCellIndicatorOff");
			}
			
			if($(cellID).children(".timeCellIndicator").children().first().next().hasClass(eventClass))
			{
				$(cellID).children(".timeCellIndicator").children().first().next().attr("class", "timeCellIndicatorOff");
			}
			
			if($(cellID).children(".timeCellIndicator").children().last().prev().hasClass(eventClass))
			{
				$(cellID).children(".timeCellIndicator").children().last().prev().attr("class", "timeCellIndicatorOff");
			}
			
			if($(cellID).children(".timeCellIndicator").children().last().hasClass(eventClass))
			{
				$(cellID).children(".timeCellIndicator").children().last().attr("class", "timeCellIndicatorOff");
			}
		}
	 }
	 
	 
	 
	 $( ".timeCellIndicatorOff" ).live("click", function(){
	
        if($("#telemed_on").val() == 1)
        {
            var thisDate = $(this).parent().parent().parent().parent().attr('id');
            var d1 = new Date(thisDate);
            var d2 = new Date();
            if(DateDiff.inDays(d2, d1)<0)
            {
                displaynotification(' ','You cannot create timeslots in the past');
                return;
            }
         
         
         
                if(lastSelected != '')
                {
                    //if this is second click
                    var myID = $(this).parent().parent().attr('id');
                    var myRow = getRowFromId(myID);
                    var myColumn = getColumnFromId(myID);
                    
                    if(myRow == selectedRow)
                    {
                        //alert('This is Second Click');
                        //if second click on same row
                        
                        
                        if(myColumn < selectedColumn)
                        {
                            //if second click is starttime
                            $(this).attr('class','timeCellIndicatorOn tempSelection');
                            
                            //console.log($(this).parent().parent().children('.timeLabel').text() + '***' + ($(this).index()+1) + ' ### ' + myColumn + ' -- ' + selectedColumn)
                            var startTime = getTime($(this).parent().parent().children('.timeLabel').text(),$(this).index()+1);
                            var endTime = add15min(selectedTime);
                            //console.log(startTime+' - '+endTime);
                            var insertid = createTimeslot(startTime,endTime,myRow);
                            colorSlot(myRow,myColumn,selectedColumn,insertid);
                            displaynotification('Timeslot Saved',getDateRepresentation(new Date(thisDate)) + ' ' + getTimeRepresentation(startTime) + ' ' + getTimeRepresentation(endTime));
                        }
                        else if(myColumn > selectedColumn)
                        {
                            //console.log('here');
                            //if second click is endtime
                            $(this).attr('class','timeCellIndicatorOn tempSelection');
                            
                            var startTime = selectedTime;
                            var endTime = getTime($(this).parent().parent().children('.timeLabel').text(),$(this).index()+1);
                            endTime = add15min(endTime);
                            //console.log(startTime+' - '+endTime);
                            var insertid = createTimeslot(startTime,endTime,myRow);
                            colorSlot(myRow,selectedColumn,myColumn,insertid);
                            displaynotification('Timeslot Saved',getDateRepresentation(new Date(thisDate)) + ' ' + getTimeRepresentation(startTime) + ' - ' + getTimeRepresentation(endTime));
                        }
                        else //if(myColumn == selectedColumn)
                        {
                            //both start and end are on same slot
                            var startTime;
                            var endTime;
                            var fClick = getIndexFromTime(selectedTime);
                            var sClick = $(this).index()+1;
                            
                                                
                            $(this).attr('class','timeCellIndicatorOn tempSelection');
                            if(fClick < sClick)
                            {
                                //first click is on left of second click
                                startTime = selectedTime;
                                endTime = getTime($(this).parent().parent().children('.timeLabel').text(),sClick);
                                endTime = add15min(endTime);
                                //console.log(startTime+' - '+endTime);
                                
                                
                            }
                            else
                            {
                                //first click is on right of second click
                                startTime = getTime($(this).parent().parent().children('.timeLabel').text(),sClick);
                                endTime = add15min(selectedTime);
                                //console.log(startTime+' - '+endTime);
                                
                                
                            }
                            var insertid = createTimeslot(startTime,endTime,myRow);
                            colorSlot(myRow,selectedColumn,myColumn,insertid);
                            displaynotification('Timeslot Saved',getDateRepresentation(new Date(thisDate)) + ' ' + getTimeRepresentation(startTime) + ' - ' + getTimeRepresentation(endTime));
                            
                        
                        }
                        lastSelected='';
                        selectedRow = -1;
                        selectedColumn = -1;
                        selectedTime = '';
                        
                        
                    }
                    else
                    {
                        //alert('here');
                        //if second click on different row
                                //undo selection in other row
                        
                        $('#'+lastSelected).children('.timeCellIndicator').children('.tempSelection').attr('class','timeCellIndicatorOff');
                        lastSelected='';
                        selectedRow = -1;
                        selectedColumn = -1;
                        selectedTime = '';
                    
                    }
                    
                    
                    
                }
                else
                {
                    //alert('This is First Click');
                    //if this is a new click
                    $(this).attr('class','timeCellIndicatorOn tempSelection');
                    var myID = $(this).parent().parent().attr('id');
                    lastSelected = myID;
                    selectedRow = getRowFromId(lastSelected);
                    selectedColumn = getColumnFromId(lastSelected);
                    selectedTime = getTime($(this).parent().parent().children('.timeLabel').text(),$(this).index()+1);
                    //console.log(selectedTime);
                    
                    
                }
        }
	 });
	 
	 function getIndexFromTime(baseTime)
	 {
		var tok = baseTime.split(':');
		var minutes = parseInt(tok[1]);
		switch(minutes)
		{
			case 0: return 1;
			case 15 : return 2;
			case 30 : return 3;
			case 45 : return 4;
		
		}
	 }
	 
	 function getTime(baseTime,offset)
	 {
		var tok = baseTime.split(' ');
		var hours = parseInt(tok[0]);
		
		
		if(tok[1]=='pm')
		{
			if(hours!=12)
			{
				hours = hours + 12;
			}
			
		}
		else
		{
			if(hours==12)
			{
				hours=0;
			}
		
		}
		
		
		var minutes = '00';
		var seconds = '00';
		switch(offset)
		{
			case 1: minutes = '00';
					break;
			case 2: minutes = '15';
					break;
			case 3: minutes = '30';
					break;
			case 4:minutes = '45';
					break;
					
		}
		
		return hours+':'+minutes+':'+seconds;
	 
	 }
	 
	 function add15min(time)
	 {
		var tok = time.split(':');
		var hours = parseInt(tok[0]);
		var minutes = parseInt(tok[1]);
		minutes = minutes + 15;
		if(minutes==60)
		{
			hours = hours + 1;
			if(hours == 24)
			{
				return '00:00:00';
			}
			else
			{
				return hours+':00:00';
			}
		}
		else
		{
			return hours+':'+minutes+':00';
		}
	 }
	 
	 
	 
	 function createTimeslot(sTime,eTime,weekDay)
	 {
		var sDate = getDateDatabaseRepresentation(startDate);
		//var timezone = parseFloat(get_timezone_offset());
		/*var current_timezone = get_timezone_offset();
	    if(current_timezone != 'none')
        {
            var v = parseInt(current_timezone.substr(0, 3));
            var m = parseInt(current_timezone.substr(4, 2));
			//alert(v + '  ' + m);
            if(m != 0)
            {
                $("#timezone_picker").val(v+(m / 60.0));
            }
            else
            {
                $("#timezone_picker").val(v+'.0');
				//alert($("#timezone_picker").val());
            }
        }*/
		
		
		//console.log('Booking Slot : ' + sTime + ' - ' + eTime);
		var picker_val = $("#timezone_picker").val().toString();
         var curr_tmzn = '';
        if(picker_val.charAt(0) == '-')
        {
            curr_tmzn = '-';
            picker_val = picker_val.replace('-','');
        }
         var nums = picker_val.split('.');
         if(nums[0].length == 1)
         {
             curr_tmzn += '0';
         }
         curr_tmzn += nums[0];
         curr_tmzn += ':';
         if(nums[1].length == 1)
         {
             curr_tmzn += '0';
         }
         curr_tmzn += nums[1];
		var url = 'createDoctorTimeslot.php?startDate='+sDate+'&startTime='+sTime+'&endTime='+eTime+'&weekday='+weekDay+'&timezone='+curr_tmzn;//current_timezone;
		console.log(url);
        //$.get(url, function(data, status){console.log(data);});
		var RecTipo = LanzaAjax(url);
		//alert(RecTipo);
		
		return parseInt(RecTipo);
		
	 
	 }
	 
	 
	 function getColumnFromId(string)
	 {
		var tok = string.split('_');
		return parseInt(tok[1]);
	 }
	 
	 
	 function getRowFromId(string)
	 {
		var tok = string.split('_');
		return parseInt(tok[0].substr(tok[0].length-1, 1));
	 }
	 
	 
	 function generateID(row,column)
	 {
		return '#tc'+row+'_'+column;
	 }
	 
	 function colorSlot(row,colStart,colEnd,insertid)
	 {
	 
		//console.log('**'+row + '  ' + colStart + '   ' + colEnd + '  ' + insertid )
		var eventID = 'event_'+insertid;
		if(colStart == colEnd)
		{
			var i= colStart;
			var id = generateID(row,i);
				//console.log('coloring' + id);
				
				
				if($(id).children(".timeCellIndicator").children().hasClass('tempSelection'))
				{
					//if the starting block is to be partially coloured
					//alert('starting block partial color');
					
					var s=0;
					var e=0;
					
					
					if($(id).children(".timeCellIndicator").children().first().hasClass('tempSelection') || flag)
					{
						s=1;
						e=1;
					}
					
					if($(id).children(".timeCellIndicator").children().first().next().hasClass('tempSelection') || flag)
					{
						if(s==0)
						{
							s=2;
						}
						e=2;
					}
					
					if($(id).children(".timeCellIndicator").children().last().prev().hasClass('tempSelection') || flag)
					{
						if(s==0)
						{
							s=3;
						}
						e=3;
					}
					
					if($(id).children(".timeCellIndicator").children().last().hasClass('tempSelection') || flag)
					{
						if(s==0)
						{
							s=4;
						}
						e=4;
					}
					//console.log('###s='+s + '  ###e='+e);
					for(var j=1;j<5;++j)
					{
						if(j>=s && j<=e)
						{
							switch(j)
							{
								case 1:	$(id).children(".timeCellIndicator").children().first().attr("class", "timeCellIndicatorOn " + eventID);
										break;
								case 2:$(id).children(".timeCellIndicator").children().first().next().attr("class", "timeCellIndicatorOn " + eventID);
										break;
								case 3:	$(id).children(".timeCellIndicator").children().last().prev().attr("class", "timeCellIndicatorOn " + eventID);
										break;
								case 4:$(id).children(".timeCellIndicator").children().last().attr("class", "timeCellIndicatorOn " + eventID);
										break;
							}
						}
					}
					
					
				}	
			
			
			
			
			
		}
		else
		{
			for(i=colStart;i<colEnd;i++)
			{
				var id = generateID(row,i);
				//console.log('coloring' + id);
				if($(id).children(".timeCellIndicator").children().hasClass('tempSelection'))
				{
					//if the starting block is to be partially coloured
					//alert('starting block partial color');
					var flag=false;
					if($(id).children(".timeCellIndicator").children().first().hasClass('tempSelection') || flag)
					{
						flag=true;
						//$(id).children(".timeCellIndicator").children().removeClass('tempSelection');
						$(id).children(".timeCellIndicator").children().first().attr("class", "timeCellIndicatorOn " + eventID);
						//$(id).children(".timeCellIndicator").children().first().removeClass("timeCellIndicatorOff");
					}
					
					if($(id).children(".timeCellIndicator").children().first().next().hasClass('tempSelection') || flag)
					{
						flag=true;
						//$(id).children(".timeCellIndicator").children().removeClass('tempSelection');
						$(id).children(".timeCellIndicator").children().first().next().attr("class", "timeCellIndicatorOn " + eventID);
						//$(id).children(".timeCellIndicator").children().first().next().removeClass("timeCellIndicatorOff");
					}
					
					if($(id).children(".timeCellIndicator").children().last().prev().hasClass('tempSelection') || flag)
					{
						flag=true;
						//$(id).children(".timeCellIndicator").children().removeClass('tempSelection');
						$(id).children(".timeCellIndicator").children().last().prev().attr("class", "timeCellIndicatorOn " + eventID);
						//$(id).children(".timeCellIndicator").children().last().prev().removeClass("timeCellIndicatorOff");
					}
					
					if($(id).children(".timeCellIndicator").children().last().hasClass('tempSelection') || flag)
					{
						flag=true;
						//$(id).children(".timeCellIndicator").children().removeClass('tempSelection');
						$(id).children(".timeCellIndicator").children().last().attr("class", "timeCellIndicatorOn " + eventID);
						//$(id).children(".timeCellIndicator").children().last().removeClass("timeCellIndicatorOff");
					}
					
					
				}
				else
				{
					//if all four block are to be coloured
					$(id).children(".timeCellIndicator").children().first().attr("class", "timeCellIndicatorOn " + eventID);
					$(id).children(".timeCellIndicator").children().first().next().attr("class", "timeCellIndicatorOn " + eventID);
					$(id).children(".timeCellIndicator").children().last().prev().attr("class", "timeCellIndicatorOn " + eventID);
					$(id).children(".timeCellIndicator").children().last().attr("class", "timeCellIndicatorOn " + eventID);
				}
			}
			
			var id = generateID(row,colEnd);
			if($(id).children(".timeCellIndicator").children().hasClass('tempSelection'))
			{
					//if the last block is to be partially coloured
					var flag=false;
					if($(id).children(".timeCellIndicator").children().last().hasClass('tempSelection') || flag)
					{
						flag=true;
						//$(id).children(".timeCellIndicator").children().removeClass('tempSelection');
						$(id).children(".timeCellIndicator").children().last().attr("class", "timeCellIndicatorOn " + eventID);
						//$(id).children(".timeCellIndicator").children().last().removeClass("timeCellIndicatorOff");
					}
					
					if($(id).children(".timeCellIndicator").children().last().prev().hasClass('tempSelection') || flag)
					{
						flag=true;
						//$(id).children(".timeCellIndicator").children().removeClass('tempSelection');
						$(id).children(".timeCellIndicator").children().last().prev().attr("class", "timeCellIndicatorOn " + eventID);
						//$(id).children(".timeCellIndicator").children().last().prev().removeClass("timeCellIndicatorOff");
					}
					
					if($(id).children(".timeCellIndicator").children().first().next().hasClass('tempSelection') || flag)
					{
						flag=true;
						//$(id).children(".timeCellIndicator").children().removeClass('tempSelection');
						$(id).children(".timeCellIndicator").children().first().next().attr("class", "timeCellIndicatorOn " + eventID);
						//$(id).children(".timeCellIndicator").children().first().next().removeClass("timeCellIndicatorOff");
					}
					
					if($(id).children(".timeCellIndicator").children().first().hasClass('tempSelection') || flag)
					{
						flag=true;
						//$(id).children(".timeCellIndicator").children().removeClass('tempSelection');
						$(id).children(".timeCellIndicator").children().first().attr("class", "timeCellIndicatorOn " + eventID);
						//$(id).children(".timeCellIndicator").children().first().removeClass("timeCellIndicatorOff");
					}
					
					
					
			}
			
			
			
			
		
		}
	 
	 
	 
	 
	 }
	 
	 
	 var DateDiff = {

			inDays: function(d1, d2) {
				var t2 = d2.getTime();
				var t1 = d1.getTime();

				return parseInt((t2-t1)/(24*3600*1000));
			},

			inWeeks: function(d1, d2) {
				var t2 = d2.getTime();
				var t1 = d1.getTime();

				return parseInt((t2-t1)/(24*3600*1000*7));
			},

			inMonths: function(d1, d2) {
				var d1Y = d1.getFullYear();
				var d2Y = d2.getFullYear();
				var d1M = d1.getMonth();
				var d2M = d2.getMonth();

				return (d2M+12*d2Y)-(d1M+12*d1Y);
			},

			inYears: function(d1, d2) {
				return d2.getFullYear()-d1.getFullYear();
			}
		}
			 
	 
	</script>

  </body>
</html>

